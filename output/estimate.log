--------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Volumes/Projects3/workspace/expat-analysis/output/estimate.log
  log type:  text
 opened on:  20 Nov 2018, 11:32:56

. 
. use temp/analysis_sample

. 
. local sample_baseline expat!=.&greenfield!=1

. local sample_manufacturing `sample_baseline' & manufacturing==1

. local sample_acquisitions `sample_baseline' & ever_foreign==1

. 
. local samples baseline manufacturing acquisitions

. 
. local scale lnL lnK lnQ

. local intensity lnKL lnQL exporter inv

. 
. xtset id year
       panel variable:  id (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. foreach sample in `samples' {
  2.         foreach group in scale intensity {
  3.                 foreach X of var ``group'' {
  4.                         xtreg `X' foreign new fnew fnew_expat i.ind_year i.age_cat if `sample_`sample'', i(id ) fe vce(clus
> ter id)
  5.                         local r2_w = `e(r2_w)'
  6.                         do regram output/regression/`sample'_`group' `X' `X' R2_within "`r2_w'"
  7.                 }
  8.         }
  9. }

Fixed-effects (within) regression               Number of obs     =    188,472
Group variable: id                              Number of groups  =     39,342

R-sq:                                           Obs per group:
     within  = 0.0780                                         min =          1
     between = 0.0292                                         avg =        4.8
     overall = 0.0427                                         max =          9

                                                F(58,39341)       =      77.19
corr(u_i, Xb)  = -0.1253                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 39,342 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0499393   .0480137    -1.04   0.298    -.1440473    .0441688
         new |  -.0390514   .0066771    -5.85   0.000    -.0521387   -.0259641
        fnew |  -.0659781   .0504332    -1.31   0.191    -.1648284    .0328721
  fnew_expat |  -.0420805   .0917935    -0.46   0.647     -.221998    .1378371
             |
    ind_year |
          2  |  -.1003384    .013623    -7.37   0.000    -.1270399   -.0736369
          3  |  -.1924582   .0193668    -9.94   0.000    -.2304175   -.1544989
          4  |  -.2786208   .0231818   -12.02   0.000    -.3240577   -.2331839
          5  |  -.3399008   .0269907   -12.59   0.000    -.3928033   -.2869983
          6  |   -.369459   .0308684   -11.97   0.000    -.4299618   -.3089563
          7  |  -.3781527   .0349059   -10.83   0.000    -.4465691   -.3097363
          8  |  -.3801351    .037802   -10.06   0.000    -.4542281   -.3060422
          9  |  -.3913372   .0399996    -9.78   0.000    -.4697374   -.3129371
         10  |  -.4237659   .0416279   -10.18   0.000    -.5053576   -.3421743
         11  |  -.4737402   .0431961   -10.97   0.000    -.5584055   -.3890749
         12  |  -.4979507   .0441624   -11.28   0.000    -.5845101   -.4113914
         13  |  -.5125595   .0448573   -11.43   0.000    -.6004808   -.4246382
         14  |  -.5615272   .0458587   -12.24   0.000    -.6514114   -.4716429
         15  |  -.5822515   .0465726   -12.50   0.000     -.673535   -.4909681
         16  |   -.608953   .0470324   -12.95   0.000    -.7011376   -.5167685
         17  |  -.6310395   .0477197   -13.22   0.000    -.7245713   -.5375076
         18  |  -.6827439   .0482567   -14.15   0.000    -.7773281   -.5881596
         19  |   -.716565   .0490895   -14.60   0.000    -.8127817   -.6203483
         20  |  -.7628319    .049727   -15.34   0.000    -.8602979   -.6653658
         21  |  -.7839647   .0504107   -15.55   0.000    -.8827709   -.6851584
         22  |  -.7949304   .0516384   -15.39   0.000    -.8961429   -.6937179
         23  |  -.7911409   .0524626   -15.08   0.000    -.8939689   -.6883129
         24  |   -.834279   .0536192   -15.56   0.000     -.939374    -.729184
         25  |  -.8102947   .0548225   -14.78   0.000    -.9177482   -.7028412
         26  |   .4613303   .0595341     7.75   0.000      .344642    .5780187
         27  |   .3707486   .0566518     6.54   0.000     .2597098    .4817874
         28  |   .2857006   .0556667     5.13   0.000     .1765925    .3948087
         29  |   .2010951   .0547325     3.67   0.000     .0938182    .3083721
         30  |   .1491075   .0540157     2.76   0.006     .0432353    .2549797
         31  |   .1176296    .053689     2.19   0.028     .0123979    .2228613
         32  |    .083405    .052589     1.59   0.113    -.0196706    .1864807
         33  |    .052666   .0526615     1.00   0.317    -.0505518    .1558838
         34  |    .042238   .0528732     0.80   0.424    -.0613948    .1458708
         35  |  -.0000714   .0536155    -0.00   0.999    -.1051591    .1050162
         36  |  -.0503674   .0544797    -0.92   0.355    -.1571489     .056414
         37  |  -.0816758   .0548005    -1.49   0.136    -.1890861    .0257345
         38  |  -.1319247   .0552942    -2.39   0.017    -.2403026   -.0235467
         39  |  -.1611126   .0560231    -2.88   0.004    -.2709193   -.0513058
         40  |  -.1575275   .0559766    -2.81   0.005     -.267243   -.0478119
         41  |  -.2009773   .0563798    -3.56   0.000     -.311483   -.0904715
         42  |  -.2318878   .0570998    -4.06   0.000    -.3438047   -.1199709
         43  |  -.3232849    .058042    -5.57   0.000    -.4370487   -.2095212
         44  |  -.3640045   .0586182    -6.21   0.000    -.4788977   -.2491113
         45  |  -.3639286   .0592401    -6.14   0.000    -.4800406   -.2478167
         46  |  -.3796855   .0601532    -6.31   0.000    -.4975871   -.2617838
         47  |  -.3968494   .0609756    -6.51   0.000     -.516363   -.2773358
         48  |  -.3949336   .0621132    -6.36   0.000     -.516677   -.2731902
         49  |  -.4109135   .0641065    -6.41   0.000    -.5365638   -.2852631
         50  |  -.3889286   .0646425    -6.02   0.000    -.5156294   -.2622277
             |
     age_cat |
          2  |   .3719635   .0123463    30.13   0.000     .3477646    .3961625
          3  |   .6482071   .0143649    45.12   0.000     .6200515    .6763626
          4  |   .9039363   .0170269    53.09   0.000     .8705633    .9373094
          5  |   1.073129   .0223127    48.09   0.000     1.029396    1.116863
          6  |   1.177516   .0263621    44.67   0.000     1.125845    1.229186
             |
       _cons |   3.327511    .036161    92.02   0.000     3.256635    3.398388
-------------+----------------------------------------------------------------
     sigma_u |  1.0836658
     sigma_e |  .55369576
         rho |  .79297941   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0779846867465883

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    188,472
Group variable: id                              Number of groups  =     39,342

R-sq:                                           Obs per group:
     within  = 0.0780                                         min =          1
     between = 0.0292                                         avg =        4.8
     overall = 0.0427                                         max =          9

                                                F(58,39341)       =      77.19
corr(u_i, Xb)  = -0.1253                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 39,342 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0499393   .0480137    -1.04   0.298    -.1440473    .0441688
         new |  -.0390514   .0066771    -5.85   0.000    -.0521387   -.0259641
        fnew |  -.0659781   .0504332    -1.31   0.191    -.1648284    .0328721
  fnew_expat |  -.0420805   .0917935    -0.46   0.647     -.221998    .1378371
             |
    ind_year |
          2  |  -.1003384    .013623    -7.37   0.000    -.1270399   -.0736369
          3  |  -.1924582   .0193668    -9.94   0.000    -.2304175   -.1544989
          4  |  -.2786208   .0231818   -12.02   0.000    -.3240577   -.2331839
          5  |  -.3399008   .0269907   -12.59   0.000    -.3928033   -.2869983
          6  |   -.369459   .0308684   -11.97   0.000    -.4299618   -.3089563
          7  |  -.3781527   .0349059   -10.83   0.000    -.4465691   -.3097363
          8  |  -.3801351    .037802   -10.06   0.000    -.4542281   -.3060422
          9  |  -.3913372   .0399996    -9.78   0.000    -.4697374   -.3129371
         10  |  -.4237659   .0416279   -10.18   0.000    -.5053576   -.3421743
         11  |  -.4737402   .0431961   -10.97   0.000    -.5584055   -.3890749
         12  |  -.4979507   .0441624   -11.28   0.000    -.5845101   -.4113914
         13  |  -.5125595   .0448573   -11.43   0.000    -.6004808   -.4246382
         14  |  -.5615272   .0458587   -12.24   0.000    -.6514114   -.4716429
         15  |  -.5822515   .0465726   -12.50   0.000     -.673535   -.4909681
         16  |   -.608953   .0470324   -12.95   0.000    -.7011376   -.5167685
         17  |  -.6310395   .0477197   -13.22   0.000    -.7245713   -.5375076
         18  |  -.6827439   .0482567   -14.15   0.000    -.7773281   -.5881596
         19  |   -.716565   .0490895   -14.60   0.000    -.8127817   -.6203483
         20  |  -.7628319    .049727   -15.34   0.000    -.8602979   -.6653658
         21  |  -.7839647   .0504107   -15.55   0.000    -.8827709   -.6851584
         22  |  -.7949304   .0516384   -15.39   0.000    -.8961429   -.6937179
         23  |  -.7911409   .0524626   -15.08   0.000    -.8939689   -.6883129
         24  |   -.834279   .0536192   -15.56   0.000     -.939374    -.729184
         25  |  -.8102947   .0548225   -14.78   0.000    -.9177482   -.7028412
         26  |   .4613303   .0595341     7.75   0.000      .344642    .5780187
         27  |   .3707486   .0566518     6.54   0.000     .2597098    .4817874
         28  |   .2857006   .0556667     5.13   0.000     .1765925    .3948087
         29  |   .2010951   .0547325     3.67   0.000     .0938182    .3083721
         30  |   .1491075   .0540157     2.76   0.006     .0432353    .2549797
         31  |   .1176296    .053689     2.19   0.028     .0123979    .2228613
         32  |    .083405    .052589     1.59   0.113    -.0196706    .1864807
         33  |    .052666   .0526615     1.00   0.317    -.0505518    .1558838
         34  |    .042238   .0528732     0.80   0.424    -.0613948    .1458708
         35  |  -.0000714   .0536155    -0.00   0.999    -.1051591    .1050162
         36  |  -.0503674   .0544797    -0.92   0.355    -.1571489     .056414
         37  |  -.0816758   .0548005    -1.49   0.136    -.1890861    .0257345
         38  |  -.1319247   .0552942    -2.39   0.017    -.2403026   -.0235467
         39  |  -.1611126   .0560231    -2.88   0.004    -.2709193   -.0513058
         40  |  -.1575275   .0559766    -2.81   0.005     -.267243   -.0478119
         41  |  -.2009773   .0563798    -3.56   0.000     -.311483   -.0904715
         42  |  -.2318878   .0570998    -4.06   0.000    -.3438047   -.1199709
         43  |  -.3232849    .058042    -5.57   0.000    -.4370487   -.2095212
         44  |  -.3640045   .0586182    -6.21   0.000    -.4788977   -.2491113
         45  |  -.3639286   .0592401    -6.14   0.000    -.4800406   -.2478167
         46  |  -.3796855   .0601532    -6.31   0.000    -.4975871   -.2617838
         47  |  -.3968494   .0609756    -6.51   0.000     -.516363   -.2773358
         48  |  -.3949336   .0621132    -6.36   0.000     -.516677   -.2731902
         49  |  -.4109135   .0641065    -6.41   0.000    -.5365638   -.2852631
         50  |  -.3889286   .0646425    -6.02   0.000    -.5156294   -.2622277
             |
     age_cat |
          2  |   .3719635   .0123463    30.13   0.000     .3477646    .3961625
          3  |   .6482071   .0143649    45.12   0.000     .6200515    .6763626
          4  |   .9039363   .0170269    53.09   0.000     .8705633    .9373094
          5  |   1.073129   .0223127    48.09   0.000     1.029396    1.116863
          6  |   1.177516   .0263621    44.67   0.000     1.125845    1.229186
             |
       _cons |   3.327511    .036161    92.02   0.000     3.256635    3.398388
-------------+----------------------------------------------------------------
     sigma_u |  1.0836658
     sigma_e |  .55369576
         rho |  .79297941   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =    169,275
Group variable: id                              Number of groups  =     36,025

R-sq:                                           Obs per group:
     within  = 0.1318                                         min =          1
     between = 0.1483                                         avg =        4.7
     overall = 0.1561                                         max =          9

                                                F(58,36024)       =     123.65
corr(u_i, Xb)  = 0.1289                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 36,025 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.1154878   .0782264    -1.48   0.140    -.2688139    .0378382
         new |  -.0163163   .0095085    -1.72   0.086    -.0349532    .0023206
        fnew |  -.2463283   .0800282    -3.08   0.002     -.403186   -.0894706
  fnew_expat |   -.044086   .1269046    -0.35   0.728    -.2928228    .2046508
             |
    ind_year |
          2  |   .0565654   .0265892     2.13   0.033     .0044498     .108681
          3  |   .6199785   .0336911    18.40   0.000      .553943    .6860139
          4  |   .6887833   .0385649    17.86   0.000     .6131951    .7643716
          5  |   .7892983   .0438816    17.99   0.000      .703289    .8753077
          6  |   .9467626   .0483241    19.59   0.000      .852046    1.041479
          7  |   1.170325   .0528172    22.16   0.000     1.066801    1.273848
          8  |   1.335898   .0555487    24.05   0.000     1.227021    1.444776
          9  |   1.457396    .057763    25.23   0.000     1.344179    1.570613
         10  |   1.529513   .0599161    25.53   0.000     1.412076    1.646951
         11  |   1.609193   .0615826    26.13   0.000     1.488489    1.729897
         12  |   1.663036    .062775    26.49   0.000     1.539995    1.786077
         13  |   1.739161   .0638688    27.23   0.000     1.613977    1.864346
         14  |   1.734611   .0652463    26.59   0.000     1.606727    1.862496
         15  |   1.728341     .06622    26.10   0.000     1.598548    1.858134
         16  |   1.789042    .067141    26.65   0.000     1.657444     1.92064
         17  |   1.814859   .0684891    26.50   0.000     1.680618    1.949099
         18  |    1.84116   .0692414    26.59   0.000     1.705445    1.976875
         19  |   1.752979   .0703563    24.92   0.000     1.615078    1.890879
         20  |   1.724779   .0714804    24.13   0.000     1.584675    1.864883
         21  |   1.775744   .0724255    24.52   0.000     1.633788    1.917701
         22  |    1.81217   .0741821    24.43   0.000     1.666771    1.957569
         23  |    1.93641   .0759634    25.49   0.000     1.787519    2.085301
         24  |   1.400297   .0852087    16.43   0.000     1.233285    1.567309
         25  |   1.416573   .0914575    15.49   0.000     1.237313    1.595832
         26  |   .8799852   .0849652    10.36   0.000     .7134508     1.04652
         27  |   .9163563    .079348    11.55   0.000     .7608319    1.071881
         28  |   1.111966   .0766871    14.50   0.000     .9616573    1.262275
         29  |   1.203724   .0745994    16.14   0.000     1.057507    1.349941
         30  |   1.209018   .0736885    16.41   0.000     1.064587     1.35345
         31  |   1.359788   .0728877    18.66   0.000     1.216926     1.50265
         32  |   1.551861   .0712822    21.77   0.000     1.412145    1.691576
         33  |   1.643374   .0710832    23.12   0.000     1.504048    1.782699
         34  |   1.736576   .0716146    24.25   0.000     1.596209    1.876942
         35  |   1.806984   .0726329    24.88   0.000     1.664622    1.949347
         36  |   1.905283   .0735819    25.89   0.000      1.76106    2.049506
         37  |   1.971129   .0744876    26.46   0.000     1.825131    2.117127
         38  |   1.993193   .0752179    26.50   0.000     1.845764    2.140623
         39  |   2.007969   .0760866    26.39   0.000     1.858837    2.157101
         40  |   2.033535   .0762356    26.67   0.000     1.884111    2.182959
         41  |   2.035572   .0766064    26.57   0.000     1.885421    2.185723
         42  |   2.094279   .0778007    26.92   0.000     1.941787    2.246771
         43  |   2.073943   .0798902    25.96   0.000     1.917356     2.23053
         44  |   2.050981   .0808853    25.36   0.000     1.892443    2.209519
         45  |   2.090867     .08151    25.65   0.000     1.931105    2.250629
         46  |   2.054291   .0824173    24.93   0.000     1.892751    2.215832
         47  |   2.012149   .0850822    23.65   0.000     1.845386    2.178913
         48  |   2.106088   .0865874    24.32   0.000     1.936374    2.275802
         49  |   1.774076   .0968478    18.32   0.000     1.584251      1.9639
         50  |   2.007197   .1041863    19.27   0.000     1.802988    2.211405
             |
     age_cat |
          2  |   .4447211    .023191    19.18   0.000     .3992661    .4901761
          3  |   .7324825   .0256464    28.56   0.000     .6822148    .7827502
          4  |   1.032379   .0287358    35.93   0.000     .9760556    1.088702
          5  |   1.155736   .0349584    33.06   0.000     1.087217    1.224256
          6  |   1.260438   .0398455    31.63   0.000     1.182339    1.338536
             |
       _cons |   7.337393   .0535854   136.93   0.000     7.232364    7.442422
-------------+----------------------------------------------------------------
     sigma_u |  1.9421812
     sigma_e |  .78829045
         rho |  .85856239   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1318295205642419

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    169,275
Group variable: id                              Number of groups  =     36,025

R-sq:                                           Obs per group:
     within  = 0.1318                                         min =          1
     between = 0.1483                                         avg =        4.7
     overall = 0.1561                                         max =          9

                                                F(58,36024)       =     123.65
corr(u_i, Xb)  = 0.1289                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 36,025 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.1154878   .0782264    -1.48   0.140    -.2688139    .0378382
         new |  -.0163163   .0095085    -1.72   0.086    -.0349532    .0023206
        fnew |  -.2463283   .0800282    -3.08   0.002     -.403186   -.0894706
  fnew_expat |   -.044086   .1269046    -0.35   0.728    -.2928228    .2046508
             |
    ind_year |
          2  |   .0565654   .0265892     2.13   0.033     .0044498     .108681
          3  |   .6199785   .0336911    18.40   0.000      .553943    .6860139
          4  |   .6887833   .0385649    17.86   0.000     .6131951    .7643716
          5  |   .7892983   .0438816    17.99   0.000      .703289    .8753077
          6  |   .9467626   .0483241    19.59   0.000      .852046    1.041479
          7  |   1.170325   .0528172    22.16   0.000     1.066801    1.273848
          8  |   1.335898   .0555487    24.05   0.000     1.227021    1.444776
          9  |   1.457396    .057763    25.23   0.000     1.344179    1.570613
         10  |   1.529513   .0599161    25.53   0.000     1.412076    1.646951
         11  |   1.609193   .0615826    26.13   0.000     1.488489    1.729897
         12  |   1.663036    .062775    26.49   0.000     1.539995    1.786077
         13  |   1.739161   .0638688    27.23   0.000     1.613977    1.864346
         14  |   1.734611   .0652463    26.59   0.000     1.606727    1.862496
         15  |   1.728341     .06622    26.10   0.000     1.598548    1.858134
         16  |   1.789042    .067141    26.65   0.000     1.657444     1.92064
         17  |   1.814859   .0684891    26.50   0.000     1.680618    1.949099
         18  |    1.84116   .0692414    26.59   0.000     1.705445    1.976875
         19  |   1.752979   .0703563    24.92   0.000     1.615078    1.890879
         20  |   1.724779   .0714804    24.13   0.000     1.584675    1.864883
         21  |   1.775744   .0724255    24.52   0.000     1.633788    1.917701
         22  |    1.81217   .0741821    24.43   0.000     1.666771    1.957569
         23  |    1.93641   .0759634    25.49   0.000     1.787519    2.085301
         24  |   1.400297   .0852087    16.43   0.000     1.233285    1.567309
         25  |   1.416573   .0914575    15.49   0.000     1.237313    1.595832
         26  |   .8799852   .0849652    10.36   0.000     .7134508     1.04652
         27  |   .9163563    .079348    11.55   0.000     .7608319    1.071881
         28  |   1.111966   .0766871    14.50   0.000     .9616573    1.262275
         29  |   1.203724   .0745994    16.14   0.000     1.057507    1.349941
         30  |   1.209018   .0736885    16.41   0.000     1.064587     1.35345
         31  |   1.359788   .0728877    18.66   0.000     1.216926     1.50265
         32  |   1.551861   .0712822    21.77   0.000     1.412145    1.691576
         33  |   1.643374   .0710832    23.12   0.000     1.504048    1.782699
         34  |   1.736576   .0716146    24.25   0.000     1.596209    1.876942
         35  |   1.806984   .0726329    24.88   0.000     1.664622    1.949347
         36  |   1.905283   .0735819    25.89   0.000      1.76106    2.049506
         37  |   1.971129   .0744876    26.46   0.000     1.825131    2.117127
         38  |   1.993193   .0752179    26.50   0.000     1.845764    2.140623
         39  |   2.007969   .0760866    26.39   0.000     1.858837    2.157101
         40  |   2.033535   .0762356    26.67   0.000     1.884111    2.182959
         41  |   2.035572   .0766064    26.57   0.000     1.885421    2.185723
         42  |   2.094279   .0778007    26.92   0.000     1.941787    2.246771
         43  |   2.073943   .0798902    25.96   0.000     1.917356     2.23053
         44  |   2.050981   .0808853    25.36   0.000     1.892443    2.209519
         45  |   2.090867     .08151    25.65   0.000     1.931105    2.250629
         46  |   2.054291   .0824173    24.93   0.000     1.892751    2.215832
         47  |   2.012149   .0850822    23.65   0.000     1.845386    2.178913
         48  |   2.106088   .0865874    24.32   0.000     1.936374    2.275802
         49  |   1.774076   .0968478    18.32   0.000     1.584251      1.9639
         50  |   2.007197   .1041863    19.27   0.000     1.802988    2.211405
             |
     age_cat |
          2  |   .4447211    .023191    19.18   0.000     .3992661    .4901761
          3  |   .7324825   .0256464    28.56   0.000     .6822148    .7827502
          4  |   1.032379   .0287358    35.93   0.000     .9760556    1.088702
          5  |   1.155736   .0349584    33.06   0.000     1.087217    1.224256
          6  |   1.260438   .0398455    31.63   0.000     1.182339    1.338536
             |
       _cons |   7.337393   .0535854   136.93   0.000     7.232364    7.442422
-------------+----------------------------------------------------------------
     sigma_u |  1.9421812
     sigma_e |  .78829045
         rho |  .85856239   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =    188,472
Group variable: id                              Number of groups  =     39,342

R-sq:                                           Obs per group:
     within  = 0.1601                                         min =          1
     between = 0.1435                                         avg =        4.8
     overall = 0.1420                                         max =          9

                                                F(58,39341)       =     184.61
corr(u_i, Xb)  = 0.0857                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 39,342 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0057001   .0567902    -0.10   0.920    -.1170104    .1056101
         new |  -.0124149   .0076399    -1.63   0.104    -.0273894    .0025595
        fnew |  -.0049859   .0547852    -0.09   0.927    -.1123662    .1023945
  fnew_expat |   .1978389   .0899619     2.20   0.028     .0215114    .3741663
             |
    ind_year |
          2  |   .0283021   .0163236     1.73   0.083    -.0036924    .0602967
          3  |   .1259989   .0209017     6.03   0.000      .085031    .1669668
          4  |   .2317025   .0245497     9.44   0.000     .1835845    .2798206
          5  |   .3384993   .0283287    11.95   0.000     .2829744    .3940243
          6  |   .4718322   .0319999    14.74   0.000     .4091116    .5345528
          7  |    .575756   .0369138    15.60   0.000      .503404    .6481081
          8  |   .6649527   .0402132    16.54   0.000     .5861338    .7437716
          9  |   .7742565     .04219    18.35   0.000     .6915631    .8569498
         10  |   .8616874   .0439324    19.61   0.000      .775579    .9477959
         11  |    .896207   .0456318    19.64   0.000     .8067676    .9856465
         12  |    .882894    .046822    18.86   0.000     .7911216    .9746663
         13  |   .9156197   .0474411    19.30   0.000     .8226341    1.008605
         14  |   .9198642    .048591    18.93   0.000     .8246247    1.015104
         15  |   .9803691    .049839    19.67   0.000     .8826834    1.078055
         16  |   .9849859    .050373    19.55   0.000     .8862536    1.083718
         17  |   1.041176   .0514668    20.23   0.000     .9403001    1.142053
         18  |   .9227469   .0523199    17.64   0.000     .8201986    1.025295
         19  |   .9254704   .0533925    17.33   0.000     .8208198    1.030121
         20  |    .927694   .0540778    17.15   0.000     .8217001    1.033688
         21  |   .9580369    .054675    17.52   0.000     .8508726    1.065201
         22  |   .9675468   .0564226    17.15   0.000     .8569571    1.078136
         23  |   1.013069   .0571527    17.73   0.000     .9010483     1.12509
         24  |   1.000246   .0588553    17.00   0.000     .8848885    1.115604
         25  |   1.026642   .0602023    17.05   0.000     .9086437     1.14464
         26  |    .402947   .0635775     6.34   0.000     .2783336    .5275605
         27  |   .4358044   .0573658     7.60   0.000      .323366    .5482428
         28  |   .5269547   .0551311     9.56   0.000     .4188965     .635013
         29  |   .6514341   .0543056    12.00   0.000     .5449937    .7578745
         30  |   .7624649   .0529784    14.39   0.000      .658626    .8663038
         31  |   .8859001   .0525734    16.85   0.000      .782855    .9889453
         32  |   .9942038   .0519378    19.14   0.000     .8924045    1.096003
         33  |    1.00923   .0526722    19.16   0.000     .9059915    1.112469
         34  |    1.12864   .0530509    21.27   0.000     1.024659    1.232621
         35  |   1.188393   .0540659    21.98   0.000     1.082422    1.294363
         36  |   1.191806   .0548528    21.73   0.000     1.084293    1.299319
         37  |   1.210754   .0552133    21.93   0.000     1.102535    1.318974
         38  |   1.257425   .0555718    22.63   0.000     1.148503    1.366347
         39  |   1.257384   .0564961    22.26   0.000      1.14665    1.368118
         40  |   1.330984   .0571194    23.30   0.000     1.219029     1.44294
         41  |   1.379903    .057554    23.98   0.000     1.267096     1.49271
         42  |   1.440068   .0585912    24.58   0.000     1.325228    1.554908
         43  |   1.311721   .0595602    22.02   0.000     1.194982     1.42846
         44  |   1.273016   .0606318    21.00   0.000     1.154176    1.391855
         45  |   1.340005   .0619645    21.63   0.000     1.218553    1.461457
         46  |   1.343162   .0635133    21.15   0.000     1.218674    1.467649
         47  |   1.319591   .0649934    20.30   0.000     1.192202     1.44698
         48  |    1.36536   .0659312    20.71   0.000     1.236133    1.494587
         49  |   1.361316   .0687441    19.80   0.000     1.226576    1.496056
         50  |   1.369513   .0692837    19.77   0.000     1.233716    1.505311
             |
     age_cat |
          2  |   .6614462   .0148364    44.58   0.000     .6323666    .6905258
          3  |   .9429457   .0166472    56.64   0.000     .9103168    .9755747
          4  |   1.188738   .0194058    61.26   0.000     1.150702    1.226774
          5  |   1.364141   .0248362    54.93   0.000     1.315462    1.412821
          6  |    1.46972    .029359    50.06   0.000     1.412175    1.527264
             |
       _cons |   10.56634   .0374274   282.32   0.000     10.49298     10.6397
-------------+----------------------------------------------------------------
     sigma_u |  1.5308909
     sigma_e |  .62593215
         rho |  .85677105   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .160123539447793

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    188,472
Group variable: id                              Number of groups  =     39,342

R-sq:                                           Obs per group:
     within  = 0.1601                                         min =          1
     between = 0.1435                                         avg =        4.8
     overall = 0.1420                                         max =          9

                                                F(58,39341)       =     184.61
corr(u_i, Xb)  = 0.0857                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 39,342 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0057001   .0567902    -0.10   0.920    -.1170104    .1056101
         new |  -.0124149   .0076399    -1.63   0.104    -.0273894    .0025595
        fnew |  -.0049859   .0547852    -0.09   0.927    -.1123662    .1023945
  fnew_expat |   .1978389   .0899619     2.20   0.028     .0215114    .3741663
             |
    ind_year |
          2  |   .0283021   .0163236     1.73   0.083    -.0036924    .0602967
          3  |   .1259989   .0209017     6.03   0.000      .085031    .1669668
          4  |   .2317025   .0245497     9.44   0.000     .1835845    .2798206
          5  |   .3384993   .0283287    11.95   0.000     .2829744    .3940243
          6  |   .4718322   .0319999    14.74   0.000     .4091116    .5345528
          7  |    .575756   .0369138    15.60   0.000      .503404    .6481081
          8  |   .6649527   .0402132    16.54   0.000     .5861338    .7437716
          9  |   .7742565     .04219    18.35   0.000     .6915631    .8569498
         10  |   .8616874   .0439324    19.61   0.000      .775579    .9477959
         11  |    .896207   .0456318    19.64   0.000     .8067676    .9856465
         12  |    .882894    .046822    18.86   0.000     .7911216    .9746663
         13  |   .9156197   .0474411    19.30   0.000     .8226341    1.008605
         14  |   .9198642    .048591    18.93   0.000     .8246247    1.015104
         15  |   .9803691    .049839    19.67   0.000     .8826834    1.078055
         16  |   .9849859    .050373    19.55   0.000     .8862536    1.083718
         17  |   1.041176   .0514668    20.23   0.000     .9403001    1.142053
         18  |   .9227469   .0523199    17.64   0.000     .8201986    1.025295
         19  |   .9254704   .0533925    17.33   0.000     .8208198    1.030121
         20  |    .927694   .0540778    17.15   0.000     .8217001    1.033688
         21  |   .9580369    .054675    17.52   0.000     .8508726    1.065201
         22  |   .9675468   .0564226    17.15   0.000     .8569571    1.078136
         23  |   1.013069   .0571527    17.73   0.000     .9010483     1.12509
         24  |   1.000246   .0588553    17.00   0.000     .8848885    1.115604
         25  |   1.026642   .0602023    17.05   0.000     .9086437     1.14464
         26  |    .402947   .0635775     6.34   0.000     .2783336    .5275605
         27  |   .4358044   .0573658     7.60   0.000      .323366    .5482428
         28  |   .5269547   .0551311     9.56   0.000     .4188965     .635013
         29  |   .6514341   .0543056    12.00   0.000     .5449937    .7578745
         30  |   .7624649   .0529784    14.39   0.000      .658626    .8663038
         31  |   .8859001   .0525734    16.85   0.000      .782855    .9889453
         32  |   .9942038   .0519378    19.14   0.000     .8924045    1.096003
         33  |    1.00923   .0526722    19.16   0.000     .9059915    1.112469
         34  |    1.12864   .0530509    21.27   0.000     1.024659    1.232621
         35  |   1.188393   .0540659    21.98   0.000     1.082422    1.294363
         36  |   1.191806   .0548528    21.73   0.000     1.084293    1.299319
         37  |   1.210754   .0552133    21.93   0.000     1.102535    1.318974
         38  |   1.257425   .0555718    22.63   0.000     1.148503    1.366347
         39  |   1.257384   .0564961    22.26   0.000      1.14665    1.368118
         40  |   1.330984   .0571194    23.30   0.000     1.219029     1.44294
         41  |   1.379903    .057554    23.98   0.000     1.267096     1.49271
         42  |   1.440068   .0585912    24.58   0.000     1.325228    1.554908
         43  |   1.311721   .0595602    22.02   0.000     1.194982     1.42846
         44  |   1.273016   .0606318    21.00   0.000     1.154176    1.391855
         45  |   1.340005   .0619645    21.63   0.000     1.218553    1.461457
         46  |   1.343162   .0635133    21.15   0.000     1.218674    1.467649
         47  |   1.319591   .0649934    20.30   0.000     1.192202     1.44698
         48  |    1.36536   .0659312    20.71   0.000     1.236133    1.494587
         49  |   1.361316   .0687441    19.80   0.000     1.226576    1.496056
         50  |   1.369513   .0692837    19.77   0.000     1.233716    1.505311
             |
     age_cat |
          2  |   .6614462   .0148364    44.58   0.000     .6323666    .6905258
          3  |   .9429457   .0166472    56.64   0.000     .9103168    .9755747
          4  |   1.188738   .0194058    61.26   0.000     1.150702    1.226774
          5  |   1.364141   .0248362    54.93   0.000     1.315462    1.412821
          6  |    1.46972    .029359    50.06   0.000     1.412175    1.527264
             |
       _cons |   10.56634   .0374274   282.32   0.000     10.49298     10.6397
-------------+----------------------------------------------------------------
     sigma_u |  1.5308909
     sigma_e |  .62593215
         rho |  .85677105   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =    169,275
Group variable: id                              Number of groups  =     36,025

R-sq:                                           Obs per group:
     within  = 0.0924                                         min =          1
     between = 0.0987                                         avg =        4.7
     overall = 0.1246                                         max =          9

                                                F(58,36024)       =      95.34
corr(u_i, Xb)  = 0.0118                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 36,025 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0636662   .0724895    -0.88   0.380    -.2057479    .0784154
         new |   .0368556   .0089951     4.10   0.000     .0192249    .0544862
        fnew |  -.2204396   .0753965    -2.92   0.003     -.368219   -.0726603
  fnew_expat |  -.0508506     .10932    -0.47   0.642     -.265121    .1634198
             |
    ind_year |
          2  |   .1636757    .024185     6.77   0.000     .1162724    .2110791
          3  |   .8232355   .0297991    27.63   0.000     .7648284    .8816426
          4  |   .9846924   .0334046    29.48   0.000     .9192184    1.050166
          5  |   1.170016   .0372389    31.42   0.000     1.097027    1.243005
          6  |   1.363258   .0408786    33.35   0.000     1.283135    1.443382
          7  |   1.608156   .0443126    36.29   0.000     1.521302     1.69501
          8  |   1.774786   .0466355    38.06   0.000     1.683379    1.866193
          9  |   1.896888    .048396    39.20   0.000     1.802031    1.991746
         10  |   2.001658   .0504315    39.69   0.000     1.902811    2.100505
         11  |   2.127306   .0518369    41.04   0.000     2.025704    2.228908
         12  |   2.203989   .0529167    41.65   0.000     2.100271    2.307708
         13  |   2.289141   .0540618    42.34   0.000     2.183178    2.395104
         14  |   2.321541    .055433    41.88   0.000     2.212891    2.430192
         15  |   2.340758     .05633    41.55   0.000      2.23035    2.451167
         16  |   2.423121    .057133    42.41   0.000     2.311138    2.535103
         17  |   2.468426    .058556    42.15   0.000     2.353654    2.583197
         18  |   2.549915   .0597357    42.69   0.000     2.432831    2.666999
         19  |   2.491365   .0609687    40.86   0.000     2.371864    2.610865
         20  |   2.502096   .0622337    40.20   0.000     2.380115    2.624076
         21  |   2.559009    .063379    40.38   0.000     2.434784    2.683233
         22  |   2.592622   .0649789    39.90   0.000     2.465262    2.719983
         23  |   2.721127   .0669439    40.65   0.000     2.589915    2.852339
         24  |   2.156494   .0775935    27.79   0.000     2.004409     2.30858
         25  |     2.1822   .0838868    26.01   0.000      2.01778    2.346621
         26  |   .4496714   .0713888     6.30   0.000     .3097471    .5895956
         27  |   .5941147   .0665422     8.93   0.000       .46369    .7245393
         28  |   .8825889   .0642326    13.74   0.000     .7566911    1.008487
         29  |   1.059737   .0627246    16.90   0.000     .9367944    1.182679
         30  |   1.118244   .0621909    17.98   0.000     .9963478     1.24014
         31  |    1.29478   .0621656    20.83   0.000     1.172934    1.416627
         32  |   1.533832   .0608614    25.20   0.000     1.414542    1.653122
         33  |   1.654292   .0609231    27.15   0.000     1.534881    1.773703
         34  |   1.757145   .0616547    28.50   0.000       1.6363    1.877991
         35  |   1.869949   .0625261    29.91   0.000     1.747396    1.992502
         36  |   2.019545   .0634023    31.85   0.000     1.895275    2.143816
         37  |   2.122808   .0642937    33.02   0.000      1.99679    2.248825
         38  |   2.181455   .0657574    33.17   0.000     2.052568    2.310341
         39  |   2.226085    .066731    33.36   0.000     2.095291     2.35688
         40  |   2.237682   .0672618    33.27   0.000     2.105847    2.369517
         41  |   2.287911   .0673932    33.95   0.000     2.155818    2.420004
         42  |   2.381892   .0684504    34.80   0.000     2.247727    2.516057
         43  |   2.439632   .0698586    34.92   0.000     2.302707    2.576557
         44  |    2.45707   .0708157    34.70   0.000     2.318269     2.59587
         45  |   2.497849   .0719061    34.74   0.000     2.356911    2.638788
         46  |   2.475795   .0730154    33.91   0.000     2.332683    2.618907
         47  |   2.448677   .0751601    32.58   0.000     2.301361    2.595993
         48  |   2.542889   .0768051    33.11   0.000     2.392348    2.693429
         49  |   2.160625   .0866939    24.92   0.000     1.990702    2.330548
         50  |   2.339689    .094274    24.82   0.000     2.154909    2.524468
             |
     age_cat |
          2  |   .0868364   .0227953     3.81   0.000      .042157    .1315158
          3  |   .1128281   .0250341     4.51   0.000     .0637605    .1618956
          4  |   .1658093   .0275572     6.02   0.000     .1117963    .2198223
          5  |   .1361209   .0330614     4.12   0.000     .0713195    .2009222
          6  |   .1385272   .0373655     3.71   0.000     .0652898    .2117646
             |
       _cons |   3.897405   .0455233    85.61   0.000     3.808177    3.986632
-------------+----------------------------------------------------------------
     sigma_u |   1.720049
     sigma_e |  .75886013
         rho |   .8370692   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0924486827550339

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    169,275
Group variable: id                              Number of groups  =     36,025

R-sq:                                           Obs per group:
     within  = 0.0924                                         min =          1
     between = 0.0987                                         avg =        4.7
     overall = 0.1246                                         max =          9

                                                F(58,36024)       =      95.34
corr(u_i, Xb)  = 0.0118                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 36,025 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0636662   .0724895    -0.88   0.380    -.2057479    .0784154
         new |   .0368556   .0089951     4.10   0.000     .0192249    .0544862
        fnew |  -.2204396   .0753965    -2.92   0.003     -.368219   -.0726603
  fnew_expat |  -.0508506     .10932    -0.47   0.642     -.265121    .1634198
             |
    ind_year |
          2  |   .1636757    .024185     6.77   0.000     .1162724    .2110791
          3  |   .8232355   .0297991    27.63   0.000     .7648284    .8816426
          4  |   .9846924   .0334046    29.48   0.000     .9192184    1.050166
          5  |   1.170016   .0372389    31.42   0.000     1.097027    1.243005
          6  |   1.363258   .0408786    33.35   0.000     1.283135    1.443382
          7  |   1.608156   .0443126    36.29   0.000     1.521302     1.69501
          8  |   1.774786   .0466355    38.06   0.000     1.683379    1.866193
          9  |   1.896888    .048396    39.20   0.000     1.802031    1.991746
         10  |   2.001658   .0504315    39.69   0.000     1.902811    2.100505
         11  |   2.127306   .0518369    41.04   0.000     2.025704    2.228908
         12  |   2.203989   .0529167    41.65   0.000     2.100271    2.307708
         13  |   2.289141   .0540618    42.34   0.000     2.183178    2.395104
         14  |   2.321541    .055433    41.88   0.000     2.212891    2.430192
         15  |   2.340758     .05633    41.55   0.000      2.23035    2.451167
         16  |   2.423121    .057133    42.41   0.000     2.311138    2.535103
         17  |   2.468426    .058556    42.15   0.000     2.353654    2.583197
         18  |   2.549915   .0597357    42.69   0.000     2.432831    2.666999
         19  |   2.491365   .0609687    40.86   0.000     2.371864    2.610865
         20  |   2.502096   .0622337    40.20   0.000     2.380115    2.624076
         21  |   2.559009    .063379    40.38   0.000     2.434784    2.683233
         22  |   2.592622   .0649789    39.90   0.000     2.465262    2.719983
         23  |   2.721127   .0669439    40.65   0.000     2.589915    2.852339
         24  |   2.156494   .0775935    27.79   0.000     2.004409     2.30858
         25  |     2.1822   .0838868    26.01   0.000      2.01778    2.346621
         26  |   .4496714   .0713888     6.30   0.000     .3097471    .5895956
         27  |   .5941147   .0665422     8.93   0.000       .46369    .7245393
         28  |   .8825889   .0642326    13.74   0.000     .7566911    1.008487
         29  |   1.059737   .0627246    16.90   0.000     .9367944    1.182679
         30  |   1.118244   .0621909    17.98   0.000     .9963478     1.24014
         31  |    1.29478   .0621656    20.83   0.000     1.172934    1.416627
         32  |   1.533832   .0608614    25.20   0.000     1.414542    1.653122
         33  |   1.654292   .0609231    27.15   0.000     1.534881    1.773703
         34  |   1.757145   .0616547    28.50   0.000       1.6363    1.877991
         35  |   1.869949   .0625261    29.91   0.000     1.747396    1.992502
         36  |   2.019545   .0634023    31.85   0.000     1.895275    2.143816
         37  |   2.122808   .0642937    33.02   0.000      1.99679    2.248825
         38  |   2.181455   .0657574    33.17   0.000     2.052568    2.310341
         39  |   2.226085    .066731    33.36   0.000     2.095291     2.35688
         40  |   2.237682   .0672618    33.27   0.000     2.105847    2.369517
         41  |   2.287911   .0673932    33.95   0.000     2.155818    2.420004
         42  |   2.381892   .0684504    34.80   0.000     2.247727    2.516057
         43  |   2.439632   .0698586    34.92   0.000     2.302707    2.576557
         44  |    2.45707   .0708157    34.70   0.000     2.318269     2.59587
         45  |   2.497849   .0719061    34.74   0.000     2.356911    2.638788
         46  |   2.475795   .0730154    33.91   0.000     2.332683    2.618907
         47  |   2.448677   .0751601    32.58   0.000     2.301361    2.595993
         48  |   2.542889   .0768051    33.11   0.000     2.392348    2.693429
         49  |   2.160625   .0866939    24.92   0.000     1.990702    2.330548
         50  |   2.339689    .094274    24.82   0.000     2.154909    2.524468
             |
     age_cat |
          2  |   .0868364   .0227953     3.81   0.000      .042157    .1315158
          3  |   .1128281   .0250341     4.51   0.000     .0637605    .1618956
          4  |   .1658093   .0275572     6.02   0.000     .1117963    .2198223
          5  |   .1361209   .0330614     4.12   0.000     .0713195    .2009222
          6  |   .1385272   .0373655     3.71   0.000     .0652898    .2117646
             |
       _cons |   3.897405   .0455233    85.61   0.000     3.808177    3.986632
-------------+----------------------------------------------------------------
     sigma_u |   1.720049
     sigma_e |  .75886013
         rho |   .8370692   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =    188,472
Group variable: id                              Number of groups  =     39,342

R-sq:                                           Obs per group:
     within  = 0.1143                                         min =          1
     between = 0.1365                                         avg =        4.8
     overall = 0.1440                                         max =          9

                                                F(58,39341)       =     158.41
corr(u_i, Xb)  = 0.0146                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 39,342 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0442392   .0399712     1.11   0.268    -.0341054    .1225838
         new |   .0266364   .0059205     4.50   0.000     .0150322    .0382407
        fnew |   .0609923   .0439249     1.39   0.165    -.0251016    .1470861
  fnew_expat |   .2399194   .0742825     3.23   0.001     .0943239    .3855149
             |
    ind_year |
          2  |   .1286405   .0134257     9.58   0.000     .1023259    .1549552
          3  |   .3184571   .0166648    19.11   0.000     .2857936    .3511205
          4  |   .5103233   .0189794    26.89   0.000     .4731232    .5475235
          5  |   .6784001   .0209851    32.33   0.000     .6372688    .7195314
          6  |   .8412912    .023192    36.28   0.000     .7958344    .8867481
          7  |   .9539087    .025948    36.76   0.000       .90305    1.004767
          8  |   1.045088   .0280838    37.21   0.000      .990043    1.100133
          9  |   1.165594   .0288383    40.42   0.000      1.10907    1.222117
         10  |   1.285453    .029908    42.98   0.000     1.226833    1.344074
         11  |   1.369947   .0309422    44.27   0.000       1.3093    1.430595
         12  |   1.380845   .0319855    43.17   0.000     1.318152    1.443537
         13  |   1.428179   .0327521    43.61   0.000     1.363984    1.492374
         14  |   1.481391    .033654    44.02   0.000     1.415429    1.547354
         15  |   1.562621   .0344148    45.41   0.000     1.495167    1.630074
         16  |   1.593939   .0349205    45.64   0.000     1.525494    1.662384
         17  |   1.672216   .0358219    46.68   0.000     1.602004    1.742428
         18  |   1.605491   .0365226    43.96   0.000     1.533906    1.677076
         19  |   1.642035   .0376001    43.67   0.000     1.568338    1.715732
         20  |   1.690526   .0382796    44.16   0.000     1.615497    1.765555
         21  |   1.742002   .0389123    44.77   0.000     1.665732    1.818271
         22  |   1.762477   .0404918    43.53   0.000     1.683112    1.841842
         23  |    1.80421   .0408828    44.13   0.000     1.724079    1.884341
         24  |   1.834525   .0428883    42.77   0.000     1.750463    1.918587
         25  |   1.836936   .0436647    42.07   0.000     1.751352     1.92252
         26  |  -.0583833   .0425973    -1.37   0.171     -.141875    .0251084
         27  |   .0650558   .0391999     1.66   0.097     -.011777    .1418885
         28  |   .2412542   .0377708     6.39   0.000     .1672225    .3152858
         29  |    .450339   .0376549    11.96   0.000     .3765344    .5241435
         30  |   .6133574   .0366722    16.73   0.000     .5414791    .6852358
         31  |   .7682705   .0368701    20.84   0.000     .6960041    .8405369
         32  |   .9107988   .0358015    25.44   0.000     .8406269    .9809706
         33  |   .9565643    .036068    26.52   0.000     .8858702    1.027258
         34  |   1.086402   .0361079    30.09   0.000      1.01563    1.157175
         35  |   1.188464   .0365891    32.48   0.000     1.116749     1.26018
         36  |   1.242174   .0369741    33.60   0.000     1.169704    1.314644
         37  |    1.29243   .0377706    34.22   0.000     1.218399    1.366461
         38  |   1.389349   .0383237    36.25   0.000     1.314234    1.464465
         39  |   1.418497   .0392332    36.16   0.000     1.341599    1.495395
         40  |   1.488512   .0399656    37.24   0.000     1.410178    1.566845
         41  |    1.58088   .0400922    39.43   0.000     1.502299    1.659462
         42  |   1.671956   .0407731    41.01   0.000      1.59204    1.751872
         43  |   1.635006   .0417845    39.13   0.000     1.553107    1.716904
         44  |    1.63702   .0426307    38.40   0.000     1.553463    1.720577
         45  |   1.703933     .04344    39.23   0.000      1.61879    1.789077
         46  |   1.722847   .0443142    38.88   0.000      1.63599    1.809704
         47  |    1.71644   .0453937    37.81   0.000     1.627468    1.805413
         48  |   1.760294    .046379    37.95   0.000      1.66939    1.851198
         49  |   1.772229   .0490021    36.17   0.000     1.676184    1.868274
         50  |   1.758442   .0493116    35.66   0.000      1.66179    1.855094
             |
     age_cat |
          2  |   .2894826   .0123979    23.35   0.000     .2651825    .3137828
          3  |   .2947387   .0136661    21.57   0.000     .2679527    .3215246
          4  |   .2848014   .0150895    18.87   0.000     .2552257    .3143772
          5  |   .2910118   .0185287    15.71   0.000     .2546951    .3273285
          6  |   .2922041   .0213841    13.66   0.000     .2502907    .3341174
             |
       _cons |   7.238826   .0266193   271.94   0.000     7.186652    7.291001
-------------+----------------------------------------------------------------
     sigma_u |   1.235681
     sigma_e |   .5012289
         rho |  .85871152   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1143492020816038

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    188,472
Group variable: id                              Number of groups  =     39,342

R-sq:                                           Obs per group:
     within  = 0.1143                                         min =          1
     between = 0.1365                                         avg =        4.8
     overall = 0.1440                                         max =          9

                                                F(58,39341)       =     158.41
corr(u_i, Xb)  = 0.0146                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 39,342 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0442392   .0399712     1.11   0.268    -.0341054    .1225838
         new |   .0266364   .0059205     4.50   0.000     .0150322    .0382407
        fnew |   .0609923   .0439249     1.39   0.165    -.0251016    .1470861
  fnew_expat |   .2399194   .0742825     3.23   0.001     .0943239    .3855149
             |
    ind_year |
          2  |   .1286405   .0134257     9.58   0.000     .1023259    .1549552
          3  |   .3184571   .0166648    19.11   0.000     .2857936    .3511205
          4  |   .5103233   .0189794    26.89   0.000     .4731232    .5475235
          5  |   .6784001   .0209851    32.33   0.000     .6372688    .7195314
          6  |   .8412912    .023192    36.28   0.000     .7958344    .8867481
          7  |   .9539087    .025948    36.76   0.000       .90305    1.004767
          8  |   1.045088   .0280838    37.21   0.000      .990043    1.100133
          9  |   1.165594   .0288383    40.42   0.000      1.10907    1.222117
         10  |   1.285453    .029908    42.98   0.000     1.226833    1.344074
         11  |   1.369947   .0309422    44.27   0.000       1.3093    1.430595
         12  |   1.380845   .0319855    43.17   0.000     1.318152    1.443537
         13  |   1.428179   .0327521    43.61   0.000     1.363984    1.492374
         14  |   1.481391    .033654    44.02   0.000     1.415429    1.547354
         15  |   1.562621   .0344148    45.41   0.000     1.495167    1.630074
         16  |   1.593939   .0349205    45.64   0.000     1.525494    1.662384
         17  |   1.672216   .0358219    46.68   0.000     1.602004    1.742428
         18  |   1.605491   .0365226    43.96   0.000     1.533906    1.677076
         19  |   1.642035   .0376001    43.67   0.000     1.568338    1.715732
         20  |   1.690526   .0382796    44.16   0.000     1.615497    1.765555
         21  |   1.742002   .0389123    44.77   0.000     1.665732    1.818271
         22  |   1.762477   .0404918    43.53   0.000     1.683112    1.841842
         23  |    1.80421   .0408828    44.13   0.000     1.724079    1.884341
         24  |   1.834525   .0428883    42.77   0.000     1.750463    1.918587
         25  |   1.836936   .0436647    42.07   0.000     1.751352     1.92252
         26  |  -.0583833   .0425973    -1.37   0.171     -.141875    .0251084
         27  |   .0650558   .0391999     1.66   0.097     -.011777    .1418885
         28  |   .2412542   .0377708     6.39   0.000     .1672225    .3152858
         29  |    .450339   .0376549    11.96   0.000     .3765344    .5241435
         30  |   .6133574   .0366722    16.73   0.000     .5414791    .6852358
         31  |   .7682705   .0368701    20.84   0.000     .6960041    .8405369
         32  |   .9107988   .0358015    25.44   0.000     .8406269    .9809706
         33  |   .9565643    .036068    26.52   0.000     .8858702    1.027258
         34  |   1.086402   .0361079    30.09   0.000      1.01563    1.157175
         35  |   1.188464   .0365891    32.48   0.000     1.116749     1.26018
         36  |   1.242174   .0369741    33.60   0.000     1.169704    1.314644
         37  |    1.29243   .0377706    34.22   0.000     1.218399    1.366461
         38  |   1.389349   .0383237    36.25   0.000     1.314234    1.464465
         39  |   1.418497   .0392332    36.16   0.000     1.341599    1.495395
         40  |   1.488512   .0399656    37.24   0.000     1.410178    1.566845
         41  |    1.58088   .0400922    39.43   0.000     1.502299    1.659462
         42  |   1.671956   .0407731    41.01   0.000      1.59204    1.751872
         43  |   1.635006   .0417845    39.13   0.000     1.553107    1.716904
         44  |    1.63702   .0426307    38.40   0.000     1.553463    1.720577
         45  |   1.703933     .04344    39.23   0.000      1.61879    1.789077
         46  |   1.722847   .0443142    38.88   0.000      1.63599    1.809704
         47  |    1.71644   .0453937    37.81   0.000     1.627468    1.805413
         48  |   1.760294    .046379    37.95   0.000      1.66939    1.851198
         49  |   1.772229   .0490021    36.17   0.000     1.676184    1.868274
         50  |   1.758442   .0493116    35.66   0.000      1.66179    1.855094
             |
     age_cat |
          2  |   .2894826   .0123979    23.35   0.000     .2651825    .3137828
          3  |   .2947387   .0136661    21.57   0.000     .2679527    .3215246
          4  |   .2848014   .0150895    18.87   0.000     .2552257    .3143772
          5  |   .2910118   .0185287    15.71   0.000     .2546951    .3273285
          6  |   .2922041   .0213841    13.66   0.000     .2502907    .3341174
             |
       _cons |   7.238826   .0266193   271.94   0.000     7.186652    7.291001
-------------+----------------------------------------------------------------
     sigma_u |   1.235681
     sigma_e |   .5012289
         rho |  .85871152   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =    188,472
Group variable: id                              Number of groups  =     39,342

R-sq:                                           Obs per group:
     within  = 0.0183                                         min =          1
     between = 0.1032                                         avg =        4.8
     overall = 0.0782                                         max =          9

                                                F(58,39341)       =      23.30
corr(u_i, Xb)  = 0.1773                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 39,342 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0254628   .0183172     1.39   0.165    -.0104393    .0613648
         new |  -.0047917   .0027426    -1.75   0.081    -.0101674    .0005839
        fnew |   .0027396   .0228703     0.12   0.905    -.0420868    .0475659
  fnew_expat |  -.0059732   .0347657    -0.17   0.864    -.0741147    .0621683
             |
    ind_year |
          2  |  -.0239699   .0069222    -3.46   0.001    -.0375376   -.0104022
          3  |  -.0359589   .0082285    -4.37   0.000    -.0520869   -.0198308
          4  |  -.0312247   .0089671    -3.48   0.000    -.0488004   -.0136489
          5  |  -.0242844   .0100539    -2.42   0.016    -.0439904   -.0045785
          6  |  -.0293351   .0109393    -2.68   0.007    -.0507765   -.0078937
          7  |  -.0243059   .0118875    -2.04   0.041    -.0476056   -.0010062
          8  |  -.0427066   .0125408    -3.41   0.001    -.0672869   -.0181264
          9  |  -.0461042   .0132607    -3.48   0.001    -.0720954   -.0201129
         10  |  -.0382375     .01359    -2.81   0.005    -.0648743   -.0116007
         11  |  -.0435626   .0141257    -3.08   0.002    -.0712492    -.015876
         12  |   -.049116   .0146085    -3.36   0.001     -.077749   -.0204829
         13  |  -.0387884   .0151032    -2.57   0.010    -.0683911   -.0091857
         14  |  -.0315071   .0155603    -2.02   0.043    -.0620056   -.0010086
         15  |  -.0204784   .0161337    -1.27   0.204    -.0521009     .011144
         16  |  -.0058589   .0164631    -0.36   0.722     -.038127    .0264093
         17  |   .0161822   .0168894     0.96   0.338    -.0169215    .0492859
         18  |   .0241219   .0173602     1.39   0.165    -.0099047    .0581484
         19  |   .0367628   .0177865     2.07   0.039     .0019009    .0716247
         20  |   .0407625   .0182526     2.23   0.026     .0049869    .0765381
         21  |   .0265529   .0185808     1.43   0.153    -.0098659    .0629716
         22  |   .0330188   .0192034     1.72   0.086    -.0046203    .0706579
         23  |   .0282969   .0196738     1.44   0.150    -.0102643    .0668581
         24  |  -.0538101   .0204049    -2.64   0.008    -.0938042    -.013816
         25  |  -.0785911   .0212143    -3.70   0.000    -.1201717   -.0370104
         26  |   .0220582   .0211055     1.05   0.296    -.0193091    .0634255
         27  |   .0099742   .0198064     0.50   0.615    -.0288468    .0487951
         28  |   .0215397   .0189056     1.14   0.255    -.0155158    .0585951
         29  |   .0207929    .018675     1.11   0.266    -.0158106    .0573964
         30  |   .0400097   .0182896     2.19   0.029     .0041617    .0758577
         31  |   .0520413   .0180092     2.89   0.004     .0167428    .0873397
         32  |   .0502234   .0179761     2.79   0.005     .0149898     .085457
         33  |   .0586005   .0179625     3.26   0.001     .0233935    .0938075
         34  |   .0620836   .0179705     3.45   0.001     .0268609    .0973062
         35  |   .0756811   .0180022     4.20   0.000     .0403963    .1109659
         36  |   .0738545    .018343     4.03   0.000     .0379018    .1098072
         37  |   .0784149   .0185275     4.23   0.000     .0421006    .1147292
         38  |   .0805561   .0187005     4.31   0.000     .0439026    .1172096
         39  |    .065792   .0192108     3.42   0.001     .0281383    .1034456
         40  |   .0780095   .0194284     4.02   0.000     .0399294    .1160896
         41  |   .0947804   .0195751     4.84   0.000     .0564128    .1331481
         42  |   .0852065   .0200204     4.26   0.000     .0459661     .124447
         43  |   .0976349   .0204011     4.79   0.000     .0576483    .1376215
         44  |     .11874   .0209284     5.67   0.000     .0777198    .1597603
         45  |   .1333403   .0215914     6.18   0.000     .0910206    .1756599
         46  |   .1358312   .0222188     6.11   0.000     .0922818    .1793806
         47  |   .1320939   .0228953     5.77   0.000     .0872186    .1769691
         48  |   .1207281   .0235628     5.12   0.000     .0745444    .1669118
         49  |   -.071912   .0250927    -2.87   0.004    -.1210944   -.0227296
         50  |  -.1046269   .0264741    -3.95   0.000    -.1565167   -.0527371
             |
     age_cat |
          2  |   .0353566   .0043645     8.10   0.000     .0268021    .0439111
          3  |   .0546502   .0048411    11.29   0.000     .0451615    .0641388
          4  |   .0773208   .0055036    14.05   0.000     .0665335     .088108
          5  |   .0847723   .0075711    11.20   0.000     .0699327    .0996119
          6  |   .0968626   .0094952    10.20   0.000     .0782517    .1154735
             |
       _cons |    .206481   .0119811    17.23   0.000     .1829978    .2299642
-------------+----------------------------------------------------------------
     sigma_u |  .37821891
     sigma_e |  .25654291
         rho |  .68489389   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0183020378675802

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    188,472
Group variable: id                              Number of groups  =     39,342

R-sq:                                           Obs per group:
     within  = 0.0183                                         min =          1
     between = 0.1032                                         avg =        4.8
     overall = 0.0782                                         max =          9

                                                F(58,39341)       =      23.30
corr(u_i, Xb)  = 0.1773                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 39,342 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0254628   .0183172     1.39   0.165    -.0104393    .0613648
         new |  -.0047917   .0027426    -1.75   0.081    -.0101674    .0005839
        fnew |   .0027396   .0228703     0.12   0.905    -.0420868    .0475659
  fnew_expat |  -.0059732   .0347657    -0.17   0.864    -.0741147    .0621683
             |
    ind_year |
          2  |  -.0239699   .0069222    -3.46   0.001    -.0375376   -.0104022
          3  |  -.0359589   .0082285    -4.37   0.000    -.0520869   -.0198308
          4  |  -.0312247   .0089671    -3.48   0.000    -.0488004   -.0136489
          5  |  -.0242844   .0100539    -2.42   0.016    -.0439904   -.0045785
          6  |  -.0293351   .0109393    -2.68   0.007    -.0507765   -.0078937
          7  |  -.0243059   .0118875    -2.04   0.041    -.0476056   -.0010062
          8  |  -.0427066   .0125408    -3.41   0.001    -.0672869   -.0181264
          9  |  -.0461042   .0132607    -3.48   0.001    -.0720954   -.0201129
         10  |  -.0382375     .01359    -2.81   0.005    -.0648743   -.0116007
         11  |  -.0435626   .0141257    -3.08   0.002    -.0712492    -.015876
         12  |   -.049116   .0146085    -3.36   0.001     -.077749   -.0204829
         13  |  -.0387884   .0151032    -2.57   0.010    -.0683911   -.0091857
         14  |  -.0315071   .0155603    -2.02   0.043    -.0620056   -.0010086
         15  |  -.0204784   .0161337    -1.27   0.204    -.0521009     .011144
         16  |  -.0058589   .0164631    -0.36   0.722     -.038127    .0264093
         17  |   .0161822   .0168894     0.96   0.338    -.0169215    .0492859
         18  |   .0241219   .0173602     1.39   0.165    -.0099047    .0581484
         19  |   .0367628   .0177865     2.07   0.039     .0019009    .0716247
         20  |   .0407625   .0182526     2.23   0.026     .0049869    .0765381
         21  |   .0265529   .0185808     1.43   0.153    -.0098659    .0629716
         22  |   .0330188   .0192034     1.72   0.086    -.0046203    .0706579
         23  |   .0282969   .0196738     1.44   0.150    -.0102643    .0668581
         24  |  -.0538101   .0204049    -2.64   0.008    -.0938042    -.013816
         25  |  -.0785911   .0212143    -3.70   0.000    -.1201717   -.0370104
         26  |   .0220582   .0211055     1.05   0.296    -.0193091    .0634255
         27  |   .0099742   .0198064     0.50   0.615    -.0288468    .0487951
         28  |   .0215397   .0189056     1.14   0.255    -.0155158    .0585951
         29  |   .0207929    .018675     1.11   0.266    -.0158106    .0573964
         30  |   .0400097   .0182896     2.19   0.029     .0041617    .0758577
         31  |   .0520413   .0180092     2.89   0.004     .0167428    .0873397
         32  |   .0502234   .0179761     2.79   0.005     .0149898     .085457
         33  |   .0586005   .0179625     3.26   0.001     .0233935    .0938075
         34  |   .0620836   .0179705     3.45   0.001     .0268609    .0973062
         35  |   .0756811   .0180022     4.20   0.000     .0403963    .1109659
         36  |   .0738545    .018343     4.03   0.000     .0379018    .1098072
         37  |   .0784149   .0185275     4.23   0.000     .0421006    .1147292
         38  |   .0805561   .0187005     4.31   0.000     .0439026    .1172096
         39  |    .065792   .0192108     3.42   0.001     .0281383    .1034456
         40  |   .0780095   .0194284     4.02   0.000     .0399294    .1160896
         41  |   .0947804   .0195751     4.84   0.000     .0564128    .1331481
         42  |   .0852065   .0200204     4.26   0.000     .0459661     .124447
         43  |   .0976349   .0204011     4.79   0.000     .0576483    .1376215
         44  |     .11874   .0209284     5.67   0.000     .0777198    .1597603
         45  |   .1333403   .0215914     6.18   0.000     .0910206    .1756599
         46  |   .1358312   .0222188     6.11   0.000     .0922818    .1793806
         47  |   .1320939   .0228953     5.77   0.000     .0872186    .1769691
         48  |   .1207281   .0235628     5.12   0.000     .0745444    .1669118
         49  |   -.071912   .0250927    -2.87   0.004    -.1210944   -.0227296
         50  |  -.1046269   .0264741    -3.95   0.000    -.1565167   -.0527371
             |
     age_cat |
          2  |   .0353566   .0043645     8.10   0.000     .0268021    .0439111
          3  |   .0546502   .0048411    11.29   0.000     .0451615    .0641388
          4  |   .0773208   .0055036    14.05   0.000     .0665335     .088108
          5  |   .0847723   .0075711    11.20   0.000     .0699327    .0996119
          6  |   .0968626   .0094952    10.20   0.000     .0782517    .1154735
             |
       _cons |    .206481   .0119811    17.23   0.000     .1829978    .2299642
-------------+----------------------------------------------------------------
     sigma_u |  .37821891
     sigma_e |  .25654291
         rho |  .68489389   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =    130,067
Group variable: id                              Number of groups  =     31,721

R-sq:                                           Obs per group:
     within  = 0.0258                                         min =          1
     between = 0.0015                                         avg =        4.1
     overall = 0.0062                                         max =          8

                                                F(55,31720)       =      51.03
corr(u_i, Xb)  = -0.3673                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 31,721 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0343007   .0615873    -0.56   0.578    -.1550141    .0864128
         new |   .0819261   .0105198     7.79   0.000      .061307    .1025453
        fnew |  -.1007771   .0580511    -1.74   0.083    -.2145596    .0130053
  fnew_expat |   .0670383   .0916912     0.73   0.465      -.11268    .2467566
             |
    ind_year |
          3  |   .0059861   .0302573     0.20   0.843    -.0533193    .0652915
          4  |  -.0236249   .0314992    -0.75   0.453    -.0853646    .0381148
          5  |  -.0935487   .0345988    -2.70   0.007    -.1613637   -.0257337
          6  |  -.0958857   .0381249    -2.52   0.012     -.170612   -.0211595
          7  |  -.0517957    .041486    -1.25   0.212    -.1331098    .0295185
          8  |  -.2444904   .0445244    -5.49   0.000      -.33176   -.1572209
          9  |  -.3410842   .0463817    -7.35   0.000     -.431994   -.2501743
         10  |  -.2527329   .0477861    -5.29   0.000    -.3463955   -.1590702
         11  |  -.1558404   .0489723    -3.18   0.001    -.2518279   -.0598529
         12  |  -.1486015   .0502786    -2.96   0.003    -.2471495   -.0500535
         13  |  -.3263874   .0516486    -6.32   0.000    -.4276206   -.2251541
         14  |    -.38088   .0535207    -7.12   0.000    -.4857826   -.2759774
         15  |  -.3380567   .0549527    -6.15   0.000    -.4457662   -.2303473
         16  |  -.5178182   .0561669    -9.22   0.000    -.6279075   -.4077289
         17  |  -.3301805   .0579257    -5.70   0.000    -.4437171   -.2166438
         18  |  -.3677203   .0594659    -6.18   0.000    -.4842758   -.2511649
         19  |   -.489874   .0610614    -8.02   0.000    -.6095566   -.3701913
         20  |  -.3904397   .0623782    -6.26   0.000    -.5127033    -.268176
         21  |  -.6041444   .0641537    -9.42   0.000    -.7298882   -.4784005
         22  |  -.6048608   .0664299    -9.11   0.000    -.7350659   -.4746557
         23  |  -.5689586   .0688128    -8.27   0.000    -.7038343   -.4340829
         24  |  -1.158089     .07207   -16.07   0.000    -1.299349   -1.016829
         25  |  -.7343596   .0800586    -9.17   0.000    -.8912776   -.5774416
         27  |  -.3646895    .071937    -5.07   0.000    -.5056887   -.2236902
         28  |  -.3960658   .0657292    -6.03   0.000    -.5248975   -.2672341
         29  |  -.3701569    .062842    -5.89   0.000    -.4933296   -.2469843
         30  |  -.3911848   .0614372    -6.37   0.000    -.5116042   -.2707654
         31  |  -.3454529   .0594471    -5.81   0.000    -.4619714   -.2289343
         32  |  -.3351473   .0590993    -5.67   0.000    -.4509842   -.2193105
         33  |  -.3776949   .0578068    -6.53   0.000    -.4909986   -.2643913
         34  |  -.6693447   .0581973   -11.50   0.000    -.7834136   -.5552758
         35  |  -.5372959   .0584558    -9.19   0.000    -.6518715   -.4227203
         36  |  -.5250708   .0589617    -8.91   0.000     -.640638   -.4095036
         37  |  -.5387769   .0601518    -8.96   0.000    -.6566768    -.420877
         38  |  -.3938149   .0611186    -6.44   0.000    -.5136097   -.2740201
         39  |  -.7377726   .0623705   -11.83   0.000    -.8600212    -.615524
         40  |  -.7876743   .0632143   -12.46   0.000    -.9115768   -.6637717
         41  |  -.7835562   .0641389   -12.22   0.000    -.9092709   -.6578415
         42  |  -.5625745   .0665696    -8.45   0.000    -.6930535   -.4320956
         43  |  -.5685123   .0677072    -8.40   0.000     -.701221   -.4358036
         44  |  -.8382777   .0700572   -11.97   0.000    -.9755926   -.7009629
         45  |  -.8611663   .0717613   -12.00   0.000    -1.001821   -.7205113
         46  |  -.7935561   .0734202   -10.81   0.000    -.9374625   -.6496497
         47  |  -.7377814   .0766093    -9.63   0.000    -.8879386   -.5876243
         48  |  -.9618455   .0784103   -12.27   0.000    -1.115533   -.8081582
         49  |  -1.576034   .0825175   -19.10   0.000    -1.737771   -1.414296
         50  |  -1.223308   .0986006   -12.41   0.000    -1.416569   -1.030047
             |
     age_cat |
          3  |  -.1713379   .0204471    -8.38   0.000    -.2114149   -.1312609
          4  |   -.316613   .0212208   -14.92   0.000    -.3582066   -.2750194
          5  |  -.3504265   .0263357   -13.31   0.000    -.4020456   -.2988075
          6  |  -.3513814   .0315116   -11.15   0.000    -.4131454   -.2896174
             |
       _cons |   .6130614   .0447872    13.69   0.000     .5252767     .700846
-------------+----------------------------------------------------------------
     sigma_u |  .61446256
     sigma_e |  .87359572
         rho |  .33098368   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0257655827705958

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    130,067
Group variable: id                              Number of groups  =     31,721

R-sq:                                           Obs per group:
     within  = 0.0258                                         min =          1
     between = 0.0015                                         avg =        4.1
     overall = 0.0062                                         max =          8

                                                F(55,31720)       =      51.03
corr(u_i, Xb)  = -0.3673                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 31,721 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0343007   .0615873    -0.56   0.578    -.1550141    .0864128
         new |   .0819261   .0105198     7.79   0.000      .061307    .1025453
        fnew |  -.1007771   .0580511    -1.74   0.083    -.2145596    .0130053
  fnew_expat |   .0670383   .0916912     0.73   0.465      -.11268    .2467566
             |
    ind_year |
          3  |   .0059861   .0302573     0.20   0.843    -.0533193    .0652915
          4  |  -.0236249   .0314992    -0.75   0.453    -.0853646    .0381148
          5  |  -.0935487   .0345988    -2.70   0.007    -.1613637   -.0257337
          6  |  -.0958857   .0381249    -2.52   0.012     -.170612   -.0211595
          7  |  -.0517957    .041486    -1.25   0.212    -.1331098    .0295185
          8  |  -.2444904   .0445244    -5.49   0.000      -.33176   -.1572209
          9  |  -.3410842   .0463817    -7.35   0.000     -.431994   -.2501743
         10  |  -.2527329   .0477861    -5.29   0.000    -.3463955   -.1590702
         11  |  -.1558404   .0489723    -3.18   0.001    -.2518279   -.0598529
         12  |  -.1486015   .0502786    -2.96   0.003    -.2471495   -.0500535
         13  |  -.3263874   .0516486    -6.32   0.000    -.4276206   -.2251541
         14  |    -.38088   .0535207    -7.12   0.000    -.4857826   -.2759774
         15  |  -.3380567   .0549527    -6.15   0.000    -.4457662   -.2303473
         16  |  -.5178182   .0561669    -9.22   0.000    -.6279075   -.4077289
         17  |  -.3301805   .0579257    -5.70   0.000    -.4437171   -.2166438
         18  |  -.3677203   .0594659    -6.18   0.000    -.4842758   -.2511649
         19  |   -.489874   .0610614    -8.02   0.000    -.6095566   -.3701913
         20  |  -.3904397   .0623782    -6.26   0.000    -.5127033    -.268176
         21  |  -.6041444   .0641537    -9.42   0.000    -.7298882   -.4784005
         22  |  -.6048608   .0664299    -9.11   0.000    -.7350659   -.4746557
         23  |  -.5689586   .0688128    -8.27   0.000    -.7038343   -.4340829
         24  |  -1.158089     .07207   -16.07   0.000    -1.299349   -1.016829
         25  |  -.7343596   .0800586    -9.17   0.000    -.8912776   -.5774416
         27  |  -.3646895    .071937    -5.07   0.000    -.5056887   -.2236902
         28  |  -.3960658   .0657292    -6.03   0.000    -.5248975   -.2672341
         29  |  -.3701569    .062842    -5.89   0.000    -.4933296   -.2469843
         30  |  -.3911848   .0614372    -6.37   0.000    -.5116042   -.2707654
         31  |  -.3454529   .0594471    -5.81   0.000    -.4619714   -.2289343
         32  |  -.3351473   .0590993    -5.67   0.000    -.4509842   -.2193105
         33  |  -.3776949   .0578068    -6.53   0.000    -.4909986   -.2643913
         34  |  -.6693447   .0581973   -11.50   0.000    -.7834136   -.5552758
         35  |  -.5372959   .0584558    -9.19   0.000    -.6518715   -.4227203
         36  |  -.5250708   .0589617    -8.91   0.000     -.640638   -.4095036
         37  |  -.5387769   .0601518    -8.96   0.000    -.6566768    -.420877
         38  |  -.3938149   .0611186    -6.44   0.000    -.5136097   -.2740201
         39  |  -.7377726   .0623705   -11.83   0.000    -.8600212    -.615524
         40  |  -.7876743   .0632143   -12.46   0.000    -.9115768   -.6637717
         41  |  -.7835562   .0641389   -12.22   0.000    -.9092709   -.6578415
         42  |  -.5625745   .0665696    -8.45   0.000    -.6930535   -.4320956
         43  |  -.5685123   .0677072    -8.40   0.000     -.701221   -.4358036
         44  |  -.8382777   .0700572   -11.97   0.000    -.9755926   -.7009629
         45  |  -.8611663   .0717613   -12.00   0.000    -1.001821   -.7205113
         46  |  -.7935561   .0734202   -10.81   0.000    -.9374625   -.6496497
         47  |  -.7377814   .0766093    -9.63   0.000    -.8879386   -.5876243
         48  |  -.9618455   .0784103   -12.27   0.000    -1.115533   -.8081582
         49  |  -1.576034   .0825175   -19.10   0.000    -1.737771   -1.414296
         50  |  -1.223308   .0986006   -12.41   0.000    -1.416569   -1.030047
             |
     age_cat |
          3  |  -.1713379   .0204471    -8.38   0.000    -.2114149   -.1312609
          4  |   -.316613   .0212208   -14.92   0.000    -.3582066   -.2750194
          5  |  -.3504265   .0263357   -13.31   0.000    -.4020456   -.2988075
          6  |  -.3513814   .0315116   -11.15   0.000    -.4131454   -.2896174
             |
       _cons |   .6130614   .0447872    13.69   0.000     .5252767     .700846
-------------+----------------------------------------------------------------
     sigma_u |  .61446256
     sigma_e |  .87359572
         rho |  .33098368   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =     48,839
Group variable: id                              Number of groups  =     10,806

R-sq:                                           Obs per group:
     within  = 0.0777                                         min =          1
     between = 0.0189                                         avg =        4.5
     overall = 0.0291                                         max =          9

                                                F(33,10805)       =      36.98
corr(u_i, Xb)  = -0.0537                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,806 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0775208   .0553612    -1.40   0.161     -.186039    .0309973
         new |  -.0489318   .0112689    -4.34   0.000     -.071021   -.0268426
        fnew |  -.0613316    .064157    -0.96   0.339    -.1870912     .064428
  fnew_expat |   .1538133   .1154886     1.33   0.183    -.0725655    .3801921
             |
    ind_year |
         27  |  -.0598245    .017491    -3.42   0.001    -.0941101   -.0255389
         28  |  -.1261694     .02367    -5.33   0.000     -.172567   -.0797719
         29  |   -.180746    .028982    -6.24   0.000     -.237556   -.1239361
         30  |  -.2117847   .0336078    -6.30   0.000    -.2776622   -.1459073
         31  |  -.2202385   .0375219    -5.87   0.000    -.2937883   -.1466888
         32  |  -.2350636   .0422031    -5.57   0.000    -.3177895   -.1523378
         33  |  -.2499743    .045468    -5.50   0.000       -.3391   -.1608486
         34  |  -.2469352   .0480833    -5.14   0.000    -.3411873   -.1526832
         35  |  -.2857638   .0506429    -5.64   0.000    -.3850333   -.1864943
         36  |  -.3215676   .0528094    -6.09   0.000    -.4250837   -.2180514
         37  |  -.3487117   .0542827    -6.42   0.000    -.4551157   -.2423077
         38  |  -.4024614   .0564309    -7.13   0.000    -.5130763   -.2918465
         39  |  -.4349733   .0588167    -7.40   0.000    -.5502649   -.3196817
         40  |   -.426174   .0608999    -7.00   0.000     -.545549   -.3067991
         41  |   -.455315   .0625112    -7.28   0.000    -.5778484   -.3327816
         42  |  -.5019838   .0639549    -7.85   0.000    -.6273471   -.3766205
         43  |  -.6168252   .0652274    -9.46   0.000    -.7446829   -.4889674
         44  |  -.6465584   .0662502    -9.76   0.000     -.776421   -.5166959
         45  |  -.6323269   .0671647    -9.41   0.000    -.7639821   -.5006717
         46  |  -.6458117   .0693955    -9.31   0.000    -.7818396   -.5097839
         47  |  -.6650309   .0713657    -9.32   0.000    -.8049207   -.5251411
         48  |  -.6590859   .0738616    -8.92   0.000    -.8038682   -.5143037
         49  |  -.6498858   .0762352    -8.52   0.000    -.7993207   -.5004508
         50  |  -.6186446    .077532    -7.98   0.000    -.7706216   -.4666676
             |
     age_cat |
          2  |   .3465737   .0207236    16.72   0.000     .3059516    .3871958
          3  |   .5815516   .0242042    24.03   0.000      .534107    .6289962
          4  |   .7744318   .0283395    27.33   0.000     .7188811    .8299825
          5  |   .8893616   .0367799    24.18   0.000     .8172662     .961457
          6  |   .9523681   .0432629    22.01   0.000     .8675648    1.037171
             |
       _cons |   3.577016   .0384956    92.92   0.000     3.501558    3.652474
-------------+----------------------------------------------------------------
     sigma_u |  1.0544764
     sigma_e |  .46615533
         rho |  .83652021   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0777327660863784

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =     48,839
Group variable: id                              Number of groups  =     10,806

R-sq:                                           Obs per group:
     within  = 0.0777                                         min =          1
     between = 0.0189                                         avg =        4.5
     overall = 0.0291                                         max =          9

                                                F(33,10805)       =      36.98
corr(u_i, Xb)  = -0.0537                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,806 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0775208   .0553612    -1.40   0.161     -.186039    .0309973
         new |  -.0489318   .0112689    -4.34   0.000     -.071021   -.0268426
        fnew |  -.0613316    .064157    -0.96   0.339    -.1870912     .064428
  fnew_expat |   .1538133   .1154886     1.33   0.183    -.0725655    .3801921
             |
    ind_year |
         27  |  -.0598245    .017491    -3.42   0.001    -.0941101   -.0255389
         28  |  -.1261694     .02367    -5.33   0.000     -.172567   -.0797719
         29  |   -.180746    .028982    -6.24   0.000     -.237556   -.1239361
         30  |  -.2117847   .0336078    -6.30   0.000    -.2776622   -.1459073
         31  |  -.2202385   .0375219    -5.87   0.000    -.2937883   -.1466888
         32  |  -.2350636   .0422031    -5.57   0.000    -.3177895   -.1523378
         33  |  -.2499743    .045468    -5.50   0.000       -.3391   -.1608486
         34  |  -.2469352   .0480833    -5.14   0.000    -.3411873   -.1526832
         35  |  -.2857638   .0506429    -5.64   0.000    -.3850333   -.1864943
         36  |  -.3215676   .0528094    -6.09   0.000    -.4250837   -.2180514
         37  |  -.3487117   .0542827    -6.42   0.000    -.4551157   -.2423077
         38  |  -.4024614   .0564309    -7.13   0.000    -.5130763   -.2918465
         39  |  -.4349733   .0588167    -7.40   0.000    -.5502649   -.3196817
         40  |   -.426174   .0608999    -7.00   0.000     -.545549   -.3067991
         41  |   -.455315   .0625112    -7.28   0.000    -.5778484   -.3327816
         42  |  -.5019838   .0639549    -7.85   0.000    -.6273471   -.3766205
         43  |  -.6168252   .0652274    -9.46   0.000    -.7446829   -.4889674
         44  |  -.6465584   .0662502    -9.76   0.000     -.776421   -.5166959
         45  |  -.6323269   .0671647    -9.41   0.000    -.7639821   -.5006717
         46  |  -.6458117   .0693955    -9.31   0.000    -.7818396   -.5097839
         47  |  -.6650309   .0713657    -9.32   0.000    -.8049207   -.5251411
         48  |  -.6590859   .0738616    -8.92   0.000    -.8038682   -.5143037
         49  |  -.6498858   .0762352    -8.52   0.000    -.7993207   -.5004508
         50  |  -.6186446    .077532    -7.98   0.000    -.7706216   -.4666676
             |
     age_cat |
          2  |   .3465737   .0207236    16.72   0.000     .3059516    .3871958
          3  |   .5815516   .0242042    24.03   0.000      .534107    .6289962
          4  |   .7744318   .0283395    27.33   0.000     .7188811    .8299825
          5  |   .8893616   .0367799    24.18   0.000     .8172662     .961457
          6  |   .9523681   .0432629    22.01   0.000     .8675648    1.037171
             |
       _cons |   3.577016   .0384956    92.92   0.000     3.501558    3.652474
-------------+----------------------------------------------------------------
     sigma_u |  1.0544764
     sigma_e |  .46615533
         rho |  .83652021   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =     44,316
Group variable: id                              Number of groups  =     10,050

R-sq:                                           Obs per group:
     within  = 0.1182                                         min =          1
     between = 0.0971                                         avg =        4.4
     overall = 0.1150                                         max =          9

                                                F(33,10049)       =      50.39
corr(u_i, Xb)  = 0.1128                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,050 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0016104   .1512055    -0.01   0.992    -.2980035    .2947827
         new |  -.0221901   .0188714    -1.18   0.240    -.0591819    .0148016
        fnew |  -.1652919   .1198366    -1.38   0.168    -.4001956    .0696117
  fnew_expat |   .1023618   .2052789     0.50   0.618    -.3000259    .5047496
             |
    ind_year |
         27  |   .0492022   .0390493     1.26   0.208    -.0273423    .1257466
         28  |   .2179168   .0466203     4.67   0.000     .1265317    .3093019
         29  |   .2910247   .0526724     5.53   0.000     .1877762    .3942731
         30  |   .2717926   .0588073     4.62   0.000     .1565184    .3870667
         31  |   .4275218   .0637879     6.70   0.000     .3024848    .5525589
         32  |   .6104211   .0707688     8.63   0.000     .4717001    .7491421
         33  |   .6885837   .0769864     8.94   0.000     .5376749    .8394925
         34  |   .7629463   .0826516     9.23   0.000     .6009326      .92496
         35  |   .8155058   .0862247     9.46   0.000     .6464882    .9845235
         36  |   .9028883   .0895148    10.09   0.000     .7274215    1.078355
         37  |   .9514892   .0923348    10.30   0.000     .7704944    1.132484
         38  |   .9512108   .0957273     9.94   0.000     .7635661    1.138856
         39  |   .9444499    .098694     9.57   0.000       .75099     1.13791
         40  |   .9463654   .1014753     9.33   0.000     .7474535    1.145277
         41  |   .9330969   .1033858     9.03   0.000       .73044    1.135754
         42  |   .9644962   .1074703     8.97   0.000     .7538329    1.175159
         43  |   .9117259   .1100236     8.29   0.000     .6960576    1.127394
         44  |   .8696962   .1114893     7.80   0.000     .6511548    1.088238
         45  |   .9257504   .1133104     8.17   0.000     .7036393    1.147861
         46  |   .8708443   .1155979     7.53   0.000     .6442493    1.097439
         47  |   .8999289   .1187603     7.58   0.000      .667135    1.132723
         48  |   .9924493   .1220678     8.13   0.000     .7531721    1.231727
         49  |   .7243712   .1333051     5.43   0.000     .4630665    .9856758
         50  |   .9403323   .1402647     6.70   0.000     .6653854    1.215279
             |
     age_cat |
          2  |   .5584013    .045324    12.32   0.000     .4695573    .6472454
          3  |   .8795335   .0508149    17.31   0.000     .7799261     .979141
          4  |   1.153108   .0566075    20.37   0.000     1.042146     1.26407
          5  |   1.292079   .0693425    18.63   0.000     1.156154    1.428004
          6  |    1.39376    .078646    17.72   0.000     1.239598    1.547922
             |
       _cons |   8.006566   .0695196   115.17   0.000     7.870294    8.142838
-------------+----------------------------------------------------------------
     sigma_u |  1.9485994
     sigma_e |  .76128294
         rho |   .8675792   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1182013791838773

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =     44,316
Group variable: id                              Number of groups  =     10,050

R-sq:                                           Obs per group:
     within  = 0.1182                                         min =          1
     between = 0.0971                                         avg =        4.4
     overall = 0.1150                                         max =          9

                                                F(33,10049)       =      50.39
corr(u_i, Xb)  = 0.1128                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,050 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0016104   .1512055    -0.01   0.992    -.2980035    .2947827
         new |  -.0221901   .0188714    -1.18   0.240    -.0591819    .0148016
        fnew |  -.1652919   .1198366    -1.38   0.168    -.4001956    .0696117
  fnew_expat |   .1023618   .2052789     0.50   0.618    -.3000259    .5047496
             |
    ind_year |
         27  |   .0492022   .0390493     1.26   0.208    -.0273423    .1257466
         28  |   .2179168   .0466203     4.67   0.000     .1265317    .3093019
         29  |   .2910247   .0526724     5.53   0.000     .1877762    .3942731
         30  |   .2717926   .0588073     4.62   0.000     .1565184    .3870667
         31  |   .4275218   .0637879     6.70   0.000     .3024848    .5525589
         32  |   .6104211   .0707688     8.63   0.000     .4717001    .7491421
         33  |   .6885837   .0769864     8.94   0.000     .5376749    .8394925
         34  |   .7629463   .0826516     9.23   0.000     .6009326      .92496
         35  |   .8155058   .0862247     9.46   0.000     .6464882    .9845235
         36  |   .9028883   .0895148    10.09   0.000     .7274215    1.078355
         37  |   .9514892   .0923348    10.30   0.000     .7704944    1.132484
         38  |   .9512108   .0957273     9.94   0.000     .7635661    1.138856
         39  |   .9444499    .098694     9.57   0.000       .75099     1.13791
         40  |   .9463654   .1014753     9.33   0.000     .7474535    1.145277
         41  |   .9330969   .1033858     9.03   0.000       .73044    1.135754
         42  |   .9644962   .1074703     8.97   0.000     .7538329    1.175159
         43  |   .9117259   .1100236     8.29   0.000     .6960576    1.127394
         44  |   .8696962   .1114893     7.80   0.000     .6511548    1.088238
         45  |   .9257504   .1133104     8.17   0.000     .7036393    1.147861
         46  |   .8708443   .1155979     7.53   0.000     .6442493    1.097439
         47  |   .8999289   .1187603     7.58   0.000      .667135    1.132723
         48  |   .9924493   .1220678     8.13   0.000     .7531721    1.231727
         49  |   .7243712   .1333051     5.43   0.000     .4630665    .9856758
         50  |   .9403323   .1402647     6.70   0.000     .6653854    1.215279
             |
     age_cat |
          2  |   .5584013    .045324    12.32   0.000     .4695573    .6472454
          3  |   .8795335   .0508149    17.31   0.000     .7799261     .979141
          4  |   1.153108   .0566075    20.37   0.000     1.042146     1.26407
          5  |   1.292079   .0693425    18.63   0.000     1.156154    1.428004
          6  |    1.39376    .078646    17.72   0.000     1.239598    1.547922
             |
       _cons |   8.006566   .0695196   115.17   0.000     7.870294    8.142838
-------------+----------------------------------------------------------------
     sigma_u |  1.9485994
     sigma_e |  .76128294
         rho |   .8675792   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =     48,839
Group variable: id                              Number of groups  =     10,806

R-sq:                                           Obs per group:
     within  = 0.1862                                         min =          1
     between = 0.1518                                         avg =        4.5
     overall = 0.1658                                         max =          9

                                                F(33,10805)       =      99.15
corr(u_i, Xb)  = 0.1346                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,806 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0405779   .0773642    -0.52   0.600     -.192226    .1110701
         new |  -.0220927   .0133534    -1.65   0.098    -.0482679    .0040825
        fnew |  -.0528387   .0772705    -0.68   0.494    -.2043031    .0986257
  fnew_expat |   .3933012   .1412922     2.78   0.005     .1163425    .6702598
             |
    ind_year |
         27  |   .0733905   .0240669     3.05   0.002      .026215    .1205659
         28  |    .185229   .0307595     6.02   0.000     .1249346    .2455233
         29  |   .3440144   .0370684     9.28   0.000     .2713535    .4166753
         30  |   .4674071   .0412365    11.33   0.000     .3865759    .5482383
         31  |   .6036434   .0457882    13.18   0.000     .5138901    .6933968
         32  |   .7268894   .0493077    14.74   0.000     .6302372    .8235416
         33  |   .7446987   .0540051    13.79   0.000     .6388387    .8505586
         34  |   .8786163   .0568094    15.47   0.000     .7672593    .9899732
         35  |   .9460427   .0597132    15.84   0.000     .8289939    1.063092
         36  |   .9453711   .0619755    15.25   0.000     .8238877    1.066855
         37  |   .9470801   .0640717    14.78   0.000     .8214878    1.072672
         38  |   .9895029   .0655085    15.10   0.000     .8610942    1.117912
         39  |   .9688837   .0681429    14.22   0.000     .8353111    1.102456
         40  |   1.051691   .0698118    15.06   0.000     .9148473    1.188535
         41  |   1.100438   .0722409    15.23   0.000     .9588321    1.242043
         42  |   1.135678   .0733457    15.48   0.000     .9919066    1.279449
         43  |   .9657649    .075287    12.83   0.000     .8181885    1.113341
         44  |   .9357908   .0768116    12.18   0.000     .7852259    1.086356
         45  |   1.007722   .0783121    12.87   0.000     .8542158    1.161228
         46  |   1.013449   .0816187    12.42   0.000     .8534609    1.173436
         47  |   .9859729   .0841037    11.72   0.000     .8211142    1.150832
         48  |    1.05042   .0867385    12.11   0.000     .8803961    1.220443
         49  |   1.082838   .0897636    12.06   0.000     .9068852    1.258791
         50  |   1.111667   .0896718    12.40   0.000     .9358939     1.28744
             |
     age_cat |
          2  |   .6348987   .0263761    24.07   0.000     .5831967    .6866007
          3  |   .8796457   .0295804    29.74   0.000     .8216626    .9376288
          4  |   1.068239   .0345235    30.94   0.000     1.000567    1.135911
          5  |   1.200423   .0438101    27.40   0.000     1.114548    1.286299
          6  |   1.284894   .0508572    25.26   0.000     1.185204    1.384583
             |
       _cons |   10.62213   .0471771   225.15   0.000     10.52965     10.7146
-------------+----------------------------------------------------------------
     sigma_u |  1.4775015
     sigma_e |  .55241135
         rho |  .87735628   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1862091667758951

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =     48,839
Group variable: id                              Number of groups  =     10,806

R-sq:                                           Obs per group:
     within  = 0.1862                                         min =          1
     between = 0.1518                                         avg =        4.5
     overall = 0.1658                                         max =          9

                                                F(33,10805)       =      99.15
corr(u_i, Xb)  = 0.1346                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,806 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0405779   .0773642    -0.52   0.600     -.192226    .1110701
         new |  -.0220927   .0133534    -1.65   0.098    -.0482679    .0040825
        fnew |  -.0528387   .0772705    -0.68   0.494    -.2043031    .0986257
  fnew_expat |   .3933012   .1412922     2.78   0.005     .1163425    .6702598
             |
    ind_year |
         27  |   .0733905   .0240669     3.05   0.002      .026215    .1205659
         28  |    .185229   .0307595     6.02   0.000     .1249346    .2455233
         29  |   .3440144   .0370684     9.28   0.000     .2713535    .4166753
         30  |   .4674071   .0412365    11.33   0.000     .3865759    .5482383
         31  |   .6036434   .0457882    13.18   0.000     .5138901    .6933968
         32  |   .7268894   .0493077    14.74   0.000     .6302372    .8235416
         33  |   .7446987   .0540051    13.79   0.000     .6388387    .8505586
         34  |   .8786163   .0568094    15.47   0.000     .7672593    .9899732
         35  |   .9460427   .0597132    15.84   0.000     .8289939    1.063092
         36  |   .9453711   .0619755    15.25   0.000     .8238877    1.066855
         37  |   .9470801   .0640717    14.78   0.000     .8214878    1.072672
         38  |   .9895029   .0655085    15.10   0.000     .8610942    1.117912
         39  |   .9688837   .0681429    14.22   0.000     .8353111    1.102456
         40  |   1.051691   .0698118    15.06   0.000     .9148473    1.188535
         41  |   1.100438   .0722409    15.23   0.000     .9588321    1.242043
         42  |   1.135678   .0733457    15.48   0.000     .9919066    1.279449
         43  |   .9657649    .075287    12.83   0.000     .8181885    1.113341
         44  |   .9357908   .0768116    12.18   0.000     .7852259    1.086356
         45  |   1.007722   .0783121    12.87   0.000     .8542158    1.161228
         46  |   1.013449   .0816187    12.42   0.000     .8534609    1.173436
         47  |   .9859729   .0841037    11.72   0.000     .8211142    1.150832
         48  |    1.05042   .0867385    12.11   0.000     .8803961    1.220443
         49  |   1.082838   .0897636    12.06   0.000     .9068852    1.258791
         50  |   1.111667   .0896718    12.40   0.000     .9358939     1.28744
             |
     age_cat |
          2  |   .6348987   .0263761    24.07   0.000     .5831967    .6866007
          3  |   .8796457   .0295804    29.74   0.000     .8216626    .9376288
          4  |   1.068239   .0345235    30.94   0.000     1.000567    1.135911
          5  |   1.200423   .0438101    27.40   0.000     1.114548    1.286299
          6  |   1.284894   .0508572    25.26   0.000     1.185204    1.384583
             |
       _cons |   10.62213   .0471771   225.15   0.000     10.52965     10.7146
-------------+----------------------------------------------------------------
     sigma_u |  1.4775015
     sigma_e |  .55241135
         rho |  .87735628   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =     44,316
Group variable: id                              Number of groups  =     10,050

R-sq:                                           Obs per group:
     within  = 0.0773                                         min =          1
     between = 0.1043                                         avg =        4.4
     overall = 0.1189                                         max =          9

                                                F(33,10049)       =      36.28
corr(u_i, Xb)  = 0.0736                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,050 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0485273   .1376965     0.35   0.725    -.2213853    .3184399
         new |   .0340642   .0175215     1.94   0.052    -.0002814    .0684097
        fnew |  -.1204968   .1101143    -1.09   0.274    -.3363429    .0953492
  fnew_expat |   -.105593   .1756106    -0.60   0.548    -.4498249     .238639
             |
    ind_year |
         27  |   .1229157   .0367796     3.34   0.001     .0508203    .1950111
         28  |    .364089   .0420234     8.66   0.000     .2817147    .4464634
         29  |   .4968329    .047544    10.45   0.000     .4036372    .5900286
         30  |   .5127563   .0523453     9.80   0.000     .4101491    .6153635
         31  |   .6675992   .0573732    11.64   0.000     .5551363    .7800621
         32  |   .8805542   .0637683    13.81   0.000     .7555557    1.005553
         33  |   .9737391   .0687176    14.17   0.000     .8390389    1.108439
         34  |    1.04729   .0736516    14.22   0.000     .9029178    1.191662
         35  |   1.141355   .0774741    14.73   0.000     .9894904     1.29322
         36  |   1.269847   .0809784    15.68   0.000     1.111113     1.42858
         37  |   1.355634   .0835299    16.23   0.000     1.191899     1.51937
         38  |   1.392427   .0871119    15.98   0.000      1.22167    1.563183
         39  |   1.416913   .0897269    15.79   0.000      1.24103    1.592795
         40  |   1.397459   .0917278    15.23   0.000     1.217654    1.577264
         41  |   1.419763   .0932333    15.23   0.000     1.237007    1.602518
         42  |   1.503108   .0959972    15.66   0.000     1.314935    1.691282
         43  |   1.550823   .0991195    15.65   0.000     1.356529    1.745117
         44  |   1.541768   .1003133    15.37   0.000     1.345134    1.738403
         45  |   1.579593   .1020959    15.47   0.000     1.379465    1.779722
         46  |   1.533903   .1044148    14.69   0.000     1.329229    1.738577
         47  |   1.588297   .1067814    14.87   0.000     1.378984     1.79761
         48  |   1.673571   .1104062    15.16   0.000     1.457153    1.889989
         49  |   1.327107    .120556    11.01   0.000     1.090793    1.563421
         50  |   1.531657   .1271258    12.05   0.000     1.282465    1.780849
             |
     age_cat |
          2  |   .2330172   .0450299     5.17   0.000     .1447495    .3212848
          3  |   .3188654   .0502185     6.35   0.000     .2204271    .4173038
          4  |   .4043006   .0553001     7.31   0.000     .2959014    .5126999
          5  |   .4259672   .0669692     6.36   0.000     .2946941    .5572402
          6  |   .4722089   .0747965     6.31   0.000     .3255927     .618825
             |
       _cons |   4.327336   .0635388    68.11   0.000     4.202788    4.451885
-------------+----------------------------------------------------------------
     sigma_u |  1.6691348
     sigma_e |  .72208354
         rho |  .84235286   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0773175619523631

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =     44,316
Group variable: id                              Number of groups  =     10,050

R-sq:                                           Obs per group:
     within  = 0.0773                                         min =          1
     between = 0.1043                                         avg =        4.4
     overall = 0.1189                                         max =          9

                                                F(33,10049)       =      36.28
corr(u_i, Xb)  = 0.0736                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,050 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0485273   .1376965     0.35   0.725    -.2213853    .3184399
         new |   .0340642   .0175215     1.94   0.052    -.0002814    .0684097
        fnew |  -.1204968   .1101143    -1.09   0.274    -.3363429    .0953492
  fnew_expat |   -.105593   .1756106    -0.60   0.548    -.4498249     .238639
             |
    ind_year |
         27  |   .1229157   .0367796     3.34   0.001     .0508203    .1950111
         28  |    .364089   .0420234     8.66   0.000     .2817147    .4464634
         29  |   .4968329    .047544    10.45   0.000     .4036372    .5900286
         30  |   .5127563   .0523453     9.80   0.000     .4101491    .6153635
         31  |   .6675992   .0573732    11.64   0.000     .5551363    .7800621
         32  |   .8805542   .0637683    13.81   0.000     .7555557    1.005553
         33  |   .9737391   .0687176    14.17   0.000     .8390389    1.108439
         34  |    1.04729   .0736516    14.22   0.000     .9029178    1.191662
         35  |   1.141355   .0774741    14.73   0.000     .9894904     1.29322
         36  |   1.269847   .0809784    15.68   0.000     1.111113     1.42858
         37  |   1.355634   .0835299    16.23   0.000     1.191899     1.51937
         38  |   1.392427   .0871119    15.98   0.000      1.22167    1.563183
         39  |   1.416913   .0897269    15.79   0.000      1.24103    1.592795
         40  |   1.397459   .0917278    15.23   0.000     1.217654    1.577264
         41  |   1.419763   .0932333    15.23   0.000     1.237007    1.602518
         42  |   1.503108   .0959972    15.66   0.000     1.314935    1.691282
         43  |   1.550823   .0991195    15.65   0.000     1.356529    1.745117
         44  |   1.541768   .1003133    15.37   0.000     1.345134    1.738403
         45  |   1.579593   .1020959    15.47   0.000     1.379465    1.779722
         46  |   1.533903   .1044148    14.69   0.000     1.329229    1.738577
         47  |   1.588297   .1067814    14.87   0.000     1.378984     1.79761
         48  |   1.673571   .1104062    15.16   0.000     1.457153    1.889989
         49  |   1.327107    .120556    11.01   0.000     1.090793    1.563421
         50  |   1.531657   .1271258    12.05   0.000     1.282465    1.780849
             |
     age_cat |
          2  |   .2330172   .0450299     5.17   0.000     .1447495    .3212848
          3  |   .3188654   .0502185     6.35   0.000     .2204271    .4173038
          4  |   .4043006   .0553001     7.31   0.000     .2959014    .5126999
          5  |   .4259672   .0669692     6.36   0.000     .2946941    .5572402
          6  |   .4722089   .0747965     6.31   0.000     .3255927     .618825
             |
       _cons |   4.327336   .0635388    68.11   0.000     4.202788    4.451885
-------------+----------------------------------------------------------------
     sigma_u |  1.6691348
     sigma_e |  .72208354
         rho |  .84235286   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =     48,839
Group variable: id                              Number of groups  =     10,806

R-sq:                                           Obs per group:
     within  = 0.1625                                         min =          1
     between = 0.2118                                         avg =        4.5
     overall = 0.2210                                         max =          9

                                                F(33,10805)       =     109.53
corr(u_i, Xb)  = 0.0834                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,806 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0369429   .0582713     0.63   0.526    -.0772796    .1511654
         new |   .0268391   .0104511     2.57   0.010      .006353    .0473252
        fnew |   .0084929   .0502351     0.17   0.866    -.0899771    .1069629
  fnew_expat |   .2394879   .0839641     2.85   0.004     .0749028     .404073
             |
    ind_year |
         27  |    .133215    .017361     7.67   0.000     .0991842    .1672458
         28  |   .3113984   .0211618    14.72   0.000     .2699175    .3528793
         29  |   .5247604   .0253234    20.72   0.000     .4751219    .5743989
         30  |   .6791918   .0274268    24.76   0.000     .6254303    .7329534
         31  |   .8238819   .0302897    27.20   0.000     .7645085    .8832553
         32  |    .961953   .0322805    29.80   0.000     .8986773    1.025229
         33  |    .994673     .03498    28.44   0.000     .9261058     1.06324
         34  |   1.125551   .0368452    30.55   0.000     1.053328    1.197775
         35  |   1.231807    .039335    31.32   0.000     1.154703     1.30891
         36  |   1.266939   .0409359    30.95   0.000     1.186697     1.34718
         37  |   1.295792   .0427905    30.28   0.000     1.211914    1.379669
         38  |   1.391964   .0442052    31.49   0.000     1.305314    1.478615
         39  |   1.403857   .0458951    30.59   0.000     1.313894     1.49382
         40  |   1.477865   .0472295    31.29   0.000     1.385287    1.570444
         41  |   1.555753   .0479939    32.42   0.000     1.461676    1.649829
         42  |   1.637661   .0491726    33.30   0.000     1.541274    1.734049
         43  |    1.58259   .0505941    31.28   0.000     1.483416    1.681764
         44  |   1.582349   .0519774    30.44   0.000     1.480464    1.684235
         45  |   1.640049   .0530591    30.91   0.000     1.536043    1.744054
         46  |    1.65926   .0558239    29.72   0.000     1.549835    1.768685
         47  |   1.651004   .0579066    28.51   0.000     1.537496    1.764511
         48  |   1.709505    .059174    28.89   0.000     1.593514    1.825497
         49  |   1.732724   .0616737    28.10   0.000     1.611832    1.853616
         50  |   1.730312   .0620073    27.90   0.000     1.608766    1.851857
             |
     age_cat |
          2  |    .288325   .0212653    13.56   0.000     .2466411    .3300089
          3  |   .2980941   .0235196    12.67   0.000     .2519914    .3441967
          4  |   .2938072    .026223    11.20   0.000     .2424052    .3452092
          5  |   .3110619   .0318006     9.78   0.000      .248727    .3733968
          6  |   .3325255   .0363018     9.16   0.000     .2613672    .4036837
             |
       _cons |   7.045111   .0322386   218.53   0.000     6.981917    7.108305
-------------+----------------------------------------------------------------
     sigma_u |  1.0852216
     sigma_e |  .42706097
         rho |  .86590485   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1625200900691842

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =     48,839
Group variable: id                              Number of groups  =     10,806

R-sq:                                           Obs per group:
     within  = 0.1625                                         min =          1
     between = 0.2118                                         avg =        4.5
     overall = 0.2210                                         max =          9

                                                F(33,10805)       =     109.53
corr(u_i, Xb)  = 0.0834                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,806 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0369429   .0582713     0.63   0.526    -.0772796    .1511654
         new |   .0268391   .0104511     2.57   0.010      .006353    .0473252
        fnew |   .0084929   .0502351     0.17   0.866    -.0899771    .1069629
  fnew_expat |   .2394879   .0839641     2.85   0.004     .0749028     .404073
             |
    ind_year |
         27  |    .133215    .017361     7.67   0.000     .0991842    .1672458
         28  |   .3113984   .0211618    14.72   0.000     .2699175    .3528793
         29  |   .5247604   .0253234    20.72   0.000     .4751219    .5743989
         30  |   .6791918   .0274268    24.76   0.000     .6254303    .7329534
         31  |   .8238819   .0302897    27.20   0.000     .7645085    .8832553
         32  |    .961953   .0322805    29.80   0.000     .8986773    1.025229
         33  |    .994673     .03498    28.44   0.000     .9261058     1.06324
         34  |   1.125551   .0368452    30.55   0.000     1.053328    1.197775
         35  |   1.231807    .039335    31.32   0.000     1.154703     1.30891
         36  |   1.266939   .0409359    30.95   0.000     1.186697     1.34718
         37  |   1.295792   .0427905    30.28   0.000     1.211914    1.379669
         38  |   1.391964   .0442052    31.49   0.000     1.305314    1.478615
         39  |   1.403857   .0458951    30.59   0.000     1.313894     1.49382
         40  |   1.477865   .0472295    31.29   0.000     1.385287    1.570444
         41  |   1.555753   .0479939    32.42   0.000     1.461676    1.649829
         42  |   1.637661   .0491726    33.30   0.000     1.541274    1.734049
         43  |    1.58259   .0505941    31.28   0.000     1.483416    1.681764
         44  |   1.582349   .0519774    30.44   0.000     1.480464    1.684235
         45  |   1.640049   .0530591    30.91   0.000     1.536043    1.744054
         46  |    1.65926   .0558239    29.72   0.000     1.549835    1.768685
         47  |   1.651004   .0579066    28.51   0.000     1.537496    1.764511
         48  |   1.709505    .059174    28.89   0.000     1.593514    1.825497
         49  |   1.732724   .0616737    28.10   0.000     1.611832    1.853616
         50  |   1.730312   .0620073    27.90   0.000     1.608766    1.851857
             |
     age_cat |
          2  |    .288325   .0212653    13.56   0.000     .2466411    .3300089
          3  |   .2980941   .0235196    12.67   0.000     .2519914    .3441967
          4  |   .2938072    .026223    11.20   0.000     .2424052    .3452092
          5  |   .3110619   .0318006     9.78   0.000      .248727    .3733968
          6  |   .3325255   .0363018     9.16   0.000     .2613672    .4036837
             |
       _cons |   7.045111   .0322386   218.53   0.000     6.981917    7.108305
-------------+----------------------------------------------------------------
     sigma_u |  1.0852216
     sigma_e |  .42706097
         rho |  .86590485   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =     48,839
Group variable: id                              Number of groups  =     10,806

R-sq:                                           Obs per group:
     within  = 0.0311                                         min =          1
     between = 0.0462                                         avg =        4.5
     overall = 0.0351                                         max =          9

                                                F(33,10805)       =      15.81
corr(u_i, Xb)  = 0.0705                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,806 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0326385   .0255533    -1.28   0.202    -.0827275    .0174506
         new |  -.0176473   .0061518    -2.87   0.004     -.029706   -.0055886
        fnew |  -.0050556   .0343184    -0.15   0.883     -.072326    .0622148
  fnew_expat |   .0247091   .0433439     0.57   0.569     -.060253    .1096711
             |
    ind_year |
         27  |  -.0115491    .011959    -0.97   0.334     -.034991    .0118927
         28  |  -.0047002   .0133609    -0.35   0.725    -.0308899    .0214896
         29  |  -.0081398   .0149022    -0.55   0.585    -.0373509    .0210713
         30  |   .0076601   .0168546     0.45   0.649    -.0253779    .0406982
         31  |    .015417    .018326     0.84   0.400    -.0205054    .0513394
         32  |   .0101487   .0200448     0.51   0.613    -.0291429    .0494402
         33  |   .0114835   .0218868     0.52   0.600    -.0314188    .0543857
         34  |   .0130702   .0231878     0.56   0.573    -.0323822    .0585226
         35  |   .0219536   .0243819     0.90   0.368    -.0258394    .0697467
         36  |   .0170654   .0255868     0.67   0.505    -.0330894    .0672203
         37  |    .014974   .0265692     0.56   0.573    -.0371065    .0670544
         38  |   .0150955   .0274225     0.55   0.582    -.0386576    .0688487
         39  |   .0090531   .0288064     0.31   0.753    -.0474127    .0655189
         40  |   .0130219   .0296976     0.44   0.661    -.0451908    .0712345
         41  |     .02818   .0306528     0.92   0.358    -.0319051     .088265
         42  |   .0285136   .0313587     0.91   0.363    -.0329551    .0899824
         43  |   .0414748   .0321216     1.29   0.197    -.0214895    .1044391
         44  |   .0618759   .0335622     1.84   0.065    -.0039122     .127664
         45  |   .0720783   .0345421     2.09   0.037     .0043696    .1397871
         46  |   .0716233    .035926     1.99   0.046     .0012018    .1420448
         47  |   .0790016   .0371392     2.13   0.033      .006202    .1518012
         48  |   .0599069   .0385557     1.55   0.120    -.0156693     .135483
         49  |  -.1628813   .0405017    -4.02   0.000    -.2422721   -.0834905
         50  |  -.2033524   .0420779    -4.83   0.000    -.2858328   -.1208721
             |
     age_cat |
          2  |   .0628524   .0110657     5.68   0.000     .0411616    .0845431
          3  |   .0962979   .0121353     7.94   0.000     .0725106    .1200853
          4  |   .1285568    .013467     9.55   0.000      .102159    .1549545
          5  |   .1483677   .0175792     8.44   0.000     .1139092    .1828263
          6  |   .1702099    .021546     7.90   0.000     .1279758    .2124441
             |
       _cons |   .4075752   .0194436    20.96   0.000     .3694621    .4456883
-------------+----------------------------------------------------------------
     sigma_u |  .43470969
     sigma_e |  .28041142
         rho |  .70616719   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0311409016861566

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =     48,839
Group variable: id                              Number of groups  =     10,806

R-sq:                                           Obs per group:
     within  = 0.0311                                         min =          1
     between = 0.0462                                         avg =        4.5
     overall = 0.0351                                         max =          9

                                                F(33,10805)       =      15.81
corr(u_i, Xb)  = 0.0705                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,806 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0326385   .0255533    -1.28   0.202    -.0827275    .0174506
         new |  -.0176473   .0061518    -2.87   0.004     -.029706   -.0055886
        fnew |  -.0050556   .0343184    -0.15   0.883     -.072326    .0622148
  fnew_expat |   .0247091   .0433439     0.57   0.569     -.060253    .1096711
             |
    ind_year |
         27  |  -.0115491    .011959    -0.97   0.334     -.034991    .0118927
         28  |  -.0047002   .0133609    -0.35   0.725    -.0308899    .0214896
         29  |  -.0081398   .0149022    -0.55   0.585    -.0373509    .0210713
         30  |   .0076601   .0168546     0.45   0.649    -.0253779    .0406982
         31  |    .015417    .018326     0.84   0.400    -.0205054    .0513394
         32  |   .0101487   .0200448     0.51   0.613    -.0291429    .0494402
         33  |   .0114835   .0218868     0.52   0.600    -.0314188    .0543857
         34  |   .0130702   .0231878     0.56   0.573    -.0323822    .0585226
         35  |   .0219536   .0243819     0.90   0.368    -.0258394    .0697467
         36  |   .0170654   .0255868     0.67   0.505    -.0330894    .0672203
         37  |    .014974   .0265692     0.56   0.573    -.0371065    .0670544
         38  |   .0150955   .0274225     0.55   0.582    -.0386576    .0688487
         39  |   .0090531   .0288064     0.31   0.753    -.0474127    .0655189
         40  |   .0130219   .0296976     0.44   0.661    -.0451908    .0712345
         41  |     .02818   .0306528     0.92   0.358    -.0319051     .088265
         42  |   .0285136   .0313587     0.91   0.363    -.0329551    .0899824
         43  |   .0414748   .0321216     1.29   0.197    -.0214895    .1044391
         44  |   .0618759   .0335622     1.84   0.065    -.0039122     .127664
         45  |   .0720783   .0345421     2.09   0.037     .0043696    .1397871
         46  |   .0716233    .035926     1.99   0.046     .0012018    .1420448
         47  |   .0790016   .0371392     2.13   0.033      .006202    .1518012
         48  |   .0599069   .0385557     1.55   0.120    -.0156693     .135483
         49  |  -.1628813   .0405017    -4.02   0.000    -.2422721   -.0834905
         50  |  -.2033524   .0420779    -4.83   0.000    -.2858328   -.1208721
             |
     age_cat |
          2  |   .0628524   .0110657     5.68   0.000     .0411616    .0845431
          3  |   .0962979   .0121353     7.94   0.000     .0725106    .1200853
          4  |   .1285568    .013467     9.55   0.000      .102159    .1549545
          5  |   .1483677   .0175792     8.44   0.000     .1139092    .1828263
          6  |   .1702099    .021546     7.90   0.000     .1279758    .2124441
             |
       _cons |   .4075752   .0194436    20.96   0.000     .3694621    .4456883
-------------+----------------------------------------------------------------
     sigma_u |  .43470969
     sigma_e |  .28041142
         rho |  .70616719   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =     34,071
Group variable: id                              Number of groups  =      8,816

R-sq:                                           Obs per group:
     within  = 0.0304                                         min =          1
     between = 0.0043                                         avg =        3.9
     overall = 0.0128                                         max =          8

                                                F(31,8815)        =      33.67
corr(u_i, Xb)  = -0.2514                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 8,816 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .2022983    .104854     1.93   0.054    -.0032399    .4078365
         new |   .0627867   .0209284     3.00   0.003     .0217621    .1038113
        fnew |  -.2389116   .1052035    -2.27   0.023    -.4451349   -.0326882
  fnew_expat |   .1887037   .1589107     1.19   0.235    -.1227983    .5002057
             |
    ind_year |
         28  |  -.0492387   .0457591    -1.08   0.282    -.1389372    .0404598
         29  |   -.034453   .0477118    -0.72   0.470    -.1279793    .0590732
         30  |   .0078465   .0512907     0.15   0.878    -.0926952    .1083882
         31  |    .055427   .0560167     0.99   0.322    -.0543788    .1652327
         32  |   .0519684   .0620713     0.84   0.402    -.0697059    .1736427
         33  |   .0418388    .066543     0.63   0.530     -.088601    .1722786
         34  |  -.2032352   .0718023    -2.83   0.005    -.3439844   -.0624859
         35  |  -.0922923   .0761965    -1.21   0.226    -.2416552    .0570705
         36  |  -.0020956   .0805535    -0.03   0.979    -.1599993    .1558081
         37  |  -.1380344   .0833197    -1.66   0.098    -.3013604    .0252916
         38  |   .0124634   .0874294     0.14   0.887    -.1589185    .1838454
         39  |  -.2543442   .0912167    -2.79   0.005    -.4331502   -.0755382
         40  |  -.2604102   .0950265    -2.74   0.006    -.4466843    -.074136
         41  |  -.3174779   .0966417    -3.29   0.001    -.5069182   -.1280376
         42  |  -.1703671   .1014026    -1.68   0.093    -.3691398    .0284057
         43  |  -.1333908   .1042133    -1.28   0.201    -.3376732    .0708917
         44  |  -.3914778   .1078162    -3.63   0.000    -.6028227   -.1801329
         45  |  -.4584308   .1108486    -4.14   0.000    -.6757199   -.2411417
         46  |  -.3666708   .1144838    -3.20   0.001    -.5910857   -.1422558
         47  |  -.2797072   .1193959    -2.34   0.019    -.5137509   -.0456635
         48  |  -.3354595    .123021    -2.73   0.006    -.5766094   -.0943096
         49  |   -1.14537   .1271686    -9.01   0.000     -1.39465   -.8960903
         50  |  -.5598493   .1443468    -3.88   0.000    -.8428027   -.2768958
             |
     age_cat |
          3  |   -.243761   .0372087    -6.55   0.000    -.3166986   -.1708234
          4  |  -.3956131   .0387719   -10.20   0.000    -.4716151   -.3196111
          5  |  -.4901474   .0491645    -9.97   0.000    -.5865212   -.3937735
          6  |  -.4815018     .06133    -7.85   0.000    -.6017229   -.3612807
             |
       _cons |    .436845   .0649649     6.72   0.000     .3094987    .5641913
-------------+----------------------------------------------------------------
     sigma_u |  .60843072
     sigma_e |  .86491297
         rho |  .33103854   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0303677165859706

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =     34,071
Group variable: id                              Number of groups  =      8,816

R-sq:                                           Obs per group:
     within  = 0.0304                                         min =          1
     between = 0.0043                                         avg =        3.9
     overall = 0.0128                                         max =          8

                                                F(31,8815)        =      33.67
corr(u_i, Xb)  = -0.2514                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 8,816 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .2022983    .104854     1.93   0.054    -.0032399    .4078365
         new |   .0627867   .0209284     3.00   0.003     .0217621    .1038113
        fnew |  -.2389116   .1052035    -2.27   0.023    -.4451349   -.0326882
  fnew_expat |   .1887037   .1589107     1.19   0.235    -.1227983    .5002057
             |
    ind_year |
         28  |  -.0492387   .0457591    -1.08   0.282    -.1389372    .0404598
         29  |   -.034453   .0477118    -0.72   0.470    -.1279793    .0590732
         30  |   .0078465   .0512907     0.15   0.878    -.0926952    .1083882
         31  |    .055427   .0560167     0.99   0.322    -.0543788    .1652327
         32  |   .0519684   .0620713     0.84   0.402    -.0697059    .1736427
         33  |   .0418388    .066543     0.63   0.530     -.088601    .1722786
         34  |  -.2032352   .0718023    -2.83   0.005    -.3439844   -.0624859
         35  |  -.0922923   .0761965    -1.21   0.226    -.2416552    .0570705
         36  |  -.0020956   .0805535    -0.03   0.979    -.1599993    .1558081
         37  |  -.1380344   .0833197    -1.66   0.098    -.3013604    .0252916
         38  |   .0124634   .0874294     0.14   0.887    -.1589185    .1838454
         39  |  -.2543442   .0912167    -2.79   0.005    -.4331502   -.0755382
         40  |  -.2604102   .0950265    -2.74   0.006    -.4466843    -.074136
         41  |  -.3174779   .0966417    -3.29   0.001    -.5069182   -.1280376
         42  |  -.1703671   .1014026    -1.68   0.093    -.3691398    .0284057
         43  |  -.1333908   .1042133    -1.28   0.201    -.3376732    .0708917
         44  |  -.3914778   .1078162    -3.63   0.000    -.6028227   -.1801329
         45  |  -.4584308   .1108486    -4.14   0.000    -.6757199   -.2411417
         46  |  -.3666708   .1144838    -3.20   0.001    -.5910857   -.1422558
         47  |  -.2797072   .1193959    -2.34   0.019    -.5137509   -.0456635
         48  |  -.3354595    .123021    -2.73   0.006    -.5766094   -.0943096
         49  |   -1.14537   .1271686    -9.01   0.000     -1.39465   -.8960903
         50  |  -.5598493   .1443468    -3.88   0.000    -.8428027   -.2768958
             |
     age_cat |
          3  |   -.243761   .0372087    -6.55   0.000    -.3166986   -.1708234
          4  |  -.3956131   .0387719   -10.20   0.000    -.4716151   -.3196111
          5  |  -.4901474   .0491645    -9.97   0.000    -.5865212   -.3937735
          6  |  -.4815018     .06133    -7.85   0.000    -.6017229   -.3612807
             |
       _cons |    .436845   .0649649     6.72   0.000     .3094987    .5641913
-------------+----------------------------------------------------------------
     sigma_u |  .60843072
     sigma_e |  .86491297
         rho |  .33103854   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.1408                                         min =          1
     between = 0.1116                                         avg =        5.2
     overall = 0.1166                                         max =          9

                                                F(58,1159)        =       5.61
corr(u_i, Xb)  = -0.0479                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0787702   .0482853    -1.63   0.103    -.1735067    .0159663
         new |   -.167896   .0577917    -2.91   0.004    -.2812842   -.0545079
        fnew |   .0870709   .0717395     1.21   0.225    -.0536829    .2278246
  fnew_expat |  -.0707973   .0907519    -0.78   0.435    -.2488537    .1072591
             |
    ind_year |
          2  |  -.0368671   .0782605    -0.47   0.638    -.1904152    .1166811
          3  |  -.1298435   .0953767    -1.36   0.174    -.3169739    .0572869
          4  |  -.3030086   .1206261    -2.51   0.012    -.5396786   -.0663386
          5  |  -.3301129   .1359729    -2.43   0.015    -.5968936   -.0633322
          6  |  -.4195974   .1697666    -2.47   0.014    -.7526816   -.0865132
          7  |  -.4495335   .2042995    -2.20   0.028    -.8503717   -.0486954
          8  |  -.3751435   .2189073    -1.71   0.087    -.8046424    .0543555
          9  |  -.3463197    .236499    -1.46   0.143    -.8103339    .1176944
         10  |  -.4168637   .2430873    -1.71   0.087    -.8938041    .0600766
         11  |  -.4247981   .2479541    -1.71   0.087    -.9112873     .061691
         12  |  -.4733403    .259771    -1.82   0.069    -.9830144    .0363337
         13  |  -.3901788   .2644115    -1.48   0.140    -.9089575    .1285999
         14  |  -.5866374   .2717831    -2.16   0.031    -1.119879   -.0533954
         15  |  -.4953609   .2732808    -1.81   0.070    -1.031541    .0408194
         16  |  -.5213048   .2666925    -1.95   0.051    -1.044559    .0019494
         17  |   -.402619   .2680803    -1.50   0.133    -.9285959    .1233579
         18  |  -.3771687    .267139    -1.41   0.158    -.9012989    .1469615
         19  |    -.51619   .2748435    -1.88   0.061    -1.055437    .0230566
         20  |  -.7436362   .2819204    -2.64   0.008    -1.296768   -.1905047
         21  |  -.7314904   .2844563    -2.57   0.010    -1.289597   -.1733835
         22  |  -.7879869   .2927275    -2.69   0.007    -1.362322   -.2136518
         23  |  -.8348504   .3039488    -2.75   0.006    -1.431202   -.2384989
         24  |  -.7890878   .3287757    -2.40   0.017     -1.43415   -.1440257
         25  |  -.6853758        .33    -2.08   0.038     -1.33284   -.0379116
         26  |   1.255791   .3143314     4.00   0.000     .6390685    1.872513
         27  |   1.061001   .3198743     3.32   0.001     .4334033    1.688598
         28  |   .9952454    .318809     3.12   0.002     .3697381    1.620753
         29  |    .884708   .3061644     2.89   0.004     .2840094    1.485407
         30  |   .7049263   .2943717     2.39   0.017     .1273653    1.282487
         31  |   .6163135   .2980951     2.07   0.039      .031447     1.20118
         32  |   .4020011   .2943305     1.37   0.172    -.1754792    .9794814
         33  |   .3937052   .2919256     1.35   0.178    -.1790566    .9664671
         34  |   .4111609   .2912198     1.41   0.158     -.160216    .9825378
         35  |   .4379376   .2983102     1.47   0.142    -.1473509    1.023226
         36  |   .4970746   .3076666     1.62   0.106    -.1065713     1.10072
         37  |   .4646932   .3080691     1.51   0.132    -.1397423    1.069129
         38  |   .4435869   .3073563     1.44   0.149    -.1594501    1.046624
         39  |   .4780165   .3064148     1.56   0.119    -.1231733    1.079206
         40  |    .394613   .3050599     1.29   0.196    -.2039185    .9931445
         41  |   .2504097   .3192753     0.78   0.433    -.3760125    .8768319
         42  |   .1197419   .3235004     0.37   0.711      -.51497    .7544538
         43  |   .1002067   .3257193     0.31   0.758    -.5388588    .7392723
         44  |  -.0077409   .3278686    -0.02   0.981    -.6510234    .6355415
         45  |  -.1781936   .3324413    -0.54   0.592    -.8304477    .4740606
         46  |  -.0205747   .3436022    -0.06   0.952    -.6947267    .6535772
         47  |  -.0004042   .3490485    -0.00   0.999    -.6852419    .6844334
         48  |   .1946439   .3580254     0.54   0.587    -.5078065    .8970943
         49  |  -.0600931   .3862882    -0.16   0.876    -.8179955    .6978093
         50  |   .1059154   .3669884     0.29   0.773    -.6141205    .8259513
             |
     age_cat |
          2  |   .5534962   .0812049     6.82   0.000     .3941711    .7128212
          3  |   .8515536   .0910898     9.35   0.000     .6728342    1.030273
          4  |    1.17968   .1097979    10.74   0.000     .9642555    1.395105
          5  |    1.22566   .1417752     8.65   0.000     .9474953    1.503825
          6  |   1.345245   .1703499     7.90   0.000     1.011017    1.679474
             |
       _cons |   3.149277    .202513    15.55   0.000     2.751944     3.54661
-------------+----------------------------------------------------------------
     sigma_u |   1.204843
     sigma_e |  .58076867
         rho |   .8114568   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1407793108938344

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.1408                                         min =          1
     between = 0.1116                                         avg =        5.2
     overall = 0.1166                                         max =          9

                                                F(58,1159)        =       5.61
corr(u_i, Xb)  = -0.0479                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0787702   .0482853    -1.63   0.103    -.1735067    .0159663
         new |   -.167896   .0577917    -2.91   0.004    -.2812842   -.0545079
        fnew |   .0870709   .0717395     1.21   0.225    -.0536829    .2278246
  fnew_expat |  -.0707973   .0907519    -0.78   0.435    -.2488537    .1072591
             |
    ind_year |
          2  |  -.0368671   .0782605    -0.47   0.638    -.1904152    .1166811
          3  |  -.1298435   .0953767    -1.36   0.174    -.3169739    .0572869
          4  |  -.3030086   .1206261    -2.51   0.012    -.5396786   -.0663386
          5  |  -.3301129   .1359729    -2.43   0.015    -.5968936   -.0633322
          6  |  -.4195974   .1697666    -2.47   0.014    -.7526816   -.0865132
          7  |  -.4495335   .2042995    -2.20   0.028    -.8503717   -.0486954
          8  |  -.3751435   .2189073    -1.71   0.087    -.8046424    .0543555
          9  |  -.3463197    .236499    -1.46   0.143    -.8103339    .1176944
         10  |  -.4168637   .2430873    -1.71   0.087    -.8938041    .0600766
         11  |  -.4247981   .2479541    -1.71   0.087    -.9112873     .061691
         12  |  -.4733403    .259771    -1.82   0.069    -.9830144    .0363337
         13  |  -.3901788   .2644115    -1.48   0.140    -.9089575    .1285999
         14  |  -.5866374   .2717831    -2.16   0.031    -1.119879   -.0533954
         15  |  -.4953609   .2732808    -1.81   0.070    -1.031541    .0408194
         16  |  -.5213048   .2666925    -1.95   0.051    -1.044559    .0019494
         17  |   -.402619   .2680803    -1.50   0.133    -.9285959    .1233579
         18  |  -.3771687    .267139    -1.41   0.158    -.9012989    .1469615
         19  |    -.51619   .2748435    -1.88   0.061    -1.055437    .0230566
         20  |  -.7436362   .2819204    -2.64   0.008    -1.296768   -.1905047
         21  |  -.7314904   .2844563    -2.57   0.010    -1.289597   -.1733835
         22  |  -.7879869   .2927275    -2.69   0.007    -1.362322   -.2136518
         23  |  -.8348504   .3039488    -2.75   0.006    -1.431202   -.2384989
         24  |  -.7890878   .3287757    -2.40   0.017     -1.43415   -.1440257
         25  |  -.6853758        .33    -2.08   0.038     -1.33284   -.0379116
         26  |   1.255791   .3143314     4.00   0.000     .6390685    1.872513
         27  |   1.061001   .3198743     3.32   0.001     .4334033    1.688598
         28  |   .9952454    .318809     3.12   0.002     .3697381    1.620753
         29  |    .884708   .3061644     2.89   0.004     .2840094    1.485407
         30  |   .7049263   .2943717     2.39   0.017     .1273653    1.282487
         31  |   .6163135   .2980951     2.07   0.039      .031447     1.20118
         32  |   .4020011   .2943305     1.37   0.172    -.1754792    .9794814
         33  |   .3937052   .2919256     1.35   0.178    -.1790566    .9664671
         34  |   .4111609   .2912198     1.41   0.158     -.160216    .9825378
         35  |   .4379376   .2983102     1.47   0.142    -.1473509    1.023226
         36  |   .4970746   .3076666     1.62   0.106    -.1065713     1.10072
         37  |   .4646932   .3080691     1.51   0.132    -.1397423    1.069129
         38  |   .4435869   .3073563     1.44   0.149    -.1594501    1.046624
         39  |   .4780165   .3064148     1.56   0.119    -.1231733    1.079206
         40  |    .394613   .3050599     1.29   0.196    -.2039185    .9931445
         41  |   .2504097   .3192753     0.78   0.433    -.3760125    .8768319
         42  |   .1197419   .3235004     0.37   0.711      -.51497    .7544538
         43  |   .1002067   .3257193     0.31   0.758    -.5388588    .7392723
         44  |  -.0077409   .3278686    -0.02   0.981    -.6510234    .6355415
         45  |  -.1781936   .3324413    -0.54   0.592    -.8304477    .4740606
         46  |  -.0205747   .3436022    -0.06   0.952    -.6947267    .6535772
         47  |  -.0004042   .3490485    -0.00   0.999    -.6852419    .6844334
         48  |   .1946439   .3580254     0.54   0.587    -.5078065    .8970943
         49  |  -.0600931   .3862882    -0.16   0.876    -.8179955    .6978093
         50  |   .1059154   .3669884     0.29   0.773    -.6141205    .8259513
             |
     age_cat |
          2  |   .5534962   .0812049     6.82   0.000     .3941711    .7128212
          3  |   .8515536   .0910898     9.35   0.000     .6728342    1.030273
          4  |    1.17968   .1097979    10.74   0.000     .9642555    1.395105
          5  |    1.22566   .1417752     8.65   0.000     .9474953    1.503825
          6  |   1.345245   .1703499     7.90   0.000     1.011017    1.679474
             |
       _cons |   3.149277    .202513    15.55   0.000     2.751944     3.54661
-------------+----------------------------------------------------------------
     sigma_u |   1.204843
     sigma_e |  .58076867
         rho |   .8114568   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =      5,687
Group variable: id                              Number of groups  =      1,137

R-sq:                                           Obs per group:
     within  = 0.1378                                         min =          1
     between = 0.1740                                         avg =        5.0
     overall = 0.1725                                         max =          9

                                                F(58,1136)        =       6.40
corr(u_i, Xb)  = 0.1482                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,137 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0796173   .0829522    -0.96   0.337     -.242374    .0831394
         new |  -.0705796   .0698422    -1.01   0.312    -.2076137    .0664545
        fnew |   .0008622   .1071963     0.01   0.994    -.2094628    .2111872
  fnew_expat |  -.0355607   .1226355    -0.29   0.772    -.2761782    .2050567
             |
    ind_year |
          2  |  -.0520907   .1202217    -0.43   0.665    -.2879721    .1837907
          3  |   .5836497   .1679177     3.48   0.001     .2541862    .9131133
          4  |   .5083863   .1913173     2.66   0.008     .1330113    .8837612
          5  |    .746386   .2070015     3.61   0.000     .3402377    1.152534
          6  |   .7052891   .2595806     2.72   0.007     .1959778      1.2146
          7  |   1.174888   .2788594     4.21   0.000     .6277507    1.722026
          8  |   1.370466    .301312     4.55   0.000      .779275    1.961656
          9  |   1.533164   .3155253     4.86   0.000     .9140858    2.152241
         10  |   1.503991   .3341185     4.50   0.000     .8484326     2.15955
         11  |   1.706771   .3528153     4.84   0.000     1.014528    2.399014
         12  |   1.672691   .3602573     4.64   0.000     .9658469    2.379536
         13  |   1.600949   .3593691     4.45   0.000     .8958472    2.306051
         14  |    1.47324   .3655846     4.03   0.000     .7559435    2.190537
         15  |   1.371981   .3740872     3.67   0.000     .6380021    2.105961
         16  |   1.465422   .3765211     3.89   0.000     .7266671    2.204177
         17  |   1.360128   .3818556     3.56   0.000     .6109067     2.10935
         18  |   1.284001   .3910031     3.28   0.001     .5168313     2.05117
         19  |   .9527753   .4006991     2.38   0.018     .1665819    1.738969
         20  |   .8930946   .4130506     2.16   0.031     .0826669    1.703522
         21  |   .9140218   .4099376     2.23   0.026      .109702    1.718342
         22  |   .9638058   .4248524     2.27   0.023     .1302223    1.797389
         23  |    .879675   .4208813     2.09   0.037     .0538829    1.705467
         24  |   .2427947   .4911813     0.49   0.621    -.7209298    1.206519
         25  |   .1731871   .5407535     0.32   0.749    -.8878006    1.234175
         26  |   2.024393   .3795017     5.33   0.000      1.27979    2.768996
         27  |   1.919337   .3849107     4.99   0.000     1.164121    2.674553
         28  |   2.061254   .3655996     5.64   0.000     1.343927     2.77858
         29  |   2.031289   .3595247     5.65   0.000     1.325882    2.736696
         30  |   1.683504   .3599109     4.68   0.000     .9773394    2.389669
         31  |   1.869708   .3481384     5.37   0.000     1.186641    2.552774
         32  |   1.853308   .3505014     5.29   0.000     1.165605    2.541011
         33  |   2.013005   .3516904     5.72   0.000      1.32297    2.703041
         34  |   1.969438   .3614307     5.45   0.000     1.260291    2.678584
         35  |    2.17678   .3581365     6.08   0.000     1.474097    2.879464
         36  |   2.178428   .3638412     5.99   0.000     1.464551    2.892304
         37  |   2.268302   .3610908     6.28   0.000     1.559822    2.976782
         38  |    2.10874   .3692535     5.71   0.000     1.384245    2.833236
         39  |   2.100691   .3802778     5.52   0.000     1.354565    2.846816
         40  |   1.995814   .3958942     5.04   0.000     1.219048    2.772579
         41  |   1.794088   .3922614     4.57   0.000      1.02445    2.563726
         42  |   1.884015   .3977628     4.74   0.000     1.103582    2.664447
         43  |   2.013222   .3993121     5.04   0.000      1.22975    2.796694
         44  |   1.668721   .4184757     3.99   0.000     .8476491    2.489793
         45  |   1.794925   .4079118     4.40   0.000     .9945802    2.595271
         46  |   1.863702   .4335272     4.30   0.000     1.013098    2.714306
         47  |   2.013117   .4351978     4.63   0.000     1.159236    2.866999
         48  |    2.01647   .4349417     4.64   0.000     1.163091    2.869849
         49  |    1.88624   .4595161     4.10   0.000     .9846438    2.787835
         50  |   2.254943   .4597352     4.90   0.000     1.352917    3.156968
             |
     age_cat |
          2  |   .4731194   .1399502     3.38   0.001     .1985296    .7477093
          3  |    .860825   .1520864     5.66   0.000     .5624232    1.159227
          4  |   1.120902   .1800263     6.23   0.000     .7676805    1.474123
          5  |   1.217887   .2183098     5.58   0.000     .7895514    1.646223
          6  |   1.420084   .2485006     5.71   0.000     .9325128    1.907656
             |
       _cons |   8.154171   .2822284    28.89   0.000     7.600424    8.707918
-------------+----------------------------------------------------------------
     sigma_u |  1.9836132
     sigma_e |  .81882839
         rho |  .85440812   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1378040141778686

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =      5,687
Group variable: id                              Number of groups  =      1,137

R-sq:                                           Obs per group:
     within  = 0.1378                                         min =          1
     between = 0.1740                                         avg =        5.0
     overall = 0.1725                                         max =          9

                                                F(58,1136)        =       6.40
corr(u_i, Xb)  = 0.1482                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,137 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0796173   .0829522    -0.96   0.337     -.242374    .0831394
         new |  -.0705796   .0698422    -1.01   0.312    -.2076137    .0664545
        fnew |   .0008622   .1071963     0.01   0.994    -.2094628    .2111872
  fnew_expat |  -.0355607   .1226355    -0.29   0.772    -.2761782    .2050567
             |
    ind_year |
          2  |  -.0520907   .1202217    -0.43   0.665    -.2879721    .1837907
          3  |   .5836497   .1679177     3.48   0.001     .2541862    .9131133
          4  |   .5083863   .1913173     2.66   0.008     .1330113    .8837612
          5  |    .746386   .2070015     3.61   0.000     .3402377    1.152534
          6  |   .7052891   .2595806     2.72   0.007     .1959778      1.2146
          7  |   1.174888   .2788594     4.21   0.000     .6277507    1.722026
          8  |   1.370466    .301312     4.55   0.000      .779275    1.961656
          9  |   1.533164   .3155253     4.86   0.000     .9140858    2.152241
         10  |   1.503991   .3341185     4.50   0.000     .8484326     2.15955
         11  |   1.706771   .3528153     4.84   0.000     1.014528    2.399014
         12  |   1.672691   .3602573     4.64   0.000     .9658469    2.379536
         13  |   1.600949   .3593691     4.45   0.000     .8958472    2.306051
         14  |    1.47324   .3655846     4.03   0.000     .7559435    2.190537
         15  |   1.371981   .3740872     3.67   0.000     .6380021    2.105961
         16  |   1.465422   .3765211     3.89   0.000     .7266671    2.204177
         17  |   1.360128   .3818556     3.56   0.000     .6109067     2.10935
         18  |   1.284001   .3910031     3.28   0.001     .5168313     2.05117
         19  |   .9527753   .4006991     2.38   0.018     .1665819    1.738969
         20  |   .8930946   .4130506     2.16   0.031     .0826669    1.703522
         21  |   .9140218   .4099376     2.23   0.026      .109702    1.718342
         22  |   .9638058   .4248524     2.27   0.023     .1302223    1.797389
         23  |    .879675   .4208813     2.09   0.037     .0538829    1.705467
         24  |   .2427947   .4911813     0.49   0.621    -.7209298    1.206519
         25  |   .1731871   .5407535     0.32   0.749    -.8878006    1.234175
         26  |   2.024393   .3795017     5.33   0.000      1.27979    2.768996
         27  |   1.919337   .3849107     4.99   0.000     1.164121    2.674553
         28  |   2.061254   .3655996     5.64   0.000     1.343927     2.77858
         29  |   2.031289   .3595247     5.65   0.000     1.325882    2.736696
         30  |   1.683504   .3599109     4.68   0.000     .9773394    2.389669
         31  |   1.869708   .3481384     5.37   0.000     1.186641    2.552774
         32  |   1.853308   .3505014     5.29   0.000     1.165605    2.541011
         33  |   2.013005   .3516904     5.72   0.000      1.32297    2.703041
         34  |   1.969438   .3614307     5.45   0.000     1.260291    2.678584
         35  |    2.17678   .3581365     6.08   0.000     1.474097    2.879464
         36  |   2.178428   .3638412     5.99   0.000     1.464551    2.892304
         37  |   2.268302   .3610908     6.28   0.000     1.559822    2.976782
         38  |    2.10874   .3692535     5.71   0.000     1.384245    2.833236
         39  |   2.100691   .3802778     5.52   0.000     1.354565    2.846816
         40  |   1.995814   .3958942     5.04   0.000     1.219048    2.772579
         41  |   1.794088   .3922614     4.57   0.000      1.02445    2.563726
         42  |   1.884015   .3977628     4.74   0.000     1.103582    2.664447
         43  |   2.013222   .3993121     5.04   0.000      1.22975    2.796694
         44  |   1.668721   .4184757     3.99   0.000     .8476491    2.489793
         45  |   1.794925   .4079118     4.40   0.000     .9945802    2.595271
         46  |   1.863702   .4335272     4.30   0.000     1.013098    2.714306
         47  |   2.013117   .4351978     4.63   0.000     1.159236    2.866999
         48  |    2.01647   .4349417     4.64   0.000     1.163091    2.869849
         49  |    1.88624   .4595161     4.10   0.000     .9846438    2.787835
         50  |   2.254943   .4597352     4.90   0.000     1.352917    3.156968
             |
     age_cat |
          2  |   .4731194   .1399502     3.38   0.001     .1985296    .7477093
          3  |    .860825   .1520864     5.66   0.000     .5624232    1.159227
          4  |   1.120902   .1800263     6.23   0.000     .7676805    1.474123
          5  |   1.217887   .2183098     5.58   0.000     .7895514    1.646223
          6  |   1.420084   .2485006     5.71   0.000     .9325128    1.907656
             |
       _cons |   8.154171   .2822284    28.89   0.000     7.600424    8.707918
-------------+----------------------------------------------------------------
     sigma_u |  1.9836132
     sigma_e |  .81882839
         rho |  .85440812   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.1887                                         min =          1
     between = 0.1537                                         avg =        5.2
     overall = 0.1511                                         max =          9

                                                F(58,1159)        =      10.68
corr(u_i, Xb)  = 0.0979                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0381694   .0573217    -0.67   0.506    -.1506353    .0742964
         new |  -.1775877   .0593676    -2.99   0.003    -.2940677   -.0611078
        fnew |   .1278048   .0796642     1.60   0.109    -.0284975     .284107
  fnew_expat |   .1656344   .0882102     1.88   0.061    -.0074352    .3387039
             |
    ind_year |
          2  |   .0817356   .0888584     0.92   0.358    -.0926058     .256077
          3  |   .3288452   .1125062     2.92   0.004     .1081067    .5495837
          4  |    .466838   .1489755     3.13   0.002     .1745462    .7591299
          5  |   .6580747   .1516812     4.34   0.000     .3604742    .9556752
          6  |   .8060024   .1809161     4.46   0.000     .4510427    1.160962
          7  |   .8574017   .2183925     3.93   0.000     .4289128    1.285891
          8  |   1.048029   .2281183     4.59   0.000     .6004576      1.4956
          9  |   1.301847   .2393304     5.44   0.000     .8322771    1.771416
         10  |   1.278897    .249382     5.13   0.000     .7896059    1.768187
         11  |   1.481605    .247321     5.99   0.000     .9963584    1.966852
         12  |   1.543634    .257341     6.00   0.000     1.038728    2.048541
         13  |   1.651804   .2615735     6.31   0.000     1.138593    2.165015
         14  |   1.576946   .2730756     5.77   0.000     1.041168    2.112724
         15  |   1.729978   .2786542     6.21   0.000     1.183255    2.276701
         16  |   1.788986   .2663722     6.72   0.000      1.26636    2.311612
         17  |   1.897909   .2738236     6.93   0.000     1.360664    2.435154
         18  |   1.798991   .2714998     6.63   0.000     1.266305    2.331677
         19  |    1.67818   .2800936     5.99   0.000     1.128633    2.227728
         20  |   1.619261    .286309     5.66   0.000     1.057519    2.181003
         21  |   1.588272   .2862263     5.55   0.000     1.026692    2.149851
         22  |   1.689786   .3000383     5.63   0.000     1.101107    2.278465
         23  |   1.709067    .315493     5.42   0.000     1.090066    2.328069
         24  |   1.857166   .3421892     5.43   0.000     1.185786    2.528545
         25  |   1.868871   .3983147     4.69   0.000     1.087373     2.65037
         26  |   .5398786   .3169581     1.70   0.089    -.0819973    1.161755
         27  |   .6413663   .3078878     2.08   0.037     .0372865    1.245446
         28  |   .9437337   .3097093     3.05   0.002     .3360801    1.551387
         29  |   1.092772   .3011761     3.63   0.000      .501861    1.683684
         30  |   1.032667   .2908657     3.55   0.000     .4619846    1.603349
         31  |   1.147498    .287217     4.00   0.000      .583974    1.711021
         32  |   1.192959   .2945653     4.05   0.000     .6150186      1.7709
         33  |   1.343931   .2889126     4.65   0.000     .7770808    1.910781
         34  |   1.451932   .2949848     4.92   0.000     .8731677    2.030696
         35  |   1.660386   .2964646     5.60   0.000     1.078719    2.242054
         36  |   1.748397   .3073014     5.69   0.000     1.145468    2.351327
         37  |   1.873759   .3094414     6.06   0.000     1.266631    2.480887
         38  |   1.945329   .3097358     6.28   0.000     1.337624    2.553035
         39  |   2.053978   .3042235     6.75   0.000     1.457088    2.650868
         40  |   2.082444    .300758     6.92   0.000     1.492353    2.672535
         41  |   2.118491   .3083944     6.87   0.000     1.513417    2.723565
         42  |   2.044317   .3170209     6.45   0.000     1.422317    2.666316
         43  |   1.994201   .3125239     6.38   0.000     1.381025    2.607377
         44  |    1.89956   .3140359     6.05   0.000     1.283417    2.515702
         45  |   1.815145   .3236977     5.61   0.000     1.180046    2.450244
         46  |   1.982181   .3273216     6.06   0.000     1.339972    2.624391
         47  |   2.158093   .3325877     6.49   0.000     1.505552    2.810635
         48  |   2.219586   .3375499     6.58   0.000     1.557309    2.881864
         49  |   2.326658   .3359312     6.93   0.000     1.667556    2.985759
         50  |    2.12641   .3463044     6.14   0.000     1.446956    2.805863
             |
     age_cat |
          2  |   .8718617   .1082056     8.06   0.000     .6595609    1.084162
          3  |   1.135928   .1151796     9.86   0.000     .9099444    1.361912
          4  |   1.370089   .1293181    10.59   0.000     1.116365    1.623813
          5  |   1.315186   .1583279     8.31   0.000     1.004545    1.625828
          6  |   1.321949   .1888077     7.00   0.000      .951506    1.692392
             |
       _cons |   10.95148   .2150446    50.93   0.000     10.52956     11.3734
-------------+----------------------------------------------------------------
     sigma_u |   1.710017
     sigma_e |  .62643174
         rho |  .88168013   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1887158889915825

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.1887                                         min =          1
     between = 0.1537                                         avg =        5.2
     overall = 0.1511                                         max =          9

                                                F(58,1159)        =      10.68
corr(u_i, Xb)  = 0.0979                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0381694   .0573217    -0.67   0.506    -.1506353    .0742964
         new |  -.1775877   .0593676    -2.99   0.003    -.2940677   -.0611078
        fnew |   .1278048   .0796642     1.60   0.109    -.0284975     .284107
  fnew_expat |   .1656344   .0882102     1.88   0.061    -.0074352    .3387039
             |
    ind_year |
          2  |   .0817356   .0888584     0.92   0.358    -.0926058     .256077
          3  |   .3288452   .1125062     2.92   0.004     .1081067    .5495837
          4  |    .466838   .1489755     3.13   0.002     .1745462    .7591299
          5  |   .6580747   .1516812     4.34   0.000     .3604742    .9556752
          6  |   .8060024   .1809161     4.46   0.000     .4510427    1.160962
          7  |   .8574017   .2183925     3.93   0.000     .4289128    1.285891
          8  |   1.048029   .2281183     4.59   0.000     .6004576      1.4956
          9  |   1.301847   .2393304     5.44   0.000     .8322771    1.771416
         10  |   1.278897    .249382     5.13   0.000     .7896059    1.768187
         11  |   1.481605    .247321     5.99   0.000     .9963584    1.966852
         12  |   1.543634    .257341     6.00   0.000     1.038728    2.048541
         13  |   1.651804   .2615735     6.31   0.000     1.138593    2.165015
         14  |   1.576946   .2730756     5.77   0.000     1.041168    2.112724
         15  |   1.729978   .2786542     6.21   0.000     1.183255    2.276701
         16  |   1.788986   .2663722     6.72   0.000      1.26636    2.311612
         17  |   1.897909   .2738236     6.93   0.000     1.360664    2.435154
         18  |   1.798991   .2714998     6.63   0.000     1.266305    2.331677
         19  |    1.67818   .2800936     5.99   0.000     1.128633    2.227728
         20  |   1.619261    .286309     5.66   0.000     1.057519    2.181003
         21  |   1.588272   .2862263     5.55   0.000     1.026692    2.149851
         22  |   1.689786   .3000383     5.63   0.000     1.101107    2.278465
         23  |   1.709067    .315493     5.42   0.000     1.090066    2.328069
         24  |   1.857166   .3421892     5.43   0.000     1.185786    2.528545
         25  |   1.868871   .3983147     4.69   0.000     1.087373     2.65037
         26  |   .5398786   .3169581     1.70   0.089    -.0819973    1.161755
         27  |   .6413663   .3078878     2.08   0.037     .0372865    1.245446
         28  |   .9437337   .3097093     3.05   0.002     .3360801    1.551387
         29  |   1.092772   .3011761     3.63   0.000      .501861    1.683684
         30  |   1.032667   .2908657     3.55   0.000     .4619846    1.603349
         31  |   1.147498    .287217     4.00   0.000      .583974    1.711021
         32  |   1.192959   .2945653     4.05   0.000     .6150186      1.7709
         33  |   1.343931   .2889126     4.65   0.000     .7770808    1.910781
         34  |   1.451932   .2949848     4.92   0.000     .8731677    2.030696
         35  |   1.660386   .2964646     5.60   0.000     1.078719    2.242054
         36  |   1.748397   .3073014     5.69   0.000     1.145468    2.351327
         37  |   1.873759   .3094414     6.06   0.000     1.266631    2.480887
         38  |   1.945329   .3097358     6.28   0.000     1.337624    2.553035
         39  |   2.053978   .3042235     6.75   0.000     1.457088    2.650868
         40  |   2.082444    .300758     6.92   0.000     1.492353    2.672535
         41  |   2.118491   .3083944     6.87   0.000     1.513417    2.723565
         42  |   2.044317   .3170209     6.45   0.000     1.422317    2.666316
         43  |   1.994201   .3125239     6.38   0.000     1.381025    2.607377
         44  |    1.89956   .3140359     6.05   0.000     1.283417    2.515702
         45  |   1.815145   .3236977     5.61   0.000     1.180046    2.450244
         46  |   1.982181   .3273216     6.06   0.000     1.339972    2.624391
         47  |   2.158093   .3325877     6.49   0.000     1.505552    2.810635
         48  |   2.219586   .3375499     6.58   0.000     1.557309    2.881864
         49  |   2.326658   .3359312     6.93   0.000     1.667556    2.985759
         50  |    2.12641   .3463044     6.14   0.000     1.446956    2.805863
             |
     age_cat |
          2  |   .8718617   .1082056     8.06   0.000     .6595609    1.084162
          3  |   1.135928   .1151796     9.86   0.000     .9099444    1.361912
          4  |   1.370089   .1293181    10.59   0.000     1.116365    1.623813
          5  |   1.315186   .1583279     8.31   0.000     1.004545    1.625828
          6  |   1.321949   .1888077     7.00   0.000      .951506    1.692392
             |
       _cons |   10.95148   .2150446    50.93   0.000     10.52956     11.3734
-------------+----------------------------------------------------------------
     sigma_u |   1.710017
     sigma_e |  .62643174
         rho |  .88168013   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =      5,687
Group variable: id                              Number of groups  =      1,137

R-sq:                                           Obs per group:
     within  = 0.0982                                         min =          1
     between = 0.1216                                         avg =        5.0
     overall = 0.1222                                         max =          9

                                                F(58,1136)        =       4.91
corr(u_i, Xb)  = 0.0857                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,137 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0105652   .0747946     0.14   0.888    -.1361858    .1573163
         new |    .088429   .0682303     1.30   0.195    -.0454425    .2223006
        fnew |  -.1122101   .1007734    -1.11   0.266    -.3099329    .0855127
  fnew_expat |  -.0039893   .1076849    -0.04   0.970     -.215273    .2072944
             |
    ind_year |
          2  |   -.030159   .0981346    -0.31   0.759    -.2227044    .1623864
          3  |   .6944682   .1421698     4.88   0.000     .4155233    .9734131
          4  |    .761347   .1574153     4.84   0.000     .4524897    1.070204
          5  |   1.027348    .174011     5.90   0.000     .6859291    1.368767
          6  |   1.079886   .2153253     5.02   0.000     .6574063    1.502366
          7  |   1.593425   .2370058     6.72   0.000     1.128407    2.058443
          8  |   1.752034   .2568676     6.82   0.000     1.248045    2.256022
          9  |   1.873861   .2667892     7.02   0.000     1.350406    2.397316
         10  |   1.923342   .2810355     6.84   0.000     1.371936    2.474749
         11  |   2.130753   .2935811     7.26   0.000     1.554731    2.706775
         12  |    2.13898   .3010306     7.11   0.000     1.548341    2.729618
         13  |   2.008907   .3060872     6.56   0.000     1.408347    2.609467
         14  |   1.979476   .3153754     6.28   0.000     1.360692     2.59826
         15  |    1.84293   .3194126     5.77   0.000     1.216226    2.469635
         16  |   1.933908   .3216662     6.01   0.000     1.302781    2.565034
         17  |   1.774611   .3260346     5.44   0.000     1.134914    2.414309
         18  |   1.623344   .3354002     4.84   0.000     .9652706    2.281418
         19  |   1.489205   .3466778     4.30   0.000     .8090042    2.169406
         20  |   1.597162   .3637084     4.39   0.000     .8835468    2.310778
         21  |   1.652694   .3660154     4.52   0.000     .9345514    2.370836
         22  |   1.801738   .3956821     4.55   0.000     1.025388    2.578088
         23  |   1.768785   .3897728     4.54   0.000      1.00403     2.53354
         24  |   1.051492   .4238633     2.48   0.013      .219849    1.883135
         25  |   .8568153   .4832514     1.77   0.076    -.0913502    1.804981
         26  |   .8091913   .2888809     2.80   0.005     .2423912    1.375991
         27  |   .8840127    .280564     3.15   0.002     .3335309    1.434495
         28  |   1.055984   .2774899     3.81   0.000     .5115338    1.600435
         29  |   1.154637   .2816255     4.10   0.000     .6020728    1.707202
         30  |   .9781052   .2929776     3.34   0.001     .4032672    1.552943
         31  |   1.178134   .2929864     4.02   0.000     .6032791     1.75299
         32  |   1.399239   .3034007     4.61   0.000     .8039504    1.994528
         33  |    1.55615    .310228     5.02   0.000     .9474655    2.164834
         34  |   1.508686   .3210704     4.70   0.000     .8787284    2.138644
         35  |   1.687556   .3270865     5.16   0.000     1.045794    2.329317
         36  |   1.637027   .3368961     4.86   0.000     .9760187    2.298036
         37  |    1.76567    .341609     5.17   0.000     1.095415    2.435925
         38  |   1.624556   .3464943     4.69   0.000     .9447157    2.304397
         39  |   1.575508   .3654459     4.31   0.000     .8584835    2.292533
         40  |   1.573208   .3774231     4.17   0.000     .8326833    2.313733
         41  |   1.488741   .3673475     4.05   0.000     .7679848    2.209496
         42  |   1.698006   .3720337     4.56   0.000     .9680552    2.427956
         43  |   1.883255   .3766474     5.00   0.000     1.144252    2.622257
         44  |    1.61003   .3971583     4.05   0.000     .8307836    2.389276
         45  |   1.912438    .392266     4.88   0.000      1.14279    2.682085
         46  |   1.819504   .4225004     4.31   0.000      .990535    2.648473
         47  |   1.979565     .41574     4.76   0.000     1.163861     2.79527
         48  |   1.885002   .4172284     4.52   0.000     1.066377    2.703627
         49  |    1.59981   .4388916     3.65   0.000     .7386809     2.46094
         50  |   1.881747   .4508847     4.17   0.000     .9970864    2.766407
             |
     age_cat |
          2  |  -.1336227   .1337906    -1.00   0.318    -.3961272    .1288818
          3  |  -.0283636   .1465795    -0.19   0.847    -.3159604    .2592333
          4  |  -.0779617   .1687949    -0.46   0.644    -.4091464    .2532231
          5  |  -.0555719   .2053842    -0.27   0.787    -.4585468     .347403
          6  |   .0246858   .2299116     0.11   0.915    -.4264133    .4757849
             |
       _cons |   5.034803   .2391477    21.05   0.000     4.565583    5.504024
-------------+----------------------------------------------------------------
     sigma_u |  1.5724534
     sigma_e |  .75524737
         rho |  .81255437   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0981838610937723

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =      5,687
Group variable: id                              Number of groups  =      1,137

R-sq:                                           Obs per group:
     within  = 0.0982                                         min =          1
     between = 0.1216                                         avg =        5.0
     overall = 0.1222                                         max =          9

                                                F(58,1136)        =       4.91
corr(u_i, Xb)  = 0.0857                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,137 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0105652   .0747946     0.14   0.888    -.1361858    .1573163
         new |    .088429   .0682303     1.30   0.195    -.0454425    .2223006
        fnew |  -.1122101   .1007734    -1.11   0.266    -.3099329    .0855127
  fnew_expat |  -.0039893   .1076849    -0.04   0.970     -.215273    .2072944
             |
    ind_year |
          2  |   -.030159   .0981346    -0.31   0.759    -.2227044    .1623864
          3  |   .6944682   .1421698     4.88   0.000     .4155233    .9734131
          4  |    .761347   .1574153     4.84   0.000     .4524897    1.070204
          5  |   1.027348    .174011     5.90   0.000     .6859291    1.368767
          6  |   1.079886   .2153253     5.02   0.000     .6574063    1.502366
          7  |   1.593425   .2370058     6.72   0.000     1.128407    2.058443
          8  |   1.752034   .2568676     6.82   0.000     1.248045    2.256022
          9  |   1.873861   .2667892     7.02   0.000     1.350406    2.397316
         10  |   1.923342   .2810355     6.84   0.000     1.371936    2.474749
         11  |   2.130753   .2935811     7.26   0.000     1.554731    2.706775
         12  |    2.13898   .3010306     7.11   0.000     1.548341    2.729618
         13  |   2.008907   .3060872     6.56   0.000     1.408347    2.609467
         14  |   1.979476   .3153754     6.28   0.000     1.360692     2.59826
         15  |    1.84293   .3194126     5.77   0.000     1.216226    2.469635
         16  |   1.933908   .3216662     6.01   0.000     1.302781    2.565034
         17  |   1.774611   .3260346     5.44   0.000     1.134914    2.414309
         18  |   1.623344   .3354002     4.84   0.000     .9652706    2.281418
         19  |   1.489205   .3466778     4.30   0.000     .8090042    2.169406
         20  |   1.597162   .3637084     4.39   0.000     .8835468    2.310778
         21  |   1.652694   .3660154     4.52   0.000     .9345514    2.370836
         22  |   1.801738   .3956821     4.55   0.000     1.025388    2.578088
         23  |   1.768785   .3897728     4.54   0.000      1.00403     2.53354
         24  |   1.051492   .4238633     2.48   0.013      .219849    1.883135
         25  |   .8568153   .4832514     1.77   0.076    -.0913502    1.804981
         26  |   .8091913   .2888809     2.80   0.005     .2423912    1.375991
         27  |   .8840127    .280564     3.15   0.002     .3335309    1.434495
         28  |   1.055984   .2774899     3.81   0.000     .5115338    1.600435
         29  |   1.154637   .2816255     4.10   0.000     .6020728    1.707202
         30  |   .9781052   .2929776     3.34   0.001     .4032672    1.552943
         31  |   1.178134   .2929864     4.02   0.000     .6032791     1.75299
         32  |   1.399239   .3034007     4.61   0.000     .8039504    1.994528
         33  |    1.55615    .310228     5.02   0.000     .9474655    2.164834
         34  |   1.508686   .3210704     4.70   0.000     .8787284    2.138644
         35  |   1.687556   .3270865     5.16   0.000     1.045794    2.329317
         36  |   1.637027   .3368961     4.86   0.000     .9760187    2.298036
         37  |    1.76567    .341609     5.17   0.000     1.095415    2.435925
         38  |   1.624556   .3464943     4.69   0.000     .9447157    2.304397
         39  |   1.575508   .3654459     4.31   0.000     .8584835    2.292533
         40  |   1.573208   .3774231     4.17   0.000     .8326833    2.313733
         41  |   1.488741   .3673475     4.05   0.000     .7679848    2.209496
         42  |   1.698006   .3720337     4.56   0.000     .9680552    2.427956
         43  |   1.883255   .3766474     5.00   0.000     1.144252    2.622257
         44  |    1.61003   .3971583     4.05   0.000     .8307836    2.389276
         45  |   1.912438    .392266     4.88   0.000      1.14279    2.682085
         46  |   1.819504   .4225004     4.31   0.000      .990535    2.648473
         47  |   1.979565     .41574     4.76   0.000     1.163861     2.79527
         48  |   1.885002   .4172284     4.52   0.000     1.066377    2.703627
         49  |    1.59981   .4388916     3.65   0.000     .7386809     2.46094
         50  |   1.881747   .4508847     4.17   0.000     .9970864    2.766407
             |
     age_cat |
          2  |  -.1336227   .1337906    -1.00   0.318    -.3961272    .1288818
          3  |  -.0283636   .1465795    -0.19   0.847    -.3159604    .2592333
          4  |  -.0779617   .1687949    -0.46   0.644    -.4091464    .2532231
          5  |  -.0555719   .2053842    -0.27   0.787    -.4585468     .347403
          6  |   .0246858   .2299116     0.11   0.915    -.4264133    .4757849
             |
       _cons |   5.034803   .2391477    21.05   0.000     4.565583    5.504024
-------------+----------------------------------------------------------------
     sigma_u |  1.5724534
     sigma_e |  .75524737
         rho |  .81255437   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.2130                                         min =          1
     between = 0.2160                                         avg =        5.2
     overall = 0.2208                                         max =          9

                                                F(58,1159)        =      11.43
corr(u_i, Xb)  = -0.0608                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0406008   .0431738     0.94   0.347    -.0441068    .1253084
         new |  -.0096917   .0471249    -0.21   0.837    -.1021513    .0827679
        fnew |   .0407339   .0639131     0.64   0.524    -.0846645    .1661323
  fnew_expat |   .2364317   .0704211     3.36   0.001     .0982646    .3745989
             |
    ind_year |
          2  |   .1186027   .0706505     1.68   0.093    -.0200145    .2572199
          3  |   .4586886   .0773531     5.93   0.000     .3069208    .6104565
          4  |   .7698466   .1161326     6.63   0.000     .5419929    .9977003
          5  |   .9881876   .1192666     8.29   0.000      .754185     1.22219
          6  |     1.2256    .132053     9.28   0.000     .9665101    1.484689
          7  |   1.306935   .1497392     8.73   0.000     1.013145    1.600725
          8  |   1.423172   .1668986     8.53   0.000     1.095715    1.750629
          9  |   1.648166   .1711742     9.63   0.000      1.31232    1.984012
         10  |    1.69576   .1835654     9.24   0.000     1.335602    2.055918
         11  |   1.906403   .1874882    10.17   0.000     1.538549    2.274258
         12  |   2.016974   .1982138    10.18   0.000     1.628076    2.405872
         13  |   2.041983   .2072332     9.85   0.000     1.635388    2.448577
         14  |   2.163583    .205199    10.54   0.000      1.76098    2.566186
         15  |   2.225339   .2111357    10.54   0.000     1.811088     2.63959
         16  |   2.310291   .2150922    10.74   0.000     1.888277    2.732304
         17  |   2.300528   .2184959    10.53   0.000     1.871836     2.72922
         18  |   2.176159    .220496     9.87   0.000     1.743543    2.608775
         19  |    2.19437     .22798     9.63   0.000      1.74707     2.64167
         20  |   2.362897   .2352688    10.04   0.000     1.901297    2.824498
         21  |   2.319762   .2444744     9.49   0.000       1.8401    2.799424
         22  |   2.477773   .2539762     9.76   0.000     1.979468    2.976077
         23  |   2.543917   .2570773     9.90   0.000     2.039528    3.048306
         24  |   2.646253   .2795798     9.47   0.000     2.097714    3.194792
         25  |   2.554247   .3040312     8.40   0.000     1.957734     3.15076
         26  |  -.7159118   .2170789    -3.30   0.001    -1.141823   -.2900003
         27  |  -.4196344    .209718    -2.00   0.046    -.8311038   -.0081649
         28  |  -.0515116   .2053525    -0.25   0.802    -.4544159    .3513927
         29  |   .2080644   .1971391     1.06   0.291     -.178725    .5948538
         30  |   .3277407   .1971565     1.66   0.097    -.0590829    .7145643
         31  |   .5311841   .2000515     2.66   0.008     .1386806    .9236877
         32  |   .7909585   .2055636     3.85   0.000       .38764    1.194277
         33  |   .9502258   .1917321     4.96   0.000     .5740451    1.326407
         34  |   1.040771   .1922396     5.41   0.000     .6635942    1.417947
         35  |   1.222449   .1901979     6.43   0.000     .8492781    1.595619
         36  |   1.251323   .1954522     6.40   0.000     .8678431    1.634803
         37  |   1.409066   .1931984     7.29   0.000     1.030008    1.788124
         38  |   1.501742    .196323     7.65   0.000     1.116554    1.886931
         39  |   1.575962    .198995     7.92   0.000     1.185531    1.966392
         40  |   1.687831   .2017529     8.37   0.000     1.291989    2.083673
         41  |   1.868081   .2139327     8.73   0.000     1.448342     2.28782
         42  |   1.924575   .2214039     8.69   0.000     1.490177    2.358972
         43  |   1.893994   .2177736     8.70   0.000      1.46672    2.321269
         44  |     1.9073   .2211815     8.62   0.000      1.47334    2.341261
         45  |   1.993338   .2252555     8.85   0.000     1.551384    2.435293
         46  |   2.002756    .230423     8.69   0.000     1.550663    2.454849
         47  |   2.158497   .2347443     9.20   0.000     1.697926    2.619068
         48  |   2.024942   .2501675     8.09   0.000      1.53411    2.515774
         49  |    2.38675   .3042027     7.85   0.000     1.789901      2.9836
         50  |   2.020494   .2606397     7.75   0.000     1.509116    2.531872
             |
     age_cat |
          2  |   .3183654   .0854846     3.72   0.000     .1506435    .4860874
          3  |   .2843746   .0848487     3.35   0.001     .1179005    .4508488
          4  |   .1904085   .0938208     2.03   0.043     .0063309    .3744862
          5  |   .0895261   .1125398     0.80   0.426    -.1312785    .3103307
          6  |  -.0232964   .1393385    -0.17   0.867    -.2966803    .2500876
             |
       _cons |   7.802204   .1543616    50.54   0.000     7.499344    8.105063
-------------+----------------------------------------------------------------
     sigma_u |  1.1469665
     sigma_e |  .51639226
         rho |  .83146118   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .212959536782159

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.2130                                         min =          1
     between = 0.2160                                         avg =        5.2
     overall = 0.2208                                         max =          9

                                                F(58,1159)        =      11.43
corr(u_i, Xb)  = -0.0608                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0406008   .0431738     0.94   0.347    -.0441068    .1253084
         new |  -.0096917   .0471249    -0.21   0.837    -.1021513    .0827679
        fnew |   .0407339   .0639131     0.64   0.524    -.0846645    .1661323
  fnew_expat |   .2364317   .0704211     3.36   0.001     .0982646    .3745989
             |
    ind_year |
          2  |   .1186027   .0706505     1.68   0.093    -.0200145    .2572199
          3  |   .4586886   .0773531     5.93   0.000     .3069208    .6104565
          4  |   .7698466   .1161326     6.63   0.000     .5419929    .9977003
          5  |   .9881876   .1192666     8.29   0.000      .754185     1.22219
          6  |     1.2256    .132053     9.28   0.000     .9665101    1.484689
          7  |   1.306935   .1497392     8.73   0.000     1.013145    1.600725
          8  |   1.423172   .1668986     8.53   0.000     1.095715    1.750629
          9  |   1.648166   .1711742     9.63   0.000      1.31232    1.984012
         10  |    1.69576   .1835654     9.24   0.000     1.335602    2.055918
         11  |   1.906403   .1874882    10.17   0.000     1.538549    2.274258
         12  |   2.016974   .1982138    10.18   0.000     1.628076    2.405872
         13  |   2.041983   .2072332     9.85   0.000     1.635388    2.448577
         14  |   2.163583    .205199    10.54   0.000      1.76098    2.566186
         15  |   2.225339   .2111357    10.54   0.000     1.811088     2.63959
         16  |   2.310291   .2150922    10.74   0.000     1.888277    2.732304
         17  |   2.300528   .2184959    10.53   0.000     1.871836     2.72922
         18  |   2.176159    .220496     9.87   0.000     1.743543    2.608775
         19  |    2.19437     .22798     9.63   0.000      1.74707     2.64167
         20  |   2.362897   .2352688    10.04   0.000     1.901297    2.824498
         21  |   2.319762   .2444744     9.49   0.000       1.8401    2.799424
         22  |   2.477773   .2539762     9.76   0.000     1.979468    2.976077
         23  |   2.543917   .2570773     9.90   0.000     2.039528    3.048306
         24  |   2.646253   .2795798     9.47   0.000     2.097714    3.194792
         25  |   2.554247   .3040312     8.40   0.000     1.957734     3.15076
         26  |  -.7159118   .2170789    -3.30   0.001    -1.141823   -.2900003
         27  |  -.4196344    .209718    -2.00   0.046    -.8311038   -.0081649
         28  |  -.0515116   .2053525    -0.25   0.802    -.4544159    .3513927
         29  |   .2080644   .1971391     1.06   0.291     -.178725    .5948538
         30  |   .3277407   .1971565     1.66   0.097    -.0590829    .7145643
         31  |   .5311841   .2000515     2.66   0.008     .1386806    .9236877
         32  |   .7909585   .2055636     3.85   0.000       .38764    1.194277
         33  |   .9502258   .1917321     4.96   0.000     .5740451    1.326407
         34  |   1.040771   .1922396     5.41   0.000     .6635942    1.417947
         35  |   1.222449   .1901979     6.43   0.000     .8492781    1.595619
         36  |   1.251323   .1954522     6.40   0.000     .8678431    1.634803
         37  |   1.409066   .1931984     7.29   0.000     1.030008    1.788124
         38  |   1.501742    .196323     7.65   0.000     1.116554    1.886931
         39  |   1.575962    .198995     7.92   0.000     1.185531    1.966392
         40  |   1.687831   .2017529     8.37   0.000     1.291989    2.083673
         41  |   1.868081   .2139327     8.73   0.000     1.448342     2.28782
         42  |   1.924575   .2214039     8.69   0.000     1.490177    2.358972
         43  |   1.893994   .2177736     8.70   0.000      1.46672    2.321269
         44  |     1.9073   .2211815     8.62   0.000      1.47334    2.341261
         45  |   1.993338   .2252555     8.85   0.000     1.551384    2.435293
         46  |   2.002756    .230423     8.69   0.000     1.550663    2.454849
         47  |   2.158497   .2347443     9.20   0.000     1.697926    2.619068
         48  |   2.024942   .2501675     8.09   0.000      1.53411    2.515774
         49  |    2.38675   .3042027     7.85   0.000     1.789901      2.9836
         50  |   2.020494   .2606397     7.75   0.000     1.509116    2.531872
             |
     age_cat |
          2  |   .3183654   .0854846     3.72   0.000     .1506435    .4860874
          3  |   .2843746   .0848487     3.35   0.001     .1179005    .4508488
          4  |   .1904085   .0938208     2.03   0.043     .0063309    .3744862
          5  |   .0895261   .1125398     0.80   0.426    -.1312785    .3103307
          6  |  -.0232964   .1393385    -0.17   0.867    -.2966803    .2500876
             |
       _cons |   7.802204   .1543616    50.54   0.000     7.499344    8.105063
-------------+----------------------------------------------------------------
     sigma_u |  1.1469665
     sigma_e |  .51639226
         rho |  .83146118   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.0449                                         min =          1
     between = 0.1078                                         avg =        5.2
     overall = 0.0922                                         max =          9

                                                F(58,1159)        =       2.49
corr(u_i, Xb)  = 0.0654                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0298148   .0194042     1.54   0.125    -.0082565    .0678862
         new |   .0381891   .0237511     1.61   0.108    -.0084109     .084789
        fnew |  -.0033783   .0312287    -0.11   0.914    -.0646494    .0578927
  fnew_expat |  -.0178059   .0348384    -0.51   0.609    -.0861593    .0505475
             |
    ind_year |
          2  |   -.056413   .0579934    -0.97   0.331    -.1701969    .0573708
          3  |  -.1081669   .0521921    -2.07   0.038    -.2105686   -.0057653
          4  |  -.1181717   .0596366    -1.98   0.048    -.2351795   -.0011639
          5  |  -.0287941   .0655774    -0.44   0.661    -.1574578    .0998695
          6  |   -.022296   .0693709    -0.32   0.748    -.1584027    .1138107
          7  |  -.0208611   .0814806    -0.26   0.798    -.1807271     .139005
          8  |  -.0932834   .0867603    -1.08   0.283    -.2635083    .0769414
          9  |  -.1611427   .0937555    -1.72   0.086    -.3450923    .0228068
         10  |  -.1233662   .0943639    -1.31   0.191    -.3085095     .061777
         11  |   -.125453   .0957771    -1.31   0.191    -.3133689     .062463
         12  |  -.1089156   .0978666    -1.11   0.266    -.3009313       .0831
         13  |  -.0908023   .1002856    -0.91   0.365     -.287564    .1059593
         14  |  -.1484141   .1041706    -1.42   0.155    -.3527982    .0559701
         15  |  -.0846325   .1068352    -0.79   0.428    -.2942446    .1249796
         16  |   -.063666   .1085619    -0.59   0.558    -.2766658    .1493338
         17  |  -.0716598   .1106386    -0.65   0.517    -.2887342    .1454146
         18  |  -.0204382   .1135474    -0.18   0.857    -.2432196    .2023432
         19  |  -.0940293   .1164716    -0.81   0.420    -.3225481    .1344895
         20  |  -.1160485    .121902    -0.95   0.341    -.3552218    .1231248
         21  |  -.2070219   .1264498    -1.64   0.102    -.4551181    .0410743
         22  |  -.1237003   .1271448    -0.97   0.331      -.37316    .1257593
         23  |  -.2050791   .1304394    -1.57   0.116    -.4610029    .0508448
         24  |  -.3039153    .139454    -2.18   0.030    -.5775258   -.0303048
         25  |  -.3480856   .1440473    -2.42   0.016    -.6307081    -.065463
         26  |   .3310895   .1127684     2.94   0.003     .1098364    .5523426
         27  |   .3164639   .1103039     2.87   0.004     .1000461    .5328816
         28  |    .216457   .1143388     1.89   0.059    -.0078772    .4407912
         29  |   .1760901   .1145759     1.54   0.125    -.0487094    .4008895
         30  |    .188012   .1154533     1.63   0.104    -.0385088    .4145328
         31  |   .1760396   .1141561     1.54   0.123    -.0479361    .4000152
         32  |   .1519084    .109802     1.38   0.167    -.0635245    .3673414
         33  |   .1209231   .1085024     1.11   0.265    -.0919599    .3338061
         34  |   .1213357   .1084856     1.12   0.264    -.0915144    .3341857
         35  |   .1017624   .1075393     0.95   0.344    -.1092311    .3127559
         36  |   .0593141   .1112162     0.53   0.594    -.1588936    .2775218
         37  |   .0704176   .1104669     0.64   0.524    -.1463199    .2871552
         38  |   .0864238    .109714     0.79   0.431    -.1288364    .3016841
         39  |   .1165972   .1103677     1.06   0.291    -.0999456      .33314
         40  |   .0908492   .1122381     0.81   0.418    -.1293634    .3110618
         41  |   .0516092   .1128705     0.46   0.648    -.1698442    .2730625
         42  |   .0030956   .1164463     0.03   0.979    -.2253735    .2315648
         43  |   .0095065   .1203854     0.08   0.937    -.2266912    .2457042
         44  |  -.0412422   .1230584    -0.34   0.738    -.2826844    .2001999
         45  |  -.0076033   .1240528    -0.06   0.951    -.2509966      .23579
         46  |  -.0469604   .1244564    -0.38   0.706    -.2911455    .1972246
         47  |  -.0297506   .1292708    -0.23   0.818    -.2833817    .2238804
         48  |   .0512323   .1352304     0.38   0.705    -.2140915    .3165561
         49  |   -.076245   .1438877    -0.53   0.596    -.3585546    .2060646
         50  |  -.0024729    .159093    -0.02   0.988    -.3146155    .3096697
             |
     age_cat |
          2  |   .0861833   .0341773     2.52   0.012     .0191271    .1532396
          3  |   .1050912   .0335153     3.14   0.002     .0393336    .1708487
          4  |   .1641991   .0414659     3.96   0.000     .0828425    .2455557
          5  |   .1391474   .0520408     2.67   0.008     .0370427    .2412522
          6  |   .1860558   .0611804     3.04   0.002      .066019    .3060926
             |
       _cons |   .3896416   .0805459     4.84   0.000     .2316094    .5476737
-------------+----------------------------------------------------------------
     sigma_u |   .4190824
     sigma_e |  .26914787
         rho |  .70798408   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0448710719327043

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.0449                                         min =          1
     between = 0.1078                                         avg =        5.2
     overall = 0.0922                                         max =          9

                                                F(58,1159)        =       2.49
corr(u_i, Xb)  = 0.0654                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0298148   .0194042     1.54   0.125    -.0082565    .0678862
         new |   .0381891   .0237511     1.61   0.108    -.0084109     .084789
        fnew |  -.0033783   .0312287    -0.11   0.914    -.0646494    .0578927
  fnew_expat |  -.0178059   .0348384    -0.51   0.609    -.0861593    .0505475
             |
    ind_year |
          2  |   -.056413   .0579934    -0.97   0.331    -.1701969    .0573708
          3  |  -.1081669   .0521921    -2.07   0.038    -.2105686   -.0057653
          4  |  -.1181717   .0596366    -1.98   0.048    -.2351795   -.0011639
          5  |  -.0287941   .0655774    -0.44   0.661    -.1574578    .0998695
          6  |   -.022296   .0693709    -0.32   0.748    -.1584027    .1138107
          7  |  -.0208611   .0814806    -0.26   0.798    -.1807271     .139005
          8  |  -.0932834   .0867603    -1.08   0.283    -.2635083    .0769414
          9  |  -.1611427   .0937555    -1.72   0.086    -.3450923    .0228068
         10  |  -.1233662   .0943639    -1.31   0.191    -.3085095     .061777
         11  |   -.125453   .0957771    -1.31   0.191    -.3133689     .062463
         12  |  -.1089156   .0978666    -1.11   0.266    -.3009313       .0831
         13  |  -.0908023   .1002856    -0.91   0.365     -.287564    .1059593
         14  |  -.1484141   .1041706    -1.42   0.155    -.3527982    .0559701
         15  |  -.0846325   .1068352    -0.79   0.428    -.2942446    .1249796
         16  |   -.063666   .1085619    -0.59   0.558    -.2766658    .1493338
         17  |  -.0716598   .1106386    -0.65   0.517    -.2887342    .1454146
         18  |  -.0204382   .1135474    -0.18   0.857    -.2432196    .2023432
         19  |  -.0940293   .1164716    -0.81   0.420    -.3225481    .1344895
         20  |  -.1160485    .121902    -0.95   0.341    -.3552218    .1231248
         21  |  -.2070219   .1264498    -1.64   0.102    -.4551181    .0410743
         22  |  -.1237003   .1271448    -0.97   0.331      -.37316    .1257593
         23  |  -.2050791   .1304394    -1.57   0.116    -.4610029    .0508448
         24  |  -.3039153    .139454    -2.18   0.030    -.5775258   -.0303048
         25  |  -.3480856   .1440473    -2.42   0.016    -.6307081    -.065463
         26  |   .3310895   .1127684     2.94   0.003     .1098364    .5523426
         27  |   .3164639   .1103039     2.87   0.004     .1000461    .5328816
         28  |    .216457   .1143388     1.89   0.059    -.0078772    .4407912
         29  |   .1760901   .1145759     1.54   0.125    -.0487094    .4008895
         30  |    .188012   .1154533     1.63   0.104    -.0385088    .4145328
         31  |   .1760396   .1141561     1.54   0.123    -.0479361    .4000152
         32  |   .1519084    .109802     1.38   0.167    -.0635245    .3673414
         33  |   .1209231   .1085024     1.11   0.265    -.0919599    .3338061
         34  |   .1213357   .1084856     1.12   0.264    -.0915144    .3341857
         35  |   .1017624   .1075393     0.95   0.344    -.1092311    .3127559
         36  |   .0593141   .1112162     0.53   0.594    -.1588936    .2775218
         37  |   .0704176   .1104669     0.64   0.524    -.1463199    .2871552
         38  |   .0864238    .109714     0.79   0.431    -.1288364    .3016841
         39  |   .1165972   .1103677     1.06   0.291    -.0999456      .33314
         40  |   .0908492   .1122381     0.81   0.418    -.1293634    .3110618
         41  |   .0516092   .1128705     0.46   0.648    -.1698442    .2730625
         42  |   .0030956   .1164463     0.03   0.979    -.2253735    .2315648
         43  |   .0095065   .1203854     0.08   0.937    -.2266912    .2457042
         44  |  -.0412422   .1230584    -0.34   0.738    -.2826844    .2001999
         45  |  -.0076033   .1240528    -0.06   0.951    -.2509966      .23579
         46  |  -.0469604   .1244564    -0.38   0.706    -.2911455    .1972246
         47  |  -.0297506   .1292708    -0.23   0.818    -.2833817    .2238804
         48  |   .0512323   .1352304     0.38   0.705    -.2140915    .3165561
         49  |   -.076245   .1438877    -0.53   0.596    -.3585546    .2060646
         50  |  -.0024729    .159093    -0.02   0.988    -.3146155    .3096697
             |
     age_cat |
          2  |   .0861833   .0341773     2.52   0.012     .0191271    .1532396
          3  |   .1050912   .0335153     3.14   0.002     .0393336    .1708487
          4  |   .1641991   .0414659     3.96   0.000     .0828425    .2455557
          5  |   .1391474   .0520408     2.67   0.008     .0370427    .2412522
          6  |   .1860558   .0611804     3.04   0.002      .066019    .3060926
             |
       _cons |   .3896416   .0805459     4.84   0.000     .2316094    .5476737
-------------+----------------------------------------------------------------
     sigma_u |   .4190824
     sigma_e |  .26914787
         rho |  .70798408   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs     =      4,378
Group variable: id                              Number of groups  =      1,035

R-sq:                                           Obs per group:
     within  = 0.0664                                         min =          1
     between = 0.0046                                         avg =        4.2
     overall = 0.0178                                         max =          8

                                                F(55,1034)        =       4.97
corr(u_i, Xb)  = -0.4685                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,035 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0828931   .0631103    -1.31   0.189    -.2067319    .0409458
         new |  -.0314626   .0728065    -0.43   0.666    -.1743279    .1114027
        fnew |  -.0435276   .0807088    -0.54   0.590    -.2018992     .114844
  fnew_expat |   .0919766   .0888114     1.04   0.301    -.0822945    .2662477
             |
    ind_year |
          3  |   .0653766   .2019004     0.32   0.746    -.3308047     .461558
          4  |   .0400123   .1898096     0.21   0.833    -.3324436    .4124683
          5  |   .1842891     .20894     0.88   0.378    -.2257057    .5942838
          6  |  -.0076551   .2071151    -0.04   0.971     -.414069    .3987587
          7  |   .0867411   .2212801     0.39   0.695    -.3474683    .5209504
          8  |   .0914584    .246634     0.37   0.711    -.3925017    .5754186
          9  |  -.1146131   .2583771    -0.44   0.657    -.6216164    .3923901
         10  |   .0814426   .2724049     0.30   0.765    -.4530868     .615972
         11  |   .4266091    .275513     1.55   0.122    -.1140193    .9672376
         12  |   .1154025   .2788669     0.41   0.679    -.4318071    .6626121
         13  |  -.0091185   .2877647    -0.03   0.975    -.5737879     .555551
         14  |    .208593   .3009038     0.69   0.488    -.3818588    .7990448
         15  |   .2593173   .3146511     0.82   0.410    -.3581102    .8767447
         16  |   .1846268   .3225368     0.57   0.567    -.4482745    .8175281
         17  |   .1471212   .3306233     0.44   0.656    -.5016479    .7958903
         18  |   .2198015   .3422562     0.64   0.521    -.4517944    .8913975
         19  |  -.0775093    .353074    -0.22   0.826    -.7703327     .615314
         20  |   .4027178   .3698291     1.09   0.276    -.3229833    1.128419
         21  |  -.0066093   .3773076    -0.02   0.986    -.7469852    .7337667
         22  |   .2825215   .4007916     0.70   0.481    -.5039361    1.068979
         23  |   .2922176   .4065452     0.72   0.472      -.50553    1.089965
         24  |  -.1335897    .462447    -0.29   0.773    -1.041031    .7738521
         25  |   .5063392    .559926     0.90   0.366    -.5923818     1.60506
         27  |  -.3306683   .3225568    -1.03   0.306    -.9636089    .3022723
         28  |  -.7627013   .3014545    -2.53   0.012    -1.354234   -.1711689
         29  |  -.5885071   .2960058    -1.99   0.047    -1.169348   -.0076666
         30  |  -.7410376   .3033394    -2.44   0.015    -1.336269   -.1458066
         31  |  -.2891111   .2891232    -1.00   0.318    -.8564463     .278224
         32  |  -.4002393   .2910045    -1.38   0.169     -.971266    .1707875
         33  |  -.3521694   .2890059    -1.22   0.223    -.9192744    .2149356
         34  |  -.6280009    .293712    -2.14   0.033     -1.20434   -.0516614
         35  |  -.1859536   .2922588    -0.64   0.525    -.7594415    .3875344
         36  |  -.2541364    .303397    -0.84   0.402    -.8494806    .3412078
         37  |   .0646836   .3005672     0.22   0.830    -.5251078    .6544749
         38  |  -.2745662   .3172048    -0.87   0.387    -.8970049    .3478724
         39  |  -.7247042   .3238146    -2.24   0.025    -1.360113   -.0892954
         40  |  -.6073473   .3259004    -1.86   0.063    -1.246849    .0321542
         41  |  -.6655528    .331288    -2.01   0.045    -1.315626   -.0154793
         42  |  -.4271175   .3422782    -1.25   0.212    -1.098757    .2445216
         43  |  -.1951395   .3498208    -0.56   0.577    -.8815792    .4913001
         44  |  -.8544555    .369741    -2.31   0.021    -1.579984   -.1289272
         45  |   -.919236   .3812962    -2.41   0.016    -1.667439   -.1710333
         46  |  -.3822808   .3935697    -0.97   0.332    -1.154567    .3900056
         47  |   -.067346   .3992628    -0.17   0.866    -.8508037    .7161117
         48  |   -.546449   .4260241    -1.28   0.200    -1.382419    .2895214
         49  |  -1.239993   .4268603    -2.90   0.004    -2.077604   -.4023812
         50  |  -.7245317   .5952413    -1.22   0.224     -1.89255     .443487
             |
     age_cat |
          3  |  -.1691624   .1420385    -1.19   0.234    -.4478791    .1095542
          4  |   -.211043   .1427289    -1.48   0.140    -.4911144    .0690283
          5  |  -.2228584   .1643112    -1.36   0.175    -.5452799    .0995631
          6  |  -.3788351   .1878208    -2.02   0.044    -.7473885   -.0102818
             |
       _cons |   .3165779   .2604075     1.22   0.224    -.1944096    .8275655
-------------+----------------------------------------------------------------
     sigma_u |   .6156898
     sigma_e |  .85267878
         rho |  .34270131   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0663901569448229

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =      4,378
Group variable: id                              Number of groups  =      1,035

R-sq:                                           Obs per group:
     within  = 0.0664                                         min =          1
     between = 0.0046                                         avg =        4.2
     overall = 0.0178                                         max =          8

                                                F(55,1034)        =       4.97
corr(u_i, Xb)  = -0.4685                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,035 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0828931   .0631103    -1.31   0.189    -.2067319    .0409458
         new |  -.0314626   .0728065    -0.43   0.666    -.1743279    .1114027
        fnew |  -.0435276   .0807088    -0.54   0.590    -.2018992     .114844
  fnew_expat |   .0919766   .0888114     1.04   0.301    -.0822945    .2662477
             |
    ind_year |
          3  |   .0653766   .2019004     0.32   0.746    -.3308047     .461558
          4  |   .0400123   .1898096     0.21   0.833    -.3324436    .4124683
          5  |   .1842891     .20894     0.88   0.378    -.2257057    .5942838
          6  |  -.0076551   .2071151    -0.04   0.971     -.414069    .3987587
          7  |   .0867411   .2212801     0.39   0.695    -.3474683    .5209504
          8  |   .0914584    .246634     0.37   0.711    -.3925017    .5754186
          9  |  -.1146131   .2583771    -0.44   0.657    -.6216164    .3923901
         10  |   .0814426   .2724049     0.30   0.765    -.4530868     .615972
         11  |   .4266091    .275513     1.55   0.122    -.1140193    .9672376
         12  |   .1154025   .2788669     0.41   0.679    -.4318071    .6626121
         13  |  -.0091185   .2877647    -0.03   0.975    -.5737879     .555551
         14  |    .208593   .3009038     0.69   0.488    -.3818588    .7990448
         15  |   .2593173   .3146511     0.82   0.410    -.3581102    .8767447
         16  |   .1846268   .3225368     0.57   0.567    -.4482745    .8175281
         17  |   .1471212   .3306233     0.44   0.656    -.5016479    .7958903
         18  |   .2198015   .3422562     0.64   0.521    -.4517944    .8913975
         19  |  -.0775093    .353074    -0.22   0.826    -.7703327     .615314
         20  |   .4027178   .3698291     1.09   0.276    -.3229833    1.128419
         21  |  -.0066093   .3773076    -0.02   0.986    -.7469852    .7337667
         22  |   .2825215   .4007916     0.70   0.481    -.5039361    1.068979
         23  |   .2922176   .4065452     0.72   0.472      -.50553    1.089965
         24  |  -.1335897    .462447    -0.29   0.773    -1.041031    .7738521
         25  |   .5063392    .559926     0.90   0.366    -.5923818     1.60506
         27  |  -.3306683   .3225568    -1.03   0.306    -.9636089    .3022723
         28  |  -.7627013   .3014545    -2.53   0.012    -1.354234   -.1711689
         29  |  -.5885071   .2960058    -1.99   0.047    -1.169348   -.0076666
         30  |  -.7410376   .3033394    -2.44   0.015    -1.336269   -.1458066
         31  |  -.2891111   .2891232    -1.00   0.318    -.8564463     .278224
         32  |  -.4002393   .2910045    -1.38   0.169     -.971266    .1707875
         33  |  -.3521694   .2890059    -1.22   0.223    -.9192744    .2149356
         34  |  -.6280009    .293712    -2.14   0.033     -1.20434   -.0516614
         35  |  -.1859536   .2922588    -0.64   0.525    -.7594415    .3875344
         36  |  -.2541364    .303397    -0.84   0.402    -.8494806    .3412078
         37  |   .0646836   .3005672     0.22   0.830    -.5251078    .6544749
         38  |  -.2745662   .3172048    -0.87   0.387    -.8970049    .3478724
         39  |  -.7247042   .3238146    -2.24   0.025    -1.360113   -.0892954
         40  |  -.6073473   .3259004    -1.86   0.063    -1.246849    .0321542
         41  |  -.6655528    .331288    -2.01   0.045    -1.315626   -.0154793
         42  |  -.4271175   .3422782    -1.25   0.212    -1.098757    .2445216
         43  |  -.1951395   .3498208    -0.56   0.577    -.8815792    .4913001
         44  |  -.8544555    .369741    -2.31   0.021    -1.579984   -.1289272
         45  |   -.919236   .3812962    -2.41   0.016    -1.667439   -.1710333
         46  |  -.3822808   .3935697    -0.97   0.332    -1.154567    .3900056
         47  |   -.067346   .3992628    -0.17   0.866    -.8508037    .7161117
         48  |   -.546449   .4260241    -1.28   0.200    -1.382419    .2895214
         49  |  -1.239993   .4268603    -2.90   0.004    -2.077604   -.4023812
         50  |  -.7245317   .5952413    -1.22   0.224     -1.89255     .443487
             |
     age_cat |
          3  |  -.1691624   .1420385    -1.19   0.234    -.4478791    .1095542
          4  |   -.211043   .1427289    -1.48   0.140    -.4911144    .0690283
          5  |  -.2228584   .1643112    -1.36   0.175    -.5452799    .0995631
          6  |  -.3788351   .1878208    -2.02   0.044    -.7473885   -.0102818
             |
       _cons |   .3165779   .2604075     1.22   0.224    -.1944096    .8275655
-------------+----------------------------------------------------------------
     sigma_u |   .6156898
     sigma_e |  .85267878
         rho |  .34270131   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
. *Szelekci az akviczis mintban
. xtset id year
       panel variable:  id (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. areg f1.expat lnL lnQ lnK exporter if ever_foreign==1&greenfield!=1, a(industry_year) cluster(frame_id)

Linear regression, absorbing indicators         Number of obs     =      4,559
Absorbed variable: industry_year                No. of categories =        960
                                                F(   4,    342)   =       9.10
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3872
                                                Adj R-squared     =     0.2231
                                                Root MSE          =     0.3485

                             (Std. Err. adjusted for 343 clusters in frame_id)
------------------------------------------------------------------------------
             |               Robust
     F.expat |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         lnL |  -.0162567   .0214646    -0.76   0.449     -.058476    .0259625
         lnQ |    .020808   .0177843     1.17   0.243    -.0141723    .0557884
         lnK |   .0253553   .0096855     2.62   0.009     .0063046     .044406
    exporter |    .083711   .0273566     3.06   0.002     .0299026    .1375194
       _cons |  -.3479184   .1675781    -2.08   0.039    -.6775319    -.018305
------------------------------------------------------------------------------

. do regram output/regression/selection 1 1

. args tablefile specname speclabel

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Linear regression, absorbing indicators         Number of obs     =      4,559
Absorbed variable: industry_year                No. of categories =        960
                                                F(   4,    342)   =       9.10
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3872
                                                Adj R-squared     =     0.2231
                                                Root MSE          =     0.3485

                             (Std. Err. adjusted for 343 clusters in frame_id)
------------------------------------------------------------------------------
             |               Robust
     F.expat |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         lnL |  -.0162567   .0214646    -0.76   0.449     -.058476    .0259625
         lnQ |    .020808   .0177843     1.17   0.243    -.0141723    .0557884
         lnK |   .0253553   .0096855     2.62   0.009     .0063046     .044406
    exporter |    .083711   .0273566     3.06   0.002     .0299026    .1375194
       _cons |  -.3479184   .1675781    -2.08   0.039    -.6775319    -.018305
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b')) _newline
  6.         file write `output' ("   standard_error: " + string(`se')) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se')) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")])) _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
. *Akvizcis minta (greenfield nlkl)
. keep if ever_foreign==1&greenfield!=1
(257,540 observations deleted)

. *Dinamika
. scalar Tbefore = 4

. scalar Tafter = 4

. 
. local N = Tbefore+Tafter+1

. 
. clonevar tenure_foreign = age_since_foreign

. 
. do event_study

. local T1 = Tbefore 

. local T2 = Tafter

. 
. foreach X in expat domestic {
  2.         gen byte `X'_p_0 = tenure==0 & (`X'==1)
  3.         forval t=1/`T1' {
  4.                 gen byte `X'_m_`t' = tenure== -`t' & (`X'==1)
  5.         }
  6.         forval t=1/`T2' {
  7.                 gen byte `X'_p_`t' = tenure== `t' & (`X'==1)
  8.         }
  9. }

. sort frame_id year

. 
. * illustrate window overlap and recoding
. l manager_id expat year tenure if frame_id=="ft10072219"

. 
end of do-file

. 
. local Tbefore = Tbefore

. local Tafter = Tafter

. 
. * t = -Tbefore will serve as benchmark
. drop *_m_`Tbefore'

. local Tbefore = Tbefore-1

. 
. foreach Y of var `scale' `intensity' {
  2.         * with firm FE, controls are years more than Tbefore before any event happens
.         xtreg `Y' *_m_? *_p_? foreign i.ind_year i.age_cat if expat!=.&greenfield!=1 & ever_foreign==1, i(id) fe vce(cluster i
> d)
  3.         preserve
  4.         clear
  5.         set obs `N'
  6.         gen t = _n-1-`Tbefore'
  7.         label var t "Time since event (year)"
  8. 
.         foreach X in expat domestic {
  9.                 gen `X'_beta=.
 10.                 gen `X'_lower=.
 11.                 gen `X'_upper=.
 12.                 forval t=-`Tbefore'/`Tafter' {
 13.                         local tag "`t'"
 14.                         if (`t'<0) {
 15.                                 local tag = -`t'
 16.                                 local tag  _m_`tag'
 17.                         }
 18.                         else {
 19.                                 local tag  _p_`t'
 20.                         }
 21.                         replace `X'_beta = _b[`X'`tag'] if t==`t'
 22.                         replace `X'_lower = `X'_beta-1.69*_se[`X'`tag'] if t==`t'
 23.                         replace `X'_upper = `X'_beta+1.69*_se[`X'`tag'] if t==`t'
 24.                 }
 25.                 label var `X'_beta "`Y'"
 26.                 label var `X'_upper "90% CI"
 27.                 label var `X'_lower "90% CI"
 28. 
.         }
 29.         label var expat_beta "New expat manager"
 30.         label var domestic_beta "New domestic manager"
 31.         * omit last event year from graph, which is winsorized
.         tw (line expat_beta domestic_beta t if t>=-Tbefore & t<Tafter, sort), scheme(538w) title(`Y') aspect(0.67)
 32.         graph export output/figure/`Y'_event_study.png, replace width(800)
 33.         
.         restore
 34. 
. }
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.1436                                         min =          1
     between = 0.1184                                         avg =        5.2
     overall = 0.1229                                         max =          9

                                                F(70,1159)        =       4.80
corr(u_i, Xb)  = -0.0525                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.1161045   .0672755    -1.73   0.085    -.2480998    .0158909
   expat_m_2 |  -.0546186   .0494041    -1.11   0.269    -.1515501     .042313
   expat_m_3 |    -.03108   .0369275    -0.84   0.400    -.1035322    .0413721
domestic_m_1 |  -.1207444   .0545136    -2.21   0.027    -.2277008    -.013788
domestic_m_2 |  -.0746474   .0397358    -1.88   0.061    -.1526096    .0033148
domestic_m_3 |  -.0502065   .0295567    -1.70   0.090    -.1081971    .0077841
   expat_p_0 |  -.2787402   .1072564    -2.60   0.009    -.4891786   -.0683019
   expat_p_1 |  -.1886645   .1136807    -1.66   0.097    -.4117074    .0343784
   expat_p_2 |  -.1484496   .1344964    -1.10   0.270    -.4123333    .1154341
   expat_p_3 |  -.1366015   .1613823    -0.85   0.397    -.4532357    .1800326
   expat_p_4 |  -.0174198    .183091    -0.10   0.924    -.3766466    .3418071
domestic_p_0 |  -.1812259   .0673527    -2.69   0.007    -.3133727   -.0490791
domestic_p_1 |  -.1662573   .0796038    -2.09   0.037     -.322441   -.0100736
domestic_p_2 |  -.1874792   .0961468    -1.95   0.051    -.3761205    .0011621
domestic_p_3 |  -.1452297   .1092303    -1.33   0.184    -.3595408    .0690815
domestic_p_4 |  -.1070857   .1169998    -0.92   0.360    -.3366408    .1224694
     foreign |  -.0629915   .0465016    -1.35   0.176    -.1542283    .0282453
             |
    ind_year |
          2  |  -.0560145   .0757756    -0.74   0.460    -.2046872    .0926583
          3  |  -.1535407   .0876305    -1.75   0.080    -.3254729    .0183914
          4  |  -.3309835     .10956    -3.02   0.003    -.5459417   -.1160254
          5  |  -.3603205   .1198658    -3.01   0.003    -.5954988   -.1251422
          6  |  -.4601473   .1405789    -3.27   0.001    -.7359648   -.1843297
          7  |  -.4944773   .1661169    -2.98   0.003    -.8204007   -.1685538
          8  |  -.4264032   .1716273    -2.48   0.013    -.7631382   -.0896682
          9  |  -.4108938   .1792215    -2.29   0.022    -.7625286    -.059259
         10  |  -.4780415   .1802777    -2.65   0.008    -.8317487   -.1243342
         11  |  -.4792381   .1749418    -2.74   0.006    -.8224762       -.136
         12  |  -.5128195   .1796684    -2.85   0.004    -.8653312   -.1603077
         13  |  -.4339006   .1787837    -2.43   0.015    -.7846765   -.0831247
         14  |  -.6405879   .1833535    -3.49   0.000     -1.00033   -.2808458
         15  |  -.5552885   .1808179    -3.07   0.002    -.9100556   -.2005213
         16  |  -.5800428   .1793052    -3.23   0.001    -.9318418   -.2282437
         17  |  -.4617104   .1796109    -2.57   0.010    -.8141092   -.1093116
         18  |  -.4405283   .1841637    -2.39   0.017    -.8018599   -.0791967
         19  |  -.5815562   .1898067    -3.06   0.002    -.9539594   -.2091531
         20  |  -.8136103   .2040479    -3.99   0.000    -1.213955   -.4132657
         21  |  -.8167791   .2146236    -3.81   0.000    -1.237873   -.3956849
         22  |  -.8602645   .2257362    -3.81   0.000    -1.303162   -.4173673
         23  |  -.9185985    .248251    -3.70   0.000     -1.40567   -.4315267
         24  |  -.8910004   .2886126    -3.09   0.002    -1.457262   -.3247387
         25  |  -.8132544   .2938634    -2.77   0.006    -1.389818   -.2366905
         26  |   1.267054    .315525     4.02   0.000       .64799    1.886118
         27  |   1.071041   .3144686     3.41   0.001     .4540494    1.688032
         28  |    .984292   .3056725     3.22   0.001     .3845585    1.584025
         29  |   .8602785   .2840839     3.03   0.003     .3029022    1.417655
         30  |   .6684483   .2625224     2.55   0.011      .153376    1.183521
         31  |   .5705635   .2560348     2.23   0.026     .0682199    1.072907
         32  |   .3650894   .2433965     1.50   0.134    -.1124578    .8426365
         33  |   .3620485   .2276628     1.59   0.112    -.0846288    .8087258
         34  |   .3731161   .2131007     1.75   0.080    -.0449901    .7912224
         35  |   .3835229   .2049027     1.87   0.061    -.0184989    .7855447
         36  |   .4498517   .2044657     2.20   0.028     .0486874    .8510161
         37  |   .4285763   .1953242     2.19   0.028     .0453478    .8118048
         38  |   .4153427   .1860905     2.23   0.026     .0502308    .7804546
         39  |    .438456    .173767     2.52   0.012     .0975229     .779389
         40  |   .3511324   .1643883     2.14   0.033     .0286004    .6736645
         41  |   .2035203   .1642655     1.24   0.216    -.1187709    .5258114
         42  |    .071442   .1571984     0.45   0.650    -.2369833    .3798673
         43  |   .0411785   .1425072     0.29   0.773    -.2384225    .3207795
         44  |   -.055959   .1327076    -0.42   0.673     -.316333    .2044151
         45  |  -.2366301   .1310575    -1.81   0.071    -.4937666    .0205063
         46  |  -.0756262   .1327056    -0.57   0.569    -.3359963    .1847438
         47  |  -.0601417   .1293745    -0.46   0.642    -.3139761    .1936926
         48  |   .1389312   .1511776     0.92   0.358    -.1576812    .4355436
         49  |  -.1484483   .1276916    -1.16   0.245    -.3989809    .1020843
         50  |          0  (omitted)
             |
     age_cat |
          2  |   .5436585   .0845409     6.43   0.000     .3777881    .7095288
          3  |   .8457095   .0983723     8.60   0.000     .6527017    1.038717
          4  |   1.157845   .1157906    10.00   0.000     .9306627    1.385028
          5  |     1.2055   .1471812     8.19   0.000     .9167283    1.494271
          6  |   1.325648   .1745117     7.60   0.000     .9832538    1.668042
             |
       _cons |   3.282241   .1645668    19.94   0.000     2.959359    3.605124
-------------+----------------------------------------------------------------
     sigma_u |  1.2010598
     sigma_e |  .58053512
         rho |  .81061613   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 9
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnL_event_study.png written in PNG format)
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      5,687
Group variable: id                              Number of groups  =      1,137

R-sq:                                           Obs per group:
     within  = 0.1421                                         min =          1
     between = 0.0175                                         avg =        5.0
     overall = 0.0232                                         max =          9

                                                F(70,1136)        =       5.53
corr(u_i, Xb)  = -0.1842                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,137 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0050868   .1077867    -0.05   0.962    -.2165701    .2063965
   expat_m_2 |   .0087274    .079788     0.11   0.913    -.1478209    .1652758
   expat_m_3 |  -.0263474   .0571027    -0.46   0.645    -.1383861    .0856913
domestic_m_1 |   .1816327   .0732055     2.48   0.013     .0379996    .3252658
domestic_m_2 |    .103094   .0567579     1.82   0.070    -.0082682    .2144561
domestic_m_3 |   .0133031   .0444867     0.30   0.765    -.0739822    .1005885
   expat_p_0 |    .056056   .1346656     0.42   0.677    -.2081652    .3202772
   expat_p_1 |    .193299   .1532427     1.26   0.207    -.1073715    .4939695
   expat_p_2 |   .3903402   .1740564     2.24   0.025     .0488322    .7318483
   expat_p_3 |   .4895609   .1986394     2.46   0.014     .0998197    .8793022
   expat_p_4 |   .5491308   .2260402     2.43   0.015     .1056277    .9926339
domestic_p_0 |   .1988449   .0870187     2.29   0.022     .0281094    .3695804
domestic_p_1 |   .3339534   .0982586     3.40   0.001     .1411647     .526742
domestic_p_2 |   .4110208   .1205525     3.41   0.001     .1744902    .6475514
domestic_p_3 |   .5889403   .1342164     4.39   0.000     .3256005    .8522802
domestic_p_4 |   .7068133   .1515343     4.66   0.000     .4094948    1.004132
     foreign |  -.0912394   .0758719    -1.20   0.229    -.2401042    .0576254
             |
    ind_year |
          2  |  -.1594996   .1158372    -1.38   0.169    -.3867786    .0677794
          3  |   .3770456   .1550549     2.43   0.015     .0728194    .6812717
          4  |   .2092563   .1691546     1.24   0.216    -.1226343    .5411469
          5  |    .349671   .1776265     1.97   0.049      .001158    .6981839
          6  |   .2068554   .2187227     0.95   0.344    -.2222904    .6360012
          7  |   .5801782   .2266483     2.56   0.011     .1354818    1.024875
          8  |   .6837047   .2339839     2.92   0.004     .2246156    1.142794
          9  |   .7336152   .2344946     3.13   0.002      .273524    1.193706
         10  |   .6212711   .2404137     2.58   0.010     .1495663    1.092976
         11  |   .7445654   .2438009     3.05   0.002     .2662147    1.222916
         12  |   .6347159   .2430071     2.61   0.009     .1579226    1.111509
         13  |   .4671841   .2351413     1.99   0.047      .005824    .9285442
         14  |   .2414677   .2328902     1.04   0.300    -.2154756    .6984109
         15  |   .0371597   .2363669     0.16   0.875    -.4266052    .5009245
         16  |   .0433594   .2333102     0.19   0.853    -.4144079    .5011266
         17  |  -.1487031   .2396796    -0.62   0.535    -.6189675    .3215612
         18  |   -.320959   .2441226    -1.31   0.189    -.7999408    .1580228
         19  |  -.7500086    .249552    -3.01   0.003    -1.239643   -.2603739
         20  |  -.9112801   .2736765    -3.33   0.001    -1.448248   -.3743119
         21  |  -.9923894   .2698164    -3.68   0.000    -1.521784    -.462995
         22  |  -1.026328   .2988957    -3.43   0.001    -1.612778   -.4398784
         23  |  -1.210226   .3106913    -3.90   0.000     -1.81982   -.6006332
         24  |  -1.936159   .3806147    -5.09   0.000    -2.682946   -1.189372
         25  |  -2.122161   .4432347    -4.79   0.000    -2.991811    -1.25251
         26  |   2.049681   .3808375     5.38   0.000     1.302457    2.796905
         27  |   1.853774   .3774991     4.91   0.000       1.1131    2.594447
         28  |   1.875076   .3459639     5.42   0.000     1.196276    2.553876
         29  |    1.74036   .3289118     5.29   0.000     1.095017    2.385703
         30  |   1.291402   .3178417     4.06   0.000     .6677788    1.915024
         31  |   1.383439   .2925733     4.73   0.000     .8093943    1.957484
         32  |   1.283976   .2869478     4.47   0.000     .7209684    1.846983
         33  |   1.353733    .273007     4.96   0.000     .8180779    1.889387
         34  |   1.195734   .2664698     4.49   0.000     .6729056    1.718562
         35  |   1.310859   .2477983     5.29   0.000      .824665    1.797052
         36  |   1.234411   .2410527     5.12   0.000     .7614526     1.70737
         37  |   1.251863   .2253247     5.56   0.000     .8097633    1.693962
         38  |   1.001545   .2229873     4.49   0.000     .5640322    1.439059
         39  |   .8973545   .2264032     3.96   0.000     .4531392     1.34157
         40  |   .6924988   .2242968     3.09   0.002     .2524162    1.132581
         41  |   .3860172   .2036938     1.90   0.058    -.0136412    .7856756
         42  |   .3933295   .1887546     2.08   0.037     .0229828    .7636763
         43  |   .4246002   .1771663     2.40   0.017     .0769902    .7722101
         44  |  -.0064225   .1832032    -0.04   0.972    -.3658771    .3530321
         45  |   .0186995   .1472389     0.13   0.899    -.2701913    .3075902
         46  |  -.0006391   .1624395    -0.00   0.997    -.3193543    .3180761
         47  |   .0626827    .153833     0.41   0.684     -.239146    .3645114
         48  |   -.035641   .1479939    -0.24   0.810    -.3260131    .2547311
         49  |  -.2664945   .1785741    -1.49   0.136    -.6168666    .0838777
         50  |          0  (omitted)
             |
     age_cat |
          2  |   .4484908   .1424334     3.15   0.002     .1690286     .727953
          3  |   .8271007   .1591792     5.20   0.000     .5147825    1.139419
          4  |   1.058506   .1894357     5.59   0.000      .686823    1.430189
          5  |   1.162618   .2267269     5.13   0.000     .7177676    1.607469
          6  |    1.36537   .2562945     5.33   0.000     .8625065    1.868234
             |
       _cons |   9.005519   .2343774    38.42   0.000     8.545657     9.46538
-------------+----------------------------------------------------------------
     sigma_u |  2.1846867
     sigma_e |  .81785888
         rho |  .87708122   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 9
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnK_event_study.png written in PNG format)
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.1947                                         min =          1
     between = 0.0412                                         avg =        5.2
     overall = 0.0511                                         max =          9

                                                F(70,1159)        =       8.97
corr(u_i, Xb)  = 0.0164                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |   .2137458   .0839064     2.55   0.011     .0491203    .3783713
   expat_m_2 |   .1805716   .0569014     3.17   0.002     .0689304    .2922129
   expat_m_3 |   .0593782   .0401905     1.48   0.140     -.019476    .1382324
domestic_m_1 |   .0765605   .0562498     1.36   0.174    -.0338024    .1869234
domestic_m_2 |   .0685652   .0441986     1.55   0.121     -.018153    .1552834
domestic_m_3 |   .0764985   .0314085     2.44   0.015     .0148747    .1381223
   expat_p_0 |   .2913132   .0999817     2.91   0.004     .0951478    .4874785
   expat_p_1 |   .5173942   .1131247     4.57   0.000     .2954421    .7393462
   expat_p_2 |   .7194163   .1230844     5.84   0.000     .4779231    .9609096
   expat_p_3 |   .8542969    .164656     5.19   0.000     .5312398    1.177354
   expat_p_4 |   1.040731   .1606378     6.48   0.000     .7255573    1.355904
domestic_p_0 |   .1523776   .0698488     2.18   0.029     .0153334    .2894218
domestic_p_1 |    .234091   .0832673     2.81   0.005     .0707194    .3974626
domestic_p_2 |   .3215736    .100942     3.19   0.001     .1235241    .5196231
domestic_p_3 |   .4496491   .1163304     3.87   0.000     .2214073     .677891
domestic_p_4 |    .539529   .1136456     4.75   0.000      .316555    .7625031
     foreign |  -.0097739   .0520216    -0.19   0.851    -.1118408    .0922931
             |
    ind_year |
          2  |  -.0235977     .08462    -0.28   0.780    -.1896232    .1424278
          3  |   .1397346   .1024986     1.36   0.173    -.0613689    .3408382
          4  |   .1876521   .1357646     1.38   0.167    -.0787198     .454024
          5  |   .2951578   .1286982     2.29   0.022     .0426502    .5476654
          6  |   .3513011    .149575     2.35   0.019      .057833    .6447692
          7  |   .3159327    .182299     1.73   0.083    -.0417403    .6736056
          8  |   .4098779   .1796111     2.28   0.023     .0574786    .7622771
          9  |   .5737119   .1818779     3.15   0.002     .2168651    .9305586
         10  |   .4684175   .1865658     2.51   0.012     .1023729     .834462
         11  |    .593585   .1749889     3.39   0.001     .2502546    .9369154
         12  |   .5933802   .1796955     3.30   0.001     .2408152    .9459451
         13  |    .619087   .1792025     3.45   0.001     .2674894    .9706847
         14  |   .4471373   .1821999     2.45   0.014     .0896587    .8046159
         15  |   .5104155   .1930395     2.64   0.008     .1316695    .8891615
         16  |   .4847289   .1849464     2.62   0.009     .1218616    .8475962
         17  |   .5048073   .1866028     2.71   0.007     .1386902    .8709244
         18  |   .3221802   .1895736     1.70   0.089    -.0497656     .694126
         19  |   .1234147   .1889613     0.65   0.514    -.2473298    .4941591
         20  |  -.0275179   .1972835    -0.14   0.889    -.4145907     .359555
         21  |  -.1677952   .2090025    -0.80   0.422    -.5778607    .2422704
         22  |  -.1262935   .2151285    -0.59   0.557    -.5483784    .2957914
         23  |  -.1971321   .2382669    -0.83   0.408    -.6646149    .2703506
         24  |   -.151467    .274153    -0.55   0.581    -.6893587    .3864247
         25  |  -.2587681   .3320474    -0.78   0.436    -.9102493    .3927131
         26  |    .558483   .3174715     1.76   0.079    -.0644003    1.181366
         27  |   .5698964   .3020425     1.89   0.059    -.0227148    1.162508
         28  |   .7657663   .2969141     2.58   0.010     .1832169    1.348316
         29  |   .8225229    .278706     2.95   0.003     .2756982    1.369348
         30  |   .6637018    .259695     2.56   0.011     .1541768    1.173227
         31  |   .6841198   .2447753     2.79   0.005     .2038676    1.164372
         32  |   .6539498   .2454638     2.66   0.008     .1723466    1.135553
         33  |   .7377042   .2247419     3.28   0.001     .2967577    1.178651
         34  |   .7637629   .2179521     3.50   0.000      .336138    1.191388
         35  |   .8619405   .2061072     4.18   0.000     .4575554    1.266326
         36  |   .8657893   .2068698     4.19   0.000     .4599082    1.271671
         37  |   .9183784   .2000039     4.59   0.000     .5259682    1.310789
         38  |   .9282248   .1911589     4.86   0.000     .5531686    1.303281
         39  |   .9363513   .1761964     5.31   0.000     .5906516    1.282051
         40  |   .8745535   .1631862     5.36   0.000     .5543801    1.194727
         41  |   .8267576   .1601778     5.16   0.000     .5124867    1.141028
         42  |   .6650266   .1599444     4.16   0.000     .3512137    .9788395
         43  |   .5138819   .1369259     3.75   0.000     .2452315    .7825322
         44  |   .3496504    .127287     2.75   0.006     .0999117    .5993892
         45  |   .1782896   .1365049     1.31   0.192    -.0895348     .446114
         46  |   .2583192   .1192729     2.17   0.031     .0243042    .4923343
         47  |   .3379113   .1029784     3.28   0.001     .1358663    .5399563
         48  |   .3282291   .1035321     3.17   0.002     .1250977    .5313605
         49  |    .311984   .0835459     3.73   0.000     .1480659    .4759021
         50  |          0  (omitted)
             |
     age_cat |
          2  |   .8661807   .1101112     7.87   0.000     .6501411     1.08222
          3  |   1.130284   .1196572     9.45   0.000     .8955149    1.365053
          4  |   1.342618   .1336105    10.05   0.000     1.080473    1.604763
          5  |   1.292084   .1646945     7.85   0.000     .9689509    1.615216
          6  |   1.300837   .1973599     6.59   0.000     .9136148     1.68806
             |
       _cons |   11.70963   .1747609    67.00   0.000     11.36675    12.05251
-------------+----------------------------------------------------------------
     sigma_u |  1.8138205
     sigma_e |  .62489507
         rho |  .89390019   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 9
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnQ_event_study.png written in PNG format)
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      5,687
Group variable: id                              Number of groups  =      1,137

R-sq:                                           Obs per group:
     within  = 0.0991                                         min =          1
     between = 0.0003                                         avg =        5.0
     overall = 0.0000                                         max =          9

                                                F(70,1136)        =       4.25
corr(u_i, Xb)  = -0.2694                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,137 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |   .0713435   .0893938     0.80   0.425    -.1040519     .246739
   expat_m_2 |   .0547548   .0700673     0.78   0.435    -.0827211    .1922308
   expat_m_3 |  -.0177461   .0515012    -0.34   0.730    -.1187943     .083302
domestic_m_1 |   .2676285    .070358     3.80   0.000     .1295822    .4056747
domestic_m_2 |   .1687986   .0528317     3.20   0.001     .0651399    .2724572
domestic_m_3 |   .0688742   .0381573     1.81   0.071    -.0059925     .143741
   expat_p_0 |   .1990917   .1199247     1.66   0.097    -.0362071    .4343905
   expat_p_1 |   .2518347   .1267599     1.99   0.047     .0031248    .5005446
   expat_p_2 |   .3902844   .1359414     2.87   0.004       .12356    .6570088
   expat_p_3 |   .5121709   .1526321     3.36   0.001     .2126984    .8116434
   expat_p_4 |   .4717521   .1888986     2.50   0.013     .1011227    .8423815
domestic_p_0 |   .3160319   .0828859     3.81   0.000     .1534052    .4786587
domestic_p_1 |   .4574473   .0988966     4.63   0.000     .2634068    .6514878
domestic_p_2 |   .5238253   .1221571     4.29   0.000     .2841465    .7635041
domestic_p_3 |   .6459709   .1367466     4.72   0.000     .3776665    .9142752
domestic_p_4 |   .6909866   .1504398     4.59   0.000     .3958155    .9861576
     foreign |  -.0221044   .0702883    -0.31   0.753    -.1600139    .1158052
             |
    ind_year |
          2  |  -.1058655   .0934953    -1.13   0.258    -.2893083    .0775773
          3  |   .5339549   .1331321     4.01   0.000     .2727424    .7951674
          4  |   .5280593   .1408288     3.75   0.000     .2517455     .804373
          5  |   .7110409   .1477802     4.81   0.000     .4210881    1.000994
          6  |   .6850642   .1785158     3.84   0.000     .3348065    1.035322
          7  |   1.116895    .194559     5.74   0.000     .7351597     1.49863
          8  |   1.201432   .2044906     5.88   0.000     .8002107    1.602654
          9  |   1.237374   .2055937     6.02   0.000     .8339885     1.64076
         10  |   1.210881   .2122732     5.70   0.000     .7943899    1.627373
         11  |   1.340925   .2106435     6.37   0.000     .9276314    1.754219
         12  |   1.270286   .2132104     5.96   0.000     .8519557    1.688616
         13  |   1.062158   .2125539     5.00   0.000     .6451157      1.4792
         14  |   .9530512   .2172079     4.39   0.000     .5268775    1.379225
         15  |   .7290762   .2207187     3.30   0.001     .2960141    1.162138
         16  |   .7395156   .2198777     3.36   0.001     .3081036    1.170928
         17  |   .5064779   .2309999     2.19   0.029     .0532436    .9597122
         18  |   .2739637   .2448939     1.12   0.264    -.2065315    .7544589
         19  |   .0538102   .2566122     0.21   0.834    -.4496769    .5572973
         20  |   .0766521   .2882907     0.27   0.790      -.48899    .6422941
         21  |   .0504693   .2908327     0.17   0.862    -.5201603     .621099
         22  |   .1131476   .3255964     0.35   0.728    -.5256902    .7519854
         23  |  -.0004357    .346425    -0.00   0.999    -.6801404    .6792689
         24  |  -.7803818   .3738129    -2.09   0.037    -1.513823   -.0469406
         25  |  -1.048919   .4390292    -2.39   0.017    -1.910318   -.1875198
         26  |   .8227655   .2926406     2.81   0.005     .2485889    1.396942
         27  |   .8214806   .2735124     3.00   0.003     .2848344    1.358127
         28  |   .9070458   .2588215     3.50   0.000     .3992238    1.414868
         29  |   .9298184   .2517524     3.69   0.000     .4358665     1.42377
         30  |   .6757046   .2515008     2.69   0.007     .1822463    1.169163
         31  |   .8044172   .2378185     3.38   0.001     .3378044     1.27103
         32  |   .9417554   .2396128     3.93   0.000     .4716222    1.411889
         33  |   1.014161    .233335     4.35   0.000     .5563454    1.471977
         34  |   .8709183   .2289735     3.80   0.000     .4216598    1.320177
         35  |   .9866021   .2209641     4.46   0.000     .5530585    1.420146
         36  |   .8551483   .2201831     3.88   0.000     .4231372     1.28716
         37  |    .911159   .2128152     4.28   0.000      .493604    1.328714
         38  |    .685766   .2099878     3.27   0.001     .2737585    1.097773
         39  |   .5622894    .218881     2.57   0.010     .1328329    .9917458
         40  |   .4701554    .217957     2.16   0.031     .0425118     .897799
         41  |   .2954995   .2011835     1.47   0.142    -.0992335    .6902326
         42  |   .4346627   .1900184     2.29   0.022     .0618363    .8074891
         43  |   .5402911   .1811163     2.98   0.003      .184931    .8956512
         44  |   .1753528   .1881835     0.93   0.352    -.1938735    .5445792
         45  |   .4003729    .170036     2.35   0.019     .0667529    .7339929
         46  |   .2282954   .1825815     1.25   0.211    -.1299395    .5865303
         47  |    .312548   .1690677     1.85   0.065    -.0191721    .6442681
         48  |    .124311   .1672818     0.74   0.458    -.2039049     .452527
         49  |  -.2147548   .1941927    -1.11   0.269    -.5957715    .1662619
         50  |          0  (omitted)
             |
     age_cat |
          2  |  -.1573868   .1362112    -1.16   0.248    -.4246405     .109867
          3  |  -.0712942   .1532485    -0.47   0.642    -.3719761    .2293876
          4  |  -.1184605   .1763527    -0.67   0.502     -.464474    .2275531
          5  |  -.0899455   .2129856    -0.42   0.673    -.5078348    .3279437
          6  |  -.0112968   .2368106    -0.05   0.962     -.475932    .4533385
             |
       _cons |   5.670548    .199617    28.41   0.000     5.278889    6.062208
-------------+----------------------------------------------------------------
     sigma_u |  1.7274993
     sigma_e |  .75588807
         rho |  .83930604   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 9
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnKL_event_study.png written in PNG format)
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.2160                                         min =          1
     between = 0.0685                                         avg =        5.2
     overall = 0.0819                                         max =          9

                                                F(70,1159)        =      10.29
corr(u_i, Xb)  = -0.0377                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |   .3298501   .0565986     5.83   0.000     .2188029    .4408974
   expat_m_2 |   .2351902   .0457679     5.14   0.000     .1453929    .3249875
   expat_m_3 |   .0904581   .0431142     2.10   0.036     .0058676    .1750487
domestic_m_1 |   .1973049   .0448522     4.40   0.000     .1093042    .2853056
domestic_m_2 |   .1432126   .0356636     4.02   0.000     .0732402     .213185
domestic_m_3 |   .1267049   .0252549     5.02   0.000     .0771546    .1762553
   expat_p_0 |   .5700534   .0808803     7.05   0.000     .4113652    .7287416
   expat_p_1 |   .7060587   .0870813     8.11   0.000      .535204    .8769133
   expat_p_2 |    .867866   .1085091     8.00   0.000     .6549696    1.080762
   expat_p_3 |   .9908984   .1211617     8.18   0.000     .7531776    1.228619
   expat_p_4 |    1.05815   .1285326     8.23   0.000     .8059678    1.310333
domestic_p_0 |   .3336035    .052315     6.38   0.000     .2309607    .4362462
domestic_p_1 |   .4003483   .0607632     6.59   0.000     .2811301    .5195665
domestic_p_2 |   .5090528   .0721267     7.06   0.000     .3675394    .6505663
domestic_p_3 |   .5948788   .0824979     7.21   0.000     .4330169    .7567406
domestic_p_4 |   .6466147   .0859483     7.52   0.000      .477983    .8152463
     foreign |   .0532177   .0379905     1.40   0.162    -.0213201    .1277555
             |
    ind_year |
          2  |   .0324168   .0681819     0.48   0.635    -.1013569    .1661905
          3  |   .2932754   .0706359     4.15   0.000     .1546869    .4318638
          4  |   .5186356   .1085186     4.78   0.000     .3057206    .7315506
          5  |   .6554783   .1040734     6.30   0.000     .4512849    .8596717
          6  |   .8114485   .1074425     7.55   0.000     .6006449    1.022252
          7  |   .8104099    .120958     6.70   0.000     .5730887    1.047731
          8  |   .8362811   .1299894     6.43   0.000     .5812402    1.091322
          9  |   .9846057   .1274494     7.73   0.000     .7345483    1.234663
         10  |    .946459   .1344018     7.04   0.000     .6827609    1.210157
         11  |   1.072823   .1339863     8.01   0.000     .8099402    1.335706
         12  |     1.1062   .1414809     7.82   0.000     .8286123    1.383787
         13  |   1.052988   .1477806     7.13   0.000     .7630402    1.342935
         14  |   1.087725   .1447132     7.52   0.000     .8037961    1.371654
         15  |   1.065704   .1516671     7.03   0.000     .7681312    1.363277
         16  |   1.064772   .1553631     6.85   0.000     .7599473    1.369596
         17  |   .9665176   .1592753     6.07   0.000     .6540175    1.279018
         18  |   .7627084   .1585362     4.81   0.000     .4516583    1.073759
         19  |   .7049709   .1649793     4.27   0.000     .3812794    1.028662
         20  |   .7860924   .1724153     4.56   0.000     .4478113    1.124374
         21  |   .6489839   .1788029     3.63   0.000     .2981703    .9997976
         22  |    .733971   .1902952     3.86   0.000     .3606093    1.107333
         23  |   .7214663   .1943296     3.71   0.000     .3401892    1.102743
         24  |   .7395334   .2197695     3.37   0.001     .3083427    1.170724
         25  |   .5544863   .2425449     2.29   0.022       .07861    1.030363
         26  |  -.7085709   .2159681    -3.28   0.001    -1.132303   -.2848387
         27  |  -.5011444   .2042332    -2.45   0.014    -.9018526   -.1004361
         28  |  -.2185256   .1968119    -1.11   0.267     -.604673    .1676219
         29  |  -.0377556    .183407    -0.21   0.837    -.3976024    .3220913
         30  |  -.0047464   .1798205    -0.03   0.979    -.3575565    .3480637
         31  |   .1135565    .176114     0.64   0.519    -.2319815    .4590945
         32  |   .2888606    .182572     1.58   0.114    -.0693481    .6470692
         33  |   .3756558   .1556952     2.41   0.016     .0701799    .6811318
         34  |   .3906469       .146     2.68   0.008     .1041931    .6771007
         35  |   .4784177   .1339563     3.57   0.000     .2155936    .7412418
         36  |   .4159377   .1328587     3.13   0.002     .1552673    .6766082
         37  |   .4898021   .1247764     3.93   0.000     .2449892    .7346151
         38  |   .5128821   .1214321     4.22   0.000     .2746307    .7511334
         39  |   .4978955   .1193721     4.17   0.000     .2636859    .7321051
         40  |   .5234212   .1155255     4.53   0.000     .2967587    .7500837
         41  |   .6232373   .1176504     5.30   0.000     .3924056     .854069
         42  |   .5935846   .1200489     4.94   0.000     .3580472    .8291221
         43  |   .4727034   .1095645     4.31   0.000     .2577364    .6876703
         44  |   .4056095   .1102017     3.68   0.000     .1893923    .6218267
         45  |   .4149198   .1116153     3.72   0.000     .1959292    .6339104
         46  |   .3339456   .1118456     2.99   0.003      .114503    .5533882
         47  |    .398053   .1052101     3.78   0.000     .1916295    .6044766
         48  |    .189298   .1469796     1.29   0.198    -.0990779     .477674
         49  |   .4604325   .1671645     2.75   0.006     .1324535    .7884114
         50  |          0  (omitted)
             |
     age_cat |
          2  |   .3225222   .0864187     3.73   0.000     .1529676    .4920768
          3  |   .2845743   .0870097     3.27   0.001     .1138602    .4552884
          4  |   .1847727   .0972064     1.90   0.058    -.0059475    .3754929
          5  |   .0865838   .1166736     0.74   0.458    -.1423314     .315499
          6  |  -.0248106   .1442054    -0.17   0.863    -.3077434    .2581222
             |
       _cons |   8.427389   .1248254    67.51   0.000      8.18248    8.672298
-------------+----------------------------------------------------------------
     sigma_u |  1.2434656
     sigma_e |  .51602902
         rho |  .85308301   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 9
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnQL_event_study.png written in PNG format)
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      6,064
Group variable: id                              Number of groups  =      1,160

R-sq:                                           Obs per group:
     within  = 0.0473                                         min =          1
     between = 0.0914                                         avg =        5.2
     overall = 0.0812                                         max =          9

                                                F(70,1159)        =       2.29
corr(u_i, Xb)  = 0.0449                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,160 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0219553   .0338501    -0.65   0.517    -.0883697    .0444591
   expat_m_2 |  -.0039684   .0259847    -0.15   0.879    -.0549508    .0470139
   expat_m_3 |  -.0044896   .0240711    -0.19   0.852    -.0517174    .0427381
domestic_m_1 |   .0142481    .025286     0.56   0.573    -.0353635    .0638596
domestic_m_2 |  -.0020577   .0202162    -0.10   0.919    -.0417221    .0376066
domestic_m_3 |   .0315991   .0163195     1.94   0.053    -.0004199    .0636182
   expat_p_0 |  -.0074353   .0399015    -0.19   0.852    -.0857226     .070852
   expat_p_1 |   .0142342   .0481313     0.30   0.767    -.0801999    .1086684
   expat_p_2 |  -.0002766   .0567412    -0.00   0.996    -.1116037    .1110504
   expat_p_3 |   .0759551   .0663749     1.14   0.253    -.0542733    .2061835
   expat_p_4 |  -.0093441   .0718319    -0.13   0.897    -.1502792    .1315911
domestic_p_0 |   .0424216   .0299463     1.42   0.157    -.0163336    .1011767
domestic_p_1 |   .0606303   .0353557     1.71   0.087     -.008738    .1299986
domestic_p_2 |    .037486   .0429059     0.87   0.382     -.046696    .1216679
domestic_p_3 |    .037535   .0489988     0.77   0.444    -.0586013    .1336712
domestic_p_4 |   .0455286     .05165     0.88   0.378    -.0558094    .1468666
     foreign |   .0289644   .0180017     1.61   0.108    -.0063552     .064284
             |
    ind_year |
          2  |  -.0547317   .0564981    -0.97   0.333    -.1655817    .0561184
          3  |  -.1082688   .0488434    -2.22   0.027    -.2041002   -.0124374
          4  |  -.1149831   .0536736    -2.14   0.032    -.2202913   -.0096748
          5  |  -.0280365   .0579692    -0.48   0.629    -.1417727    .0856998
          6  |  -.0194855    .059067    -0.33   0.742    -.1353757    .0964047
          7  |  -.0171694   .0673529    -0.25   0.799    -.1493167    .1149779
          8  |  -.0910303   .0696354    -1.31   0.191    -.2276559    .0455954
          9  |  -.1564548   .0740955    -2.11   0.035    -.3018311   -.0110785
         10  |  -.1225985     .07291    -1.68   0.093    -.2656489    .0204519
         11  |  -.1224656   .0730209    -1.68   0.094    -.2657336    .0208024
         12  |   -.105714   .0744073    -1.42   0.156     -.251702     .040274
         13  |  -.0851325   .0774855    -1.10   0.272      -.23716     .066895
         14  |  -.1448764   .0792942    -1.83   0.068    -.3004526    .0106998
         15  |  -.0811114   .0801036    -1.01   0.311    -.2382758    .0760529
         16  |  -.0606105   .0823059    -0.74   0.462    -.2220958    .1008748
         17  |  -.0666939   .0860866    -0.77   0.439     -.235597    .1022091
         18  |  -.0154714    .089243    -0.17   0.862    -.1905673    .1596245
         19  |  -.0884905    .094176    -0.94   0.348     -.273265     .096284
         20  |   -.112509   .1014251    -1.11   0.268    -.3115064    .0864884
         21  |  -.2030071   .1072239    -1.89   0.059    -.4133818    .0073676
         22  |  -.1172286   .1081356    -1.08   0.279     -.329392    .0949349
         23  |  -.1985642   .1180391    -1.68   0.093    -.4301585    .0330301
         24  |  -.2956162   .1242894    -2.38   0.018    -.5394736   -.0517589
         25  |   -.340708   .1309227    -2.60   0.009    -.5975801   -.0838359
         26  |   .3293688   .1125825     2.93   0.004     .1084805    .5502571
         27  |   .3180051   .1075822     2.96   0.003     .1069275    .5290828
         28  |   .2177268   .1091128     2.00   0.046      .003646    .4318076
         29  |   .1779344   .1069508     1.66   0.096    -.0319043    .3877732
         30  |   .1902752   .1052558     1.81   0.071    -.0162379    .3967884
         31  |   .1799099     .10119     1.78   0.076    -.0186261     .378446
         32  |   .1530078   .0929223     1.65   0.100    -.0293068    .3353225
         33  |   .1249149   .0877397     1.42   0.155    -.0472315    .2970613
         34  |   .1233955   .0846481     1.46   0.145    -.0426852    .2894762
         35  |   .1053625   .0789792     1.33   0.182    -.0495957    .2603207
         36  |   .0585479   .0809814     0.72   0.470    -.1003387    .2174345
         37  |   .0748801    .078315     0.96   0.339    -.0787749    .2285351
         38  |   .0923938   .0774053     1.19   0.233    -.0594763    .2442639
         39  |   .1222099    .074555     1.64   0.101     -.024068    .2684878
         40  |   .0941266   .0766217     1.23   0.220    -.0562063    .2444594
         41  |   .0550595   .0770547     0.71   0.475    -.0961228    .2062418
         42  |    .007219   .0765001     0.09   0.925    -.1428753    .1573133
         43  |   .0152705     .07581     0.20   0.840    -.1334697    .1640106
         44  |  -.0381467   .0788135    -0.48   0.628    -.1927799    .1164864
         45  |    .000912   .0805976     0.01   0.991    -.1572215    .1590455
         46  |  -.0417042   .0836173    -0.50   0.618    -.2057624    .1223539
         47  |  -.0209268   .0842363    -0.25   0.804    -.1861994    .1443459
         48  |   .0525561   .0898384     0.59   0.559    -.1237079    .2288202
         49  |  -.0658223   .0589555    -1.12   0.264    -.1814938    .0498493
         50  |          0  (omitted)
             |
     age_cat |
          2  |   .0814129   .0345164     2.36   0.019     .0136913    .1491345
          3  |   .0956758   .0349444     2.74   0.006     .0271145    .1642371
          4  |   .1629744   .0437242     3.73   0.000     .0771869    .2487618
          5  |   .1381187   .0543268     2.54   0.011     .0315288    .2447087
          6  |   .1846058    .064217     2.87   0.004     .0586112    .3106004
             |
       _cons |   .3737548   .0672473     5.56   0.000     .2418147    .5056949
-------------+----------------------------------------------------------------
     sigma_u |  .42246923
     sigma_e |   .2691423
         rho |  .71130956   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 9
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/exporter_event_study.png written in PNG format)
note: expat_p_4 omitted because of collinearity
note: domestic_p_4 omitted because of collinearity
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      4,378
Group variable: id                              Number of groups  =      1,035

R-sq:                                           Obs per group:
     within  = 0.0682                                         min =          1
     between = 0.0028                                         avg =        4.2
     overall = 0.0177                                         max =          8

                                                F(65,1034)        =       4.58
corr(u_i, Xb)  = -0.5046                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 1,035 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |   .2846469   .1620965     1.76   0.079    -.0334287    .6027226
   expat_m_2 |    .229985   .1769878     1.30   0.194    -.1173113    .5772813
   expat_m_3 |   .3735049    .191633     1.95   0.052    -.0025291    .7495389
domestic_m_1 |    .254493   .1374563     1.85   0.064    -.0152321    .5242182
domestic_m_2 |   .2133235   .1550112     1.38   0.169    -.0908488    .5174959
domestic_m_3 |   .2776293   .1758893     1.58   0.115    -.0675114      .62277
   expat_p_0 |   .2072399    .144488     1.43   0.152    -.0762831     .490763
   expat_p_1 |   .2411453    .143008     1.69   0.092    -.0394736    .5217643
   expat_p_2 |    .281848    .145585     1.94   0.053    -.0038278    .5675238
   expat_p_3 |   .2774511   .1488087     1.86   0.063    -.0145504    .5694526
   expat_p_4 |          0  (omitted)
domestic_p_0 |   .1631834   .1172051     1.39   0.164    -.0668035    .3931703
domestic_p_1 |   .0763659   .0969718     0.79   0.431     -.113918    .2666498
domestic_p_2 |    .075774   .0774446     0.98   0.328    -.0761924    .2277405
domestic_p_3 |   .0542667    .061434     0.88   0.377    -.0662829    .1748162
domestic_p_4 |          0  (omitted)
     foreign |  -.0948234    .058331    -1.63   0.104    -.2092842    .0196373
             |
    ind_year |
          3  |   .0993141   .1963476     0.51   0.613    -.2859712    .4845993
          4  |   .1055596   .1808824     0.58   0.560    -.2493788    .4604979
          5  |   .2800254   .1963068     1.43   0.154    -.1051797    .6652304
          6  |   .1153417   .1913019     0.60   0.547    -.2600426    .4907261
          7  |   .2403636   .2030291     1.18   0.237    -.1580325    .6387597
          8  |   .2751583   .2238048     1.23   0.219     -.164005    .7143217
          9  |    .101897   .2333124     0.44   0.662    -.3559227    .5597167
         10  |    .323974   .2438714     1.33   0.184    -.1545654    .8025133
         11  |   .7108647   .2525383     2.81   0.005     .2153188    1.206411
         12  |   .4201348   .2603243     1.61   0.107    -.0906894     .930959
         13  |   .3255414   .2708214     1.20   0.230    -.2058808    .8569637
         14  |   .5706043   .2872473     1.99   0.047     .0069502    1.134258
         15  |   .6525396   .3023369     2.16   0.031     .0592757    1.245803
         16  |   .6053211   .3206249     1.89   0.059    -.0238287    1.234471
         17  |   .5997943   .3363669     1.78   0.075    -.0602453    1.259834
         18  |   .7063844   .3571458     1.98   0.048     .0055711    1.407198
         19  |   .4371101   .3779793     1.16   0.248    -.3045839    1.178804
         20  |   .9397868   .4045892     2.32   0.020     .1458773    1.733696
         21  |   .5637668   .4230314     1.33   0.183    -.2663311    1.393865
         22  |   .8902277   .4545566     1.96   0.050    -.0017309    1.782186
         23  |   .9238788   .4755484     1.94   0.052    -.0092712    1.857029
         24  |   .5341737   .5355128     1.00   0.319    -.5166421    1.584989
         25  |   1.205806   .6211883     1.94   0.053    -.0131278    2.424739
         27  |  -.3276042   .3236633    -1.01   0.312     -.962716    .3075077
         28  |  -.7270599   .2925049    -2.49   0.013    -1.301031    -.153089
         29  |  -.5176021   .2792138    -1.85   0.064    -1.065492    .0302883
         30  |   -.639782    .281261    -2.27   0.023    -1.191689   -.0878745
         31  |  -.1507882   .2591226    -0.58   0.561    -.6592542    .3576779
         32  |  -.2360171   .2571704    -0.92   0.359    -.7406526    .2686183
         33  |  -.1597175   .2508557    -0.64   0.524    -.6519619    .3325268
         34  |  -.4138121   .2514202    -1.65   0.100    -.9071641    .0795398
         35  |   .0472901   .2523286     0.19   0.851    -.4478445    .5424247
         36  |   .0279218   .2599002     0.11   0.914    -.4820701    .5379138
         37  |   .3732494   .2649619     1.41   0.159    -.1466749    .8931738
         38  |   .0650156   .2776867     0.23   0.815    -.4798782    .6099093
         39  |  -.3609929   .2877921    -1.25   0.210     -.925716    .2037303
         40  |   -.215721    .300057    -0.72   0.472    -.8045112    .3730692
         41  |  -.2552181   .3111854    -0.82   0.412    -.8658451    .3554089
         42  |     .01541   .3256007     0.05   0.962    -.6235036    .6543236
         43  |   .2894885   .3356667     0.86   0.389    -.3691772    .9481541
         44  |  -.3472806   .3484378    -1.00   0.319    -1.031006    .3364452
         45  |  -.3725166   .3695588    -1.01   0.314    -1.097687    .3526542
         46  |   .1807453   .3998529     0.45   0.651    -.6038705    .9653611
         47  |   .5298112   .3965642     1.34   0.182    -.2483512    1.307974
         48  |   .0698165   .4088229     0.17   0.864    -.7324007    .8720338
         49  |  -.5665397   .3518584    -1.61   0.108    -1.256978    .1238982
         50  |          0  (omitted)
             |
     age_cat |
          3  |   -.179849   .1435516    -1.25   0.211    -.4615347    .1018367
          4  |  -.2255742   .1476445    -1.53   0.127    -.5152913    .0641429
          5  |  -.2293663   .1689701    -1.36   0.175    -.5609296     .102197
          6  |  -.3857018   .1921329    -2.01   0.045    -.7627166    -.008687
             |
       _cons |  -.1708619   .3439173    -0.50   0.619    -.8457174    .5039936
-------------+----------------------------------------------------------------
     sigma_u |  .64363308
     sigma_e |  .85315237
         rho |  .36271058   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 9
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(9 missing values generated)
(9 missing values generated)
(9 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/inv_event_study.png written in PNG format)

. 
. 
. 
. log close
      name:  <unnamed>
       log:  /Volumes/Projects3/workspace/expat-analysis/output/estimate.log
  log type:  text
 closed on:  20 Nov 2018, 11:33:36
--------------------------------------------------------------------------------------------------------------------------------
