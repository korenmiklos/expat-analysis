--------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/estimate.log
  log type:  text
 opened on:  28 Nov 2018, 17:32:26

. 
. use temp/analysis_sample

. 
. *Dinamika
. scalar Tbefore = 4

. scalar Tduring = 6

. scalar Tafter = 4

. 
. gen byte analysis_window = (tenure>=-Tbefore)&(year-first_exit_year<=Tafter)

. 
. local sample_baseline analysis_window

. local sample_manufacturing `sample_baseline' & manufacturing==1

. local sample_acquisitions `sample_baseline' & greenfield==0

. 
. local samples baseline manufacturing acquisitions

. 
. local scale lnL lnK lnQ

. local intensity lnKL lnQL exporter inv

. 
. egen person_tag = tag(frame_id manager_id)

. egen N = sum(person_tag), by(frame_id)

. gen inverse_weight = 1/N

. 
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. foreach sample in `samples' {
  2.         foreach group in scale intensity {
  3.                 foreach X of var ``group'' {
  4.                         xtreg `X' foreign during after during_expat after_expat i.ind_year i.age_cat if `sample_`sample'' [
> aw=inverse_weight], i(firm_person ) fe vce(cluster id)
  5.                         local r2_w = `e(r2_w)'
  6.                         do regram output/regression/`sample'_`group' `X' `X' R2_within "`r2_w'"
  7.                 }
  8.         }
  9. }

Fixed-effects (within) regression               Number of obs      =    353439
Group variable: firm_person                     Number of groups   =     41042

R-sq:  within  = 0.1006                         Obs per group: min =         1
       between = 0.0499                                        avg =       8.6
       overall = 0.0600                                        max =        18

                                                F(78,13202)        =     34.90
corr(u_i, Xb)  = -0.1745                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0422276   .0322076     1.31   0.190    -.0209039    .1053592
      during |  -.0699004   .0087085    -8.03   0.000    -.0869703   -.0528305
       after |  -.1433004   .0160948    -8.90   0.000    -.1748486   -.1117523
during_expat |   .0798508   .0170086     4.69   0.000     .0465115      .11319
 after_expat |   .1846513   .0252688     7.31   0.000     .1351209    .2341817
             |
    ind_year |
          2  |  -.2305549   .0273282    -8.44   0.000    -.2841222   -.1769877
          3  |  -.3987425   .0387044   -10.30   0.000    -.4746086   -.3228763
          4  |  -.5469139   .0441221   -12.40   0.000    -.6333996   -.4604281
          5  |  -.6765232   .0492443   -13.74   0.000     -.773049   -.5799973
          6  |  -.7884508   .0530419   -14.86   0.000    -.8924206   -.6844811
          7  |  -.8796319   .0563862   -15.60   0.000     -.990157   -.7691069
          8  |   -.958642   .0608678   -15.75   0.000    -1.077952   -.8393325
          9  |  -1.039553   .0653027   -15.92   0.000    -1.167556   -.9115507
         10  |  -1.116609    .069094   -16.16   0.000    -1.252043    -.981175
         11  |  -1.236886   .0724603   -17.07   0.000    -1.378918   -1.094853
         12  |  -1.302213   .0756155   -17.22   0.000     -1.45043   -1.153995
         13  |  -1.391435   .0786888   -17.68   0.000    -1.545677   -1.237194
         14  |   -1.44557   .0817098   -17.69   0.000    -1.605733   -1.285407
         15  |  -1.497368   .0847821   -17.66   0.000    -1.663554   -1.331183
         16  |  -1.560926   .0877882   -17.78   0.000    -1.733003   -1.388848
         17  |  -1.615519   .0906454   -17.82   0.000    -1.793197   -1.437841
         18  |  -1.692811   .0932133   -18.16   0.000    -1.875522   -1.510099
         19  |  -1.761032   .0958866   -18.37   0.000    -1.948984   -1.573081
         20  |  -1.814967   .0982488   -18.47   0.000    -2.007549   -1.622385
         21  |  -1.885976    .100727   -18.72   0.000    -2.083416   -1.688537
         22  |  -1.939749   .1030964   -18.81   0.000    -2.141832   -1.737665
         23  |  -1.969131   .1053681   -18.69   0.000    -2.175667   -1.762594
         24  |  -2.001276   .1079247   -18.54   0.000    -2.212824   -1.789728
         25  |  -2.010488   .1106861   -18.16   0.000    -2.227449   -1.793527
         26  |   .7960054   .0838644     9.49   0.000      .631619    .9603918
         27  |   .5160483   .0803814     6.42   0.000     .3584891    .6736074
         28  |   .3243452    .078312     4.14   0.000     .1708423     .477848
         29  |   .1577206   .0771671     2.04   0.041     .0064621    .3089792
         30  |   .0373315   .0755732     0.49   0.621    -.1108029    .1854659
         31  |  -.0813277   .0763081    -1.07   0.287    -.2309025    .0682471
         32  |  -.1846062   .0768592    -2.40   0.016    -.3352613    -.033951
         33  |  -.2791512   .0773066    -3.61   0.000    -.4306832   -.1276192
         34  |  -.3602539   .0787573    -4.57   0.000    -.5146295   -.2058783
         35  |  -.4356672   .0805122    -5.41   0.000    -.5934826   -.2778517
         36  |  -.5497126   .0825169    -6.66   0.000    -.7114575   -.3879676
         37  |  -.6535336   .0846049    -7.72   0.000    -.8193714   -.4876957
         38  |  -.7669526   .0871653    -8.80   0.000    -.9378091    -.596096
         39  |  -.8602783   .0898167    -9.58   0.000    -1.036332   -.6842247
         40  |  -.9186947   .0922526    -9.96   0.000    -1.099523   -.7378664
         41  |  -.9608104   .0943301   -10.19   0.000    -1.145711   -.7759098
         42  |  -1.027118   .0970366   -10.58   0.000    -1.217324   -.8369125
         43  |  -1.180584   .0999004   -11.82   0.000    -1.376403    -.984765
         44  |  -1.250941   .1030062   -12.14   0.000    -1.452848   -1.049034
         45  |  -1.262467   .1053357   -11.99   0.000     -1.46894   -1.055994
         46  |  -1.304404   .1080566   -12.07   0.000    -1.516211   -1.092598
         47  |  -1.339409   .1102807   -12.15   0.000    -1.555575   -1.123243
         48  |  -1.363672   .1127766   -12.09   0.000     -1.58473   -1.142614
         49  |  -1.375154   .1152471   -11.93   0.000    -1.601055   -1.149254
         50  |   -1.37848   .1178079   -11.70   0.000      -1.6094    -1.14756
             |
     age_cat |
          1  |   .4820721   .0227421    21.20   0.000     .4374944    .5266498
          2  |   .8853804   .0270459    32.74   0.000     .8323666    .9383942
          3  |     1.1395   .0309193    36.85   0.000     1.078893    1.200106
          4  |    1.34635   .0344379    39.09   0.000     1.278847    1.413854
          5  |   1.521075   .0376282    40.42   0.000     1.447319    1.594832
          6  |   1.657808   .0409181    40.52   0.000     1.577603    1.738013
          7  |   1.773196   .0441939    40.12   0.000      1.68657    1.859823
          8  |   1.877565   .0477322    39.34   0.000     1.784003    1.971127
          9  |   1.962215   .0511035    38.40   0.000     1.862045    2.062386
         10  |   2.023682   .0545625    37.09   0.000     1.916731    2.130632
         11  |   2.106149   .0581334    36.23   0.000     1.992199    2.220099
         12  |    2.16962   .0613536    35.36   0.000     2.049358    2.289881
         13  |   2.238831   .0646548    34.63   0.000     2.112098    2.365563
         14  |   2.282097   .0680318    33.54   0.000     2.148744    2.415449
         15  |   2.324486   .0713627    32.57   0.000     2.184605    2.464367
         16  |   2.367727   .0749013    31.61   0.000     2.220909    2.514544
         17  |   2.413257   .0784274    30.77   0.000     2.259528    2.566986
         18  |   2.451706   .0817395    29.99   0.000     2.291485    2.611927
         19  |     2.4925   .0853226    29.21   0.000     2.325255    2.659744
         20  |   2.537011   .0912627    27.80   0.000     2.358123    2.715899
         25  |   2.566054   .1012678    25.34   0.000     2.367555    2.764554
         30  |   2.472905   .1244378    19.87   0.000     2.228989    2.716821
         40  |   2.362827    .140501    16.82   0.000     2.087425    2.638229
         50  |   2.429505   .1539528    15.78   0.000     2.127736    2.731275
             |
       _cons |   3.232835   .0608215    53.15   0.000     3.113616    3.352054
-------------+----------------------------------------------------------------
     sigma_u |  1.3815038
     sigma_e |  .66361286
         rho |  .81251841   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1005798381221582

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    353,439
Group variable: firm_person                     Number of groups  =     41,042

R-sq:                                           Obs per group:
     within  = 0.1006                                         min =          1
     between = 0.0499                                         avg =        8.6
     overall = 0.0600                                         max =         18

                                                F(78,13202)       =      34.90
corr(u_i, Xb)  = -0.1745                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0422276   .0322076     1.31   0.190    -.0209039    .1053592
      during |  -.0699004   .0087085    -8.03   0.000    -.0869703   -.0528305
       after |  -.1433004   .0160948    -8.90   0.000    -.1748486   -.1117523
during_expat |   .0798508   .0170086     4.69   0.000     .0465115      .11319
 after_expat |   .1846513   .0252688     7.31   0.000     .1351209    .2341817
             |
    ind_year |
          2  |  -.2305549   .0273282    -8.44   0.000    -.2841222   -.1769877
          3  |  -.3987425   .0387044   -10.30   0.000    -.4746086   -.3228763
          4  |  -.5469139   .0441221   -12.40   0.000    -.6333996   -.4604281
          5  |  -.6765232   .0492443   -13.74   0.000     -.773049   -.5799973
          6  |  -.7884508   .0530419   -14.86   0.000    -.8924206   -.6844811
          7  |  -.8796319   .0563862   -15.60   0.000     -.990157   -.7691069
          8  |   -.958642   .0608678   -15.75   0.000    -1.077952   -.8393325
          9  |  -1.039553   .0653027   -15.92   0.000    -1.167556   -.9115507
         10  |  -1.116609    .069094   -16.16   0.000    -1.252043    -.981175
         11  |  -1.236886   .0724603   -17.07   0.000    -1.378918   -1.094853
         12  |  -1.302213   .0756155   -17.22   0.000     -1.45043   -1.153995
         13  |  -1.391435   .0786888   -17.68   0.000    -1.545677   -1.237194
         14  |   -1.44557   .0817098   -17.69   0.000    -1.605733   -1.285407
         15  |  -1.497368   .0847821   -17.66   0.000    -1.663554   -1.331183
         16  |  -1.560926   .0877882   -17.78   0.000    -1.733003   -1.388848
         17  |  -1.615519   .0906454   -17.82   0.000    -1.793197   -1.437841
         18  |  -1.692811   .0932133   -18.16   0.000    -1.875522   -1.510099
         19  |  -1.761032   .0958866   -18.37   0.000    -1.948984   -1.573081
         20  |  -1.814967   .0982488   -18.47   0.000    -2.007549   -1.622385
         21  |  -1.885976    .100727   -18.72   0.000    -2.083416   -1.688537
         22  |  -1.939749   .1030964   -18.81   0.000    -2.141832   -1.737665
         23  |  -1.969131   .1053681   -18.69   0.000    -2.175667   -1.762594
         24  |  -2.001276   .1079247   -18.54   0.000    -2.212824   -1.789728
         25  |  -2.010488   .1106861   -18.16   0.000    -2.227449   -1.793527
         26  |   .7960054   .0838644     9.49   0.000      .631619    .9603918
         27  |   .5160483   .0803814     6.42   0.000     .3584891    .6736074
         28  |   .3243452    .078312     4.14   0.000     .1708423     .477848
         29  |   .1577206   .0771671     2.04   0.041     .0064621    .3089792
         30  |   .0373315   .0755732     0.49   0.621    -.1108029    .1854659
         31  |  -.0813277   .0763081    -1.07   0.287    -.2309025    .0682471
         32  |  -.1846062   .0768592    -2.40   0.016    -.3352613    -.033951
         33  |  -.2791512   .0773066    -3.61   0.000    -.4306832   -.1276192
         34  |  -.3602539   .0787573    -4.57   0.000    -.5146295   -.2058783
         35  |  -.4356672   .0805122    -5.41   0.000    -.5934826   -.2778517
         36  |  -.5497126   .0825169    -6.66   0.000    -.7114575   -.3879676
         37  |  -.6535336   .0846049    -7.72   0.000    -.8193714   -.4876957
         38  |  -.7669526   .0871653    -8.80   0.000    -.9378091    -.596096
         39  |  -.8602783   .0898167    -9.58   0.000    -1.036332   -.6842247
         40  |  -.9186947   .0922526    -9.96   0.000    -1.099523   -.7378664
         41  |  -.9608104   .0943301   -10.19   0.000    -1.145711   -.7759098
         42  |  -1.027118   .0970366   -10.58   0.000    -1.217324   -.8369125
         43  |  -1.180584   .0999004   -11.82   0.000    -1.376403    -.984765
         44  |  -1.250941   .1030062   -12.14   0.000    -1.452848   -1.049034
         45  |  -1.262467   .1053357   -11.99   0.000     -1.46894   -1.055994
         46  |  -1.304404   .1080566   -12.07   0.000    -1.516211   -1.092598
         47  |  -1.339409   .1102807   -12.15   0.000    -1.555575   -1.123243
         48  |  -1.363672   .1127766   -12.09   0.000     -1.58473   -1.142614
         49  |  -1.375154   .1152471   -11.93   0.000    -1.601055   -1.149254
         50  |   -1.37848   .1178079   -11.70   0.000      -1.6094    -1.14756
             |
     age_cat |
          1  |   .4820721   .0227421    21.20   0.000     .4374944    .5266498
          2  |   .8853804   .0270459    32.74   0.000     .8323666    .9383942
          3  |     1.1395   .0309193    36.85   0.000     1.078893    1.200106
          4  |    1.34635   .0344379    39.09   0.000     1.278847    1.413854
          5  |   1.521075   .0376282    40.42   0.000     1.447319    1.594832
          6  |   1.657808   .0409181    40.52   0.000     1.577603    1.738013
          7  |   1.773196   .0441939    40.12   0.000      1.68657    1.859823
          8  |   1.877565   .0477322    39.34   0.000     1.784003    1.971127
          9  |   1.962215   .0511035    38.40   0.000     1.862045    2.062386
         10  |   2.023682   .0545625    37.09   0.000     1.916731    2.130632
         11  |   2.106149   .0581334    36.23   0.000     1.992199    2.220099
         12  |    2.16962   .0613536    35.36   0.000     2.049358    2.289881
         13  |   2.238831   .0646548    34.63   0.000     2.112098    2.365563
         14  |   2.282097   .0680318    33.54   0.000     2.148744    2.415449
         15  |   2.324486   .0713627    32.57   0.000     2.184605    2.464367
         16  |   2.367727   .0749013    31.61   0.000     2.220909    2.514544
         17  |   2.413257   .0784274    30.77   0.000     2.259528    2.566986
         18  |   2.451706   .0817395    29.99   0.000     2.291485    2.611927
         19  |     2.4925   .0853226    29.21   0.000     2.325255    2.659744
         20  |   2.537011   .0912627    27.80   0.000     2.358123    2.715899
         25  |   2.566054   .1012678    25.34   0.000     2.367555    2.764554
         30  |   2.472905   .1244378    19.87   0.000     2.228989    2.716821
         40  |   2.362827    .140501    16.82   0.000     2.087425    2.638229
         50  |   2.429505   .1539528    15.78   0.000     2.127736    2.731275
             |
       _cons |   3.232835   .0608215    53.15   0.000     3.113616    3.352054
-------------+----------------------------------------------------------------
     sigma_u |  1.3815038
     sigma_e |  .66361286
         rho |  .81251841   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    321732
Group variable: firm_person                     Number of groups   =     40319

R-sq:  within  = 0.0914                         Obs per group: min =         1
       between = 0.1092                                        avg =       8.0
       overall = 0.0900                                        max =        18

                                                F(78,12800)        =     33.15
corr(u_i, Xb)  = 0.1106                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 12,801 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1327758   .0485897     2.73   0.006     .0375327    .2280189
      during |  -.0460723   .0123537    -3.73   0.000    -.0702874   -.0218572
       after |  -.0890898   .0220299    -4.04   0.000    -.1322717    -.045908
during_expat |  -.0873996   .0249584    -3.50   0.000    -.1363218   -.0384774
 after_expat |  -.1070998   .0353406    -3.03   0.002    -.1763727    -.037827
             |
    ind_year |
          2  |    -.16528   .0473823    -3.49   0.000    -.2581563   -.0724036
          3  |   .1326998   .0603903     2.20   0.028     .0143257    .2510738
          4  |   .1284202   .0672633     1.91   0.056    -.0034259    .2602663
          5  |   .1747883   .0763893     2.29   0.022     .0250539    .3245228
          6  |   .2818976   .0808447     3.49   0.000     .1234299    .4403653
          7  |   .4339102   .0868646     5.00   0.000     .2636426    .6041777
          8  |   .5076183   .0925624     5.48   0.000     .3261823    .6890544
          9  |    .595454   .0986674     6.03   0.000     .4020511    .7888569
         10  |    .648905   .1028086     6.31   0.000     .4473849    .8504251
         11  |   .6705587    .107766     6.22   0.000     .4593212    .8817962
         12  |   .6628176   .1138346     5.82   0.000     .4396848    .8859505
         13  |   .6659425   .1193183     5.58   0.000     .4320607    .8998242
         14  |   .6572855   .1245512     5.28   0.000     .4131466    .9014243
         15  |   .6104472   .1300259     4.69   0.000      .355577    .8653175
         16  |    .614585   .1354319     4.54   0.000     .3491182    .8800518
         17  |   .6218079   .1406918     4.42   0.000     .3460309    .8975849
         18  |   .5902593   .1462394     4.04   0.000     .3036083    .8769103
         19  |   .5092829    .151098     3.37   0.001     .2131082    .8054576
         20  |   .4853901   .1560288     3.11   0.002     .1795504    .7912299
         21  |     .49003   .1609055     3.05   0.002     .1746311    .8054288
         22  |   .4839908    .165416     2.93   0.003     .1597507    .8082309
         23  |   .5495606    .170003     3.23   0.001     .2163293    .8827919
         24  |   .0254407   .1755495     0.14   0.885    -.3186625    .3695438
         25  |   .0732641   .1827275     0.40   0.688    -.2849091    .4314373
         26  |   .9524461   .1185542     8.03   0.000     .7200622     1.18483
         27  |   .8166148   .1106376     7.38   0.000     .5997485    1.033481
         28  |   .8857917   .1060706     8.35   0.000     .6778774    1.093706
         29  |   .8282749   .1057867     7.83   0.000     .6209172    1.035633
         30  |   .8524399   .1038009     8.21   0.000     .6489746    1.055905
         31  |   .8839171   .1049423     8.42   0.000     .6782145     1.08962
         32  |   1.019955   .1062897     9.60   0.000     .8116113    1.228299
         33  |   1.075705   .1077422     9.98   0.000     .8645144    1.286896
         34  |   1.099917   .1111621     9.89   0.000     .8820223    1.317811
         35  |   1.124332   .1148751     9.79   0.000     .8991596    1.349504
         36  |   1.141721   .1195302     9.55   0.000     .9074245    1.376018
         37  |    1.16954   .1232304     9.49   0.000     .9279895     1.41109
         38  |   1.142958   .1276649     8.95   0.000     .8927158      1.3932
         39  |   1.133168    .132181     8.57   0.000     .8740733    1.392262
         40  |   1.116538   .1370783     8.15   0.000     .8478439    1.385232
         41  |   1.136262   .1420477     8.00   0.000     .8578268    1.414696
         42  |   1.158544   .1470912     7.88   0.000     .8702235    1.446865
         43  |   1.099298    .152214     7.22   0.000     .8009354     1.39766
         44  |   1.042103   .1583257     6.58   0.000     .7317607    1.352445
         45  |   1.104607   .1628461     6.78   0.000     .7854039    1.423809
         46  |   1.087666    .167665     6.49   0.000     .7590173    1.416314
         47  |   1.128469   .1717875     6.57   0.000     .7917395    1.465198
         48  |   1.195976   .1764058     6.78   0.000     .8501942    1.541758
         49  |   1.011308   .1824535     5.54   0.000     .6536714    1.368944
         50  |   1.139933   .1878802     6.07   0.000     .7716598    1.508206
             |
     age_cat |
          1  |   .5176648    .039346    13.16   0.000     .4405407    .5947889
          2  |   .8984307   .0456731    19.67   0.000     .8089047    .9879567
          3  |   1.142005   .0504483    22.64   0.000     1.043119    1.240891
          4  |   1.334686   .0552715    24.15   0.000     1.226346    1.443026
          5  |   1.445415   .0604702    23.90   0.000     1.326885    1.563946
          6  |   1.541413    .065611    23.49   0.000     1.412806    1.670021
          7  |   1.599734   .0708468    22.58   0.000     1.460864    1.738604
          8  |   1.657497   .0761268    21.77   0.000     1.508277    1.806716
          9  |   1.701758   .0815928    20.86   0.000     1.541824    1.861693
         10  |   1.734021    .087305    19.86   0.000      1.56289    1.905152
         11  |   1.795911   .0929525    19.32   0.000      1.61371    1.978112
         12  |   1.844652   .0986438    18.70   0.000     1.651296    2.038009
         13  |   1.853471   .1045641    17.73   0.000      1.64851    2.058432
         14  |    1.86972   .1105817    16.91   0.000     1.652964    2.086477
         15  |   1.885397    .116437    16.19   0.000     1.657163    2.113631
         16  |   1.907504    .122439    15.58   0.000     1.667505    2.147502
         17  |   1.907983   .1284528    14.85   0.000     1.656197     2.15977
         18  |   1.904832   .1345482    14.16   0.000     1.641098    2.168567
         19  |   1.919457   .1406132    13.65   0.000     1.643834    2.195079
         20  |   1.869001   .1512916    12.35   0.000     1.572447    2.165556
         25  |   1.742617   .1712421    10.18   0.000     1.406956    2.078277
         30  |   1.676775   .2067265     8.11   0.000      1.27156    2.081989
         40  |   1.565856   .2364349     6.62   0.000     1.102409    2.029304
         50  |   1.773765   .2611595     6.79   0.000     1.261854    2.285677
             |
       _cons |   8.083884   .0890744    90.75   0.000     7.909285    8.258483
-------------+----------------------------------------------------------------
     sigma_u |  2.2691981
     sigma_e |  .93387578
         rho |  .85516221   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0913734061918166

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    321,732
Group variable: firm_person                     Number of groups  =     40,319

R-sq:                                           Obs per group:
     within  = 0.0914                                         min =          1
     between = 0.1092                                         avg =        8.0
     overall = 0.0900                                         max =         18

                                                F(78,12800)       =      33.15
corr(u_i, Xb)  = 0.1106                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 12,801 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1327758   .0485897     2.73   0.006     .0375327    .2280189
      during |  -.0460723   .0123537    -3.73   0.000    -.0702874   -.0218572
       after |  -.0890898   .0220299    -4.04   0.000    -.1322717    -.045908
during_expat |  -.0873996   .0249584    -3.50   0.000    -.1363218   -.0384774
 after_expat |  -.1070998   .0353406    -3.03   0.002    -.1763727    -.037827
             |
    ind_year |
          2  |    -.16528   .0473823    -3.49   0.000    -.2581563   -.0724036
          3  |   .1326998   .0603903     2.20   0.028     .0143257    .2510738
          4  |   .1284202   .0672633     1.91   0.056    -.0034259    .2602663
          5  |   .1747883   .0763893     2.29   0.022     .0250539    .3245228
          6  |   .2818976   .0808447     3.49   0.000     .1234299    .4403653
          7  |   .4339102   .0868646     5.00   0.000     .2636426    .6041777
          8  |   .5076183   .0925624     5.48   0.000     .3261823    .6890544
          9  |    .595454   .0986674     6.03   0.000     .4020511    .7888569
         10  |    .648905   .1028086     6.31   0.000     .4473849    .8504251
         11  |   .6705587    .107766     6.22   0.000     .4593212    .8817962
         12  |   .6628176   .1138346     5.82   0.000     .4396848    .8859505
         13  |   .6659425   .1193183     5.58   0.000     .4320607    .8998242
         14  |   .6572855   .1245512     5.28   0.000     .4131466    .9014243
         15  |   .6104472   .1300259     4.69   0.000      .355577    .8653175
         16  |    .614585   .1354319     4.54   0.000     .3491182    .8800518
         17  |   .6218079   .1406918     4.42   0.000     .3460309    .8975849
         18  |   .5902593   .1462394     4.04   0.000     .3036083    .8769103
         19  |   .5092829    .151098     3.37   0.001     .2131082    .8054576
         20  |   .4853901   .1560288     3.11   0.002     .1795504    .7912299
         21  |     .49003   .1609055     3.05   0.002     .1746311    .8054288
         22  |   .4839908    .165416     2.93   0.003     .1597507    .8082309
         23  |   .5495606    .170003     3.23   0.001     .2163293    .8827919
         24  |   .0254407   .1755495     0.14   0.885    -.3186625    .3695438
         25  |   .0732641   .1827275     0.40   0.688    -.2849091    .4314373
         26  |   .9524461   .1185542     8.03   0.000     .7200622     1.18483
         27  |   .8166148   .1106376     7.38   0.000     .5997485    1.033481
         28  |   .8857917   .1060706     8.35   0.000     .6778774    1.093706
         29  |   .8282749   .1057867     7.83   0.000     .6209172    1.035633
         30  |   .8524399   .1038009     8.21   0.000     .6489746    1.055905
         31  |   .8839171   .1049423     8.42   0.000     .6782145     1.08962
         32  |   1.019955   .1062897     9.60   0.000     .8116113    1.228299
         33  |   1.075705   .1077422     9.98   0.000     .8645144    1.286896
         34  |   1.099917   .1111621     9.89   0.000     .8820223    1.317811
         35  |   1.124332   .1148751     9.79   0.000     .8991596    1.349504
         36  |   1.141721   .1195302     9.55   0.000     .9074245    1.376018
         37  |    1.16954   .1232304     9.49   0.000     .9279895     1.41109
         38  |   1.142958   .1276649     8.95   0.000     .8927158      1.3932
         39  |   1.133168    .132181     8.57   0.000     .8740733    1.392262
         40  |   1.116538   .1370783     8.15   0.000     .8478439    1.385232
         41  |   1.136262   .1420477     8.00   0.000     .8578268    1.414696
         42  |   1.158544   .1470912     7.88   0.000     .8702235    1.446865
         43  |   1.099298    .152214     7.22   0.000     .8009354     1.39766
         44  |   1.042103   .1583257     6.58   0.000     .7317607    1.352445
         45  |   1.104607   .1628461     6.78   0.000     .7854039    1.423809
         46  |   1.087666    .167665     6.49   0.000     .7590173    1.416314
         47  |   1.128469   .1717875     6.57   0.000     .7917395    1.465198
         48  |   1.195976   .1764058     6.78   0.000     .8501942    1.541758
         49  |   1.011308   .1824535     5.54   0.000     .6536714    1.368944
         50  |   1.139933   .1878802     6.07   0.000     .7716598    1.508206
             |
     age_cat |
          1  |   .5176648    .039346    13.16   0.000     .4405407    .5947889
          2  |   .8984307   .0456731    19.67   0.000     .8089047    .9879567
          3  |   1.142005   .0504483    22.64   0.000     1.043119    1.240891
          4  |   1.334686   .0552715    24.15   0.000     1.226346    1.443026
          5  |   1.445415   .0604702    23.90   0.000     1.326885    1.563946
          6  |   1.541413    .065611    23.49   0.000     1.412806    1.670021
          7  |   1.599734   .0708468    22.58   0.000     1.460864    1.738604
          8  |   1.657497   .0761268    21.77   0.000     1.508277    1.806716
          9  |   1.701758   .0815928    20.86   0.000     1.541824    1.861693
         10  |   1.734021    .087305    19.86   0.000      1.56289    1.905152
         11  |   1.795911   .0929525    19.32   0.000      1.61371    1.978112
         12  |   1.844652   .0986438    18.70   0.000     1.651296    2.038009
         13  |   1.853471   .1045641    17.73   0.000      1.64851    2.058432
         14  |    1.86972   .1105817    16.91   0.000     1.652964    2.086477
         15  |   1.885397    .116437    16.19   0.000     1.657163    2.113631
         16  |   1.907504    .122439    15.58   0.000     1.667505    2.147502
         17  |   1.907983   .1284528    14.85   0.000     1.656197     2.15977
         18  |   1.904832   .1345482    14.16   0.000     1.641098    2.168567
         19  |   1.919457   .1406132    13.65   0.000     1.643834    2.195079
         20  |   1.869001   .1512916    12.35   0.000     1.572447    2.165556
         25  |   1.742617   .1712421    10.18   0.000     1.406956    2.078277
         30  |   1.676775   .2067265     8.11   0.000      1.27156    2.081989
         40  |   1.565856   .2364349     6.62   0.000     1.102409    2.029304
         50  |   1.773765   .2611595     6.79   0.000     1.261854    2.285677
             |
       _cons |   8.083884   .0890744    90.75   0.000     7.909285    8.258483
-------------+----------------------------------------------------------------
     sigma_u |  2.2691981
     sigma_e |  .93387578
         rho |  .85516221   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    353439
Group variable: firm_person                     Number of groups   =     41042

R-sq:  within  = 0.1664                         Obs per group: min =         1
       between = 0.0926                                        avg =       8.6
       overall = 0.0940                                        max =        18

                                                F(78,13202)        =     68.80
corr(u_i, Xb)  = 0.0325                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1244121   .0369174     3.37   0.001     .0520488    .1967755
      during |  -.0726709   .0102536    -7.09   0.000    -.0927695   -.0525724
       after |  -.1173907   .0187774    -6.25   0.000    -.1541971   -.0805843
during_expat |   .1491229   .0200015     7.46   0.000      .109917    .1883288
 after_expat |   .2772877   .0286296     9.69   0.000     .2211695    .3334059
             |
    ind_year |
          2  |  -.1122137   .0343841    -3.26   0.001    -.1796115    -.044816
          3  |  -.1388114    .047478    -2.92   0.003     -.231875   -.0457478
          4  |  -.1106901    .053269    -2.08   0.038     -.215105   -.0062752
          5  |  -.0861056   .0600633    -1.43   0.152    -.2038384    .0316271
          6  |  -.0276343   .0654477    -0.42   0.673    -.1559211    .1006526
          7  |   .0181103   .0700246     0.26   0.796    -.1191481    .1553686
          8  |   .0221529   .0756513     0.29   0.770    -.1261345    .1704403
          9  |   .0650787   .0803565     0.81   0.418    -.0924316     .222589
         10  |   .0760004   .0849547     0.89   0.371     -.090523    .2425239
         11  |   .0360478   .0892053     0.40   0.686    -.1388075     .210903
         12  |  -.0102167   .0936894    -0.11   0.913    -.1938615    .1734281
         13  |   -.033834   .0980189    -0.35   0.730    -.2259651    .1582971
         14  |  -.0420611   .1023057    -0.41   0.681     -.242595    .1584727
         15  |  -.0315372   .1065608    -0.30   0.767    -.2404118    .1773373
         16  |  -.0671316   .1107082    -0.61   0.544    -.2841356    .1498724
         17  |  -.0587701    .114747    -0.51   0.609    -.2836907    .1661505
         18  |  -.1943361   .1192081    -1.63   0.103     -.428001    .0393288
         19  |  -.2185566   .1223049    -1.79   0.074    -.4582917    .0211786
         20  |  -.2281068   .1257454    -1.81   0.070    -.4745858    .0183723
         21  |  -.2782286   .1290872    -2.16   0.031     -.531258   -.0251991
         22  |  -.2733905   .1323733    -2.07   0.039    -.5328611   -.0139199
         23  |   -.244575   .1359759    -1.80   0.072    -.5111072    .0219572
         24  |  -.2432205    .139252    -1.75   0.081    -.5161745    .0297335
         25  |  -.2574027   .1430718    -1.80   0.072     -.537844    .0230387
         26  |   .3910412   .1021071     3.83   0.000     .1908966    .5911857
         27  |   .2127246   .0962551     2.21   0.027     .0240509    .4013984
         28  |   .2358744   .0919513     2.57   0.010     .0556367    .4161121
         29  |   .2722738   .0916041     2.97   0.003     .0927167    .4518309
         30  |   .3723698   .0880709     4.23   0.000     .1997381    .5450014
         31  |   .4175177   .0894677     4.67   0.000     .2421482    .5928871
         32  |   .4894777   .0904344     5.41   0.000     .3122132    .6667422
         33  |   .4750986   .0923635     5.14   0.000     .2940529    .6561442
         34  |   .5329403   .0948832     5.62   0.000     .3469557     .718925
         35  |   .5540015   .0970022     5.71   0.000     .3638633    .7441396
         36  |   .4824148   .0993224     4.86   0.000     .2877287    .6771009
         37  |   .4705916   .1022671     4.60   0.000     .2701334    .6710498
         38  |   .4467202   .1055384     4.23   0.000     .2398497    .6535907
         39  |    .422251   .1095005     3.86   0.000     .2076144    .6368877
         40  |   .4691928   .1132494     4.14   0.000     .2472078    .6911779
         41  |   .4899576   .1163217     4.21   0.000     .2619504    .7179649
         42  |   .4934239   .1200396     4.11   0.000     .2581291    .7287187
         43  |   .3231448   .1239729     2.61   0.009     .0801401    .5661494
         44  |   .3196253     .12844     2.49   0.013     .0678645    .5713861
         45  |   .3900079   .1317802     2.96   0.003     .1316999     .648316
         46  |   .3641159   .1355367     2.69   0.007     .0984445    .6297874
         47  |    .371552   .1386874     2.68   0.007     .0997047    .6433993
         48  |   .3959327   .1418859     2.79   0.005      .117816    .6740494
         49  |   .3823636   .1452056     2.63   0.008     .0977398    .6669875
         50  |   .4030663   .1484305     2.72   0.007     .1121211    .6940115
             |
     age_cat |
          1  |   1.102404   .0330455    33.36   0.000      1.03763    1.167178
          2  |   1.565239   .0367768    42.56   0.000     1.493151    1.637327
          3  |   1.830114   .0406305    45.04   0.000     1.750473    1.909756
          4  |    2.04424     .04412    46.33   0.000     1.957758    2.130721
          5  |     2.2029   .0480538    45.84   0.000     2.108708    2.297093
          6  |   2.322191   .0520792    44.59   0.000     2.220108    2.424274
          7  |   2.441677   .0561077    43.52   0.000     2.331698    2.551656
          8  |   2.528179   .0606286    41.70   0.000     2.409338    2.647019
          9  |   2.606614   .0648604    40.19   0.000     2.479478     2.73375
         10  |   2.659536    .069155    38.46   0.000     2.523983     2.79509
         11  |   2.729418   .0737275    37.02   0.000     2.584902    2.873935
         12  |    2.78054   .0782588    35.53   0.000     2.627142    2.933939
         13  |   2.828721   .0825937    34.25   0.000     2.666826    2.990616
         14  |   2.872468   .0872979    32.90   0.000     2.701352    3.043585
         15  |   2.916457   .0917831    31.78   0.000     2.736549    3.096365
         16  |    2.93067   .0964484    30.39   0.000     2.741618    3.119723
         17  |   2.957022    .100956    29.29   0.000     2.759134    3.154911
         18  |   2.992454   .1052139    28.44   0.000     2.786219    3.198688
         19  |   3.004148   .1097432    27.37   0.000     2.789035     3.21926
         20  |   3.015214   .1180738    25.54   0.000     2.783772    3.246655
         25  |   3.014104   .1312609    22.96   0.000     2.756814    3.271394
         30  |   2.935051   .1646505    17.83   0.000     2.612312    3.257789
         40  |   2.829847   .1854738    15.26   0.000     2.466292    3.193403
         50  |   2.900935   .2023303    14.34   0.000     2.504338    3.297531
             |
       _cons |   10.50548   .0752906   139.53   0.000      10.3579    10.65306
-------------+----------------------------------------------------------------
     sigma_u |  1.9687992
     sigma_e |  .80356877
         rho |  .85720078   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1664067136650556

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    353,439
Group variable: firm_person                     Number of groups  =     41,042

R-sq:                                           Obs per group:
     within  = 0.1664                                         min =          1
     between = 0.0926                                         avg =        8.6
     overall = 0.0940                                         max =         18

                                                F(78,13202)       =      68.80
corr(u_i, Xb)  = 0.0325                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1244121   .0369174     3.37   0.001     .0520488    .1967755
      during |  -.0726709   .0102536    -7.09   0.000    -.0927695   -.0525724
       after |  -.1173907   .0187774    -6.25   0.000    -.1541971   -.0805843
during_expat |   .1491229   .0200015     7.46   0.000      .109917    .1883288
 after_expat |   .2772877   .0286296     9.69   0.000     .2211695    .3334059
             |
    ind_year |
          2  |  -.1122137   .0343841    -3.26   0.001    -.1796115    -.044816
          3  |  -.1388114    .047478    -2.92   0.003     -.231875   -.0457478
          4  |  -.1106901    .053269    -2.08   0.038     -.215105   -.0062752
          5  |  -.0861056   .0600633    -1.43   0.152    -.2038384    .0316271
          6  |  -.0276343   .0654477    -0.42   0.673    -.1559211    .1006526
          7  |   .0181103   .0700246     0.26   0.796    -.1191481    .1553686
          8  |   .0221529   .0756513     0.29   0.770    -.1261345    .1704403
          9  |   .0650787   .0803565     0.81   0.418    -.0924316     .222589
         10  |   .0760004   .0849547     0.89   0.371     -.090523    .2425239
         11  |   .0360478   .0892053     0.40   0.686    -.1388075     .210903
         12  |  -.0102167   .0936894    -0.11   0.913    -.1938615    .1734281
         13  |   -.033834   .0980189    -0.35   0.730    -.2259651    .1582971
         14  |  -.0420611   .1023057    -0.41   0.681     -.242595    .1584727
         15  |  -.0315372   .1065608    -0.30   0.767    -.2404118    .1773373
         16  |  -.0671316   .1107082    -0.61   0.544    -.2841356    .1498724
         17  |  -.0587701    .114747    -0.51   0.609    -.2836907    .1661505
         18  |  -.1943361   .1192081    -1.63   0.103     -.428001    .0393288
         19  |  -.2185566   .1223049    -1.79   0.074    -.4582917    .0211786
         20  |  -.2281068   .1257454    -1.81   0.070    -.4745858    .0183723
         21  |  -.2782286   .1290872    -2.16   0.031     -.531258   -.0251991
         22  |  -.2733905   .1323733    -2.07   0.039    -.5328611   -.0139199
         23  |   -.244575   .1359759    -1.80   0.072    -.5111072    .0219572
         24  |  -.2432205    .139252    -1.75   0.081    -.5161745    .0297335
         25  |  -.2574027   .1430718    -1.80   0.072     -.537844    .0230387
         26  |   .3910412   .1021071     3.83   0.000     .1908966    .5911857
         27  |   .2127246   .0962551     2.21   0.027     .0240509    .4013984
         28  |   .2358744   .0919513     2.57   0.010     .0556367    .4161121
         29  |   .2722738   .0916041     2.97   0.003     .0927167    .4518309
         30  |   .3723698   .0880709     4.23   0.000     .1997381    .5450014
         31  |   .4175177   .0894677     4.67   0.000     .2421482    .5928871
         32  |   .4894777   .0904344     5.41   0.000     .3122132    .6667422
         33  |   .4750986   .0923635     5.14   0.000     .2940529    .6561442
         34  |   .5329403   .0948832     5.62   0.000     .3469557     .718925
         35  |   .5540015   .0970022     5.71   0.000     .3638633    .7441396
         36  |   .4824148   .0993224     4.86   0.000     .2877287    .6771009
         37  |   .4705916   .1022671     4.60   0.000     .2701334    .6710498
         38  |   .4467202   .1055384     4.23   0.000     .2398497    .6535907
         39  |    .422251   .1095005     3.86   0.000     .2076144    .6368877
         40  |   .4691928   .1132494     4.14   0.000     .2472078    .6911779
         41  |   .4899576   .1163217     4.21   0.000     .2619504    .7179649
         42  |   .4934239   .1200396     4.11   0.000     .2581291    .7287187
         43  |   .3231448   .1239729     2.61   0.009     .0801401    .5661494
         44  |   .3196253     .12844     2.49   0.013     .0678645    .5713861
         45  |   .3900079   .1317802     2.96   0.003     .1316999     .648316
         46  |   .3641159   .1355367     2.69   0.007     .0984445    .6297874
         47  |    .371552   .1386874     2.68   0.007     .0997047    .6433993
         48  |   .3959327   .1418859     2.79   0.005      .117816    .6740494
         49  |   .3823636   .1452056     2.63   0.008     .0977398    .6669875
         50  |   .4030663   .1484305     2.72   0.007     .1121211    .6940115
             |
     age_cat |
          1  |   1.102404   .0330455    33.36   0.000      1.03763    1.167178
          2  |   1.565239   .0367768    42.56   0.000     1.493151    1.637327
          3  |   1.830114   .0406305    45.04   0.000     1.750473    1.909756
          4  |    2.04424     .04412    46.33   0.000     1.957758    2.130721
          5  |     2.2029   .0480538    45.84   0.000     2.108708    2.297093
          6  |   2.322191   .0520792    44.59   0.000     2.220108    2.424274
          7  |   2.441677   .0561077    43.52   0.000     2.331698    2.551656
          8  |   2.528179   .0606286    41.70   0.000     2.409338    2.647019
          9  |   2.606614   .0648604    40.19   0.000     2.479478     2.73375
         10  |   2.659536    .069155    38.46   0.000     2.523983     2.79509
         11  |   2.729418   .0737275    37.02   0.000     2.584902    2.873935
         12  |    2.78054   .0782588    35.53   0.000     2.627142    2.933939
         13  |   2.828721   .0825937    34.25   0.000     2.666826    2.990616
         14  |   2.872468   .0872979    32.90   0.000     2.701352    3.043585
         15  |   2.916457   .0917831    31.78   0.000     2.736549    3.096365
         16  |    2.93067   .0964484    30.39   0.000     2.741618    3.119723
         17  |   2.957022    .100956    29.29   0.000     2.759134    3.154911
         18  |   2.992454   .1052139    28.44   0.000     2.786219    3.198688
         19  |   3.004148   .1097432    27.37   0.000     2.789035     3.21926
         20  |   3.015214   .1180738    25.54   0.000     2.783772    3.246655
         25  |   3.014104   .1312609    22.96   0.000     2.756814    3.271394
         30  |   2.935051   .1646505    17.83   0.000     2.612312    3.257789
         40  |   2.829847   .1854738    15.26   0.000     2.466292    3.193403
         50  |   2.900935   .2023303    14.34   0.000     2.504338    3.297531
             |
       _cons |   10.50548   .0752906   139.53   0.000      10.3579    10.65306
-------------+----------------------------------------------------------------
     sigma_u |  1.9687992
     sigma_e |  .80356877
         rho |  .85720078   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    321732
Group variable: firm_person                     Number of groups   =     40319

R-sq:  within  = 0.0644                         Obs per group: min =         1
       between = 0.0252                                        avg =       8.0
       overall = 0.0352                                        max =        18

                                                F(78,12800)        =     28.47
corr(u_i, Xb)  = -0.0808                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 12,801 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1167349   .0422638     2.76   0.006     .0338915    .1995783
      during |   .0251118   .0112283     2.24   0.025     .0031027     .047121
       after |   .0469679   .0198092     2.37   0.018     .0081388    .0857969
during_expat |  -.1813616   .0212658    -8.53   0.000    -.2230458   -.1396774
 after_expat |  -.3131952   .0291575   -10.74   0.000    -.3703482   -.2560422
             |
    ind_year |
          2  |   .0869015   .0412513     2.11   0.035     .0060427    .1677603
          3  |   .5562197   .0503206    11.05   0.000     .4575838    .6548555
          4  |   .7060113    .055862    12.64   0.000     .5965134    .8155091
          5  |   .8806262     .06091    14.46   0.000     .7612335    1.000019
          6  |   1.105873   .0660032    16.75   0.000     .9764968    1.235249
          7  |   1.346185   .0703033    19.15   0.000      1.20838     1.48399
          8  |   1.493486   .0753269    19.83   0.000     1.345834    1.641138
          9  |   1.653134   .0805368    20.53   0.000      1.49527    1.810998
         10  |   1.784367   .0840802    21.22   0.000     1.619557    1.949177
         11  |   1.925872    .088114    21.86   0.000     1.753155    2.098589
         12  |   1.976004   .0926308    21.33   0.000     1.794434    2.157574
         13  |   2.060976   .0975154    21.13   0.000     1.869831     2.25212
         14  |   2.094749   .1020668    20.52   0.000     1.894683    2.294816
         15  |   2.093667   .1070347    19.56   0.000     1.883863    2.303471
         16  |   2.158318   .1114179    19.37   0.000     1.939923    2.376714
         17  |   2.216143   .1161778    19.08   0.000     1.988417    2.443869
         18  |   2.265586   .1209237    18.74   0.000     2.028557    2.502614
         19  |   2.252772   .1251432    18.00   0.000     2.007472    2.498071
         20  |   2.270999   .1294958    17.54   0.000     2.017168     2.52483
         21  |   2.336887   .1336122    17.49   0.000     2.074987    2.598787
         22  |   2.378104    .137087    17.35   0.000     2.109393    2.646815
         23  |   2.462833   .1412446    17.44   0.000     2.185972    2.739693
         24  |   1.896754   .1463803    12.96   0.000     1.609827    2.183682
         25  |   1.948765   .1527192    12.76   0.000     1.649413    2.248117
         26  |   .2615454    .096742     2.70   0.007     .0719166    .4511742
         27  |   .3812812   .0906652     4.21   0.000     .2035639    .5589986
         28  |    .642872   .0858609     7.49   0.000     .4745718    .8111722
         29  |   .7526074    .086014     8.75   0.000      .584007    .9212078
         30  |    .897513   .0844291    10.63   0.000     .7320193    1.063007
         31  |   1.037682   .0851509    12.19   0.000     .8707732     1.20459
         32  |   1.281103    .086824    14.76   0.000     1.110915    1.451291
         33  |   1.423973   .0875652    16.26   0.000     1.252332    1.595614
         34  |   1.527984   .0908068    16.83   0.000     1.349989    1.705979
         35  |    1.62231   .0942149    17.22   0.000     1.437635    1.806985
         36  |   1.756101   .0976977    17.97   0.000     1.564599    1.947603
         37  |   1.884315   .1014662    18.57   0.000     1.685426    2.083204
         38  |   1.956161   .1057132    18.50   0.000     1.748947    2.163374
         39  |   2.035358   .1095975    18.57   0.000      1.82053    2.250185
         40  |   2.071448   .1137423    18.21   0.000     1.848496      2.2944
         41  |   2.126795    .117663    18.08   0.000     1.896158    2.357432
         42  |   2.214975   .1220985    18.14   0.000     1.975644    2.454306
         43  |   2.301723    .126707    18.17   0.000     2.053359    2.550088
         44  |   2.308993    .131635    17.54   0.000     2.050969    2.567017
         45  |   2.380523   .1357252    17.54   0.000     2.114482    2.646565
         46  |   2.406061   .1398433    17.21   0.000     2.131947    2.680175
         47  |   2.477883   .1434996    17.27   0.000     2.196602    2.759163
         48  |   2.558649   .1475105    17.35   0.000     2.269507    2.847792
         49  |   2.307524   .1525972    15.12   0.000     2.008411    2.606638
         50  |   2.397071   .1574175    15.23   0.000     2.088509    2.705633
             |
     age_cat |
          1  |   .0710636   .0379463     1.87   0.061    -.0033169     .145444
          2  |   .0788846   .0427658     1.84   0.065    -.0049427    .1627118
          3  |   .0742147   .0464622     1.60   0.110    -.0168581    .1652875
          4  |   .0685021   .0502711     1.36   0.173    -.0300367    .1670409
          5  |   .0137822   .0545119     0.25   0.800    -.0930693    .1206337
          6  |  -.0223695   .0586264    -0.38   0.703     -.137286     .092547
          7  |  -.0750245   .0630172    -1.19   0.234    -.1985476    .0484985
          8  |  -.1179878    .067444    -1.75   0.080    -.2501881    .0142124
          9  |  -.1536831    .072094    -2.13   0.033    -.2949982   -.0123681
         10  |  -.1903835   .0767376    -2.48   0.013    -.3408006   -.0399664
         11  |  -.2053998   .0814215    -2.52   0.012     -.364998   -.0458016
         12  |  -.2194893   .0860109    -2.55   0.011    -.3880836   -.0508951
         13  |  -.2695235   .0910498    -2.96   0.003    -.4479947   -.0910522
         14  |  -.2931508   .0960347    -3.05   0.002    -.4813931   -.1049084
         15  |  -.3204912   .1009616    -3.17   0.002    -.5183911   -.1225913
         16  |   -.348607   .1059268    -3.29   0.001    -.5562394   -.1409747
         17  |  -.3811242   .1109444    -3.44   0.001    -.5985917   -.1636567
         18  |  -.4227868   .1161898    -3.64   0.000    -.6505361   -.1950374
         19  |  -.4486402   .1214336    -3.69   0.000    -.6866682   -.2106123
         20  |  -.5343932   .1301551    -4.11   0.000    -.7895166   -.2792697
         25  |  -.6838634   .1471343    -4.65   0.000    -.9722686   -.3954582
         30  |  -.6637097   .1769806    -3.75   0.000    -1.010618   -.3168014
         40  |  -.6867632   .2036038    -3.37   0.001    -1.085857   -.2876693
         50  |  -.5493961   .2299494    -2.39   0.017    -1.000131    -.098661
             |
       _cons |   4.713686    .073896    63.79   0.000     4.568839    4.858534
-------------+----------------------------------------------------------------
     sigma_u |  1.7023236
     sigma_e |  .85652626
         rho |  .79798194   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0643664130296805

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    321,732
Group variable: firm_person                     Number of groups  =     40,319

R-sq:                                           Obs per group:
     within  = 0.0644                                         min =          1
     between = 0.0252                                         avg =        8.0
     overall = 0.0352                                         max =         18

                                                F(78,12800)       =      28.47
corr(u_i, Xb)  = -0.0808                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 12,801 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1167349   .0422638     2.76   0.006     .0338915    .1995783
      during |   .0251118   .0112283     2.24   0.025     .0031027     .047121
       after |   .0469679   .0198092     2.37   0.018     .0081388    .0857969
during_expat |  -.1813616   .0212658    -8.53   0.000    -.2230458   -.1396774
 after_expat |  -.3131952   .0291575   -10.74   0.000    -.3703482   -.2560422
             |
    ind_year |
          2  |   .0869015   .0412513     2.11   0.035     .0060427    .1677603
          3  |   .5562197   .0503206    11.05   0.000     .4575838    .6548555
          4  |   .7060113    .055862    12.64   0.000     .5965134    .8155091
          5  |   .8806262     .06091    14.46   0.000     .7612335    1.000019
          6  |   1.105873   .0660032    16.75   0.000     .9764968    1.235249
          7  |   1.346185   .0703033    19.15   0.000      1.20838     1.48399
          8  |   1.493486   .0753269    19.83   0.000     1.345834    1.641138
          9  |   1.653134   .0805368    20.53   0.000      1.49527    1.810998
         10  |   1.784367   .0840802    21.22   0.000     1.619557    1.949177
         11  |   1.925872    .088114    21.86   0.000     1.753155    2.098589
         12  |   1.976004   .0926308    21.33   0.000     1.794434    2.157574
         13  |   2.060976   .0975154    21.13   0.000     1.869831     2.25212
         14  |   2.094749   .1020668    20.52   0.000     1.894683    2.294816
         15  |   2.093667   .1070347    19.56   0.000     1.883863    2.303471
         16  |   2.158318   .1114179    19.37   0.000     1.939923    2.376714
         17  |   2.216143   .1161778    19.08   0.000     1.988417    2.443869
         18  |   2.265586   .1209237    18.74   0.000     2.028557    2.502614
         19  |   2.252772   .1251432    18.00   0.000     2.007472    2.498071
         20  |   2.270999   .1294958    17.54   0.000     2.017168     2.52483
         21  |   2.336887   .1336122    17.49   0.000     2.074987    2.598787
         22  |   2.378104    .137087    17.35   0.000     2.109393    2.646815
         23  |   2.462833   .1412446    17.44   0.000     2.185972    2.739693
         24  |   1.896754   .1463803    12.96   0.000     1.609827    2.183682
         25  |   1.948765   .1527192    12.76   0.000     1.649413    2.248117
         26  |   .2615454    .096742     2.70   0.007     .0719166    .4511742
         27  |   .3812812   .0906652     4.21   0.000     .2035639    .5589986
         28  |    .642872   .0858609     7.49   0.000     .4745718    .8111722
         29  |   .7526074    .086014     8.75   0.000      .584007    .9212078
         30  |    .897513   .0844291    10.63   0.000     .7320193    1.063007
         31  |   1.037682   .0851509    12.19   0.000     .8707732     1.20459
         32  |   1.281103    .086824    14.76   0.000     1.110915    1.451291
         33  |   1.423973   .0875652    16.26   0.000     1.252332    1.595614
         34  |   1.527984   .0908068    16.83   0.000     1.349989    1.705979
         35  |    1.62231   .0942149    17.22   0.000     1.437635    1.806985
         36  |   1.756101   .0976977    17.97   0.000     1.564599    1.947603
         37  |   1.884315   .1014662    18.57   0.000     1.685426    2.083204
         38  |   1.956161   .1057132    18.50   0.000     1.748947    2.163374
         39  |   2.035358   .1095975    18.57   0.000      1.82053    2.250185
         40  |   2.071448   .1137423    18.21   0.000     1.848496      2.2944
         41  |   2.126795    .117663    18.08   0.000     1.896158    2.357432
         42  |   2.214975   .1220985    18.14   0.000     1.975644    2.454306
         43  |   2.301723    .126707    18.17   0.000     2.053359    2.550088
         44  |   2.308993    .131635    17.54   0.000     2.050969    2.567017
         45  |   2.380523   .1357252    17.54   0.000     2.114482    2.646565
         46  |   2.406061   .1398433    17.21   0.000     2.131947    2.680175
         47  |   2.477883   .1434996    17.27   0.000     2.196602    2.759163
         48  |   2.558649   .1475105    17.35   0.000     2.269507    2.847792
         49  |   2.307524   .1525972    15.12   0.000     2.008411    2.606638
         50  |   2.397071   .1574175    15.23   0.000     2.088509    2.705633
             |
     age_cat |
          1  |   .0710636   .0379463     1.87   0.061    -.0033169     .145444
          2  |   .0788846   .0427658     1.84   0.065    -.0049427    .1627118
          3  |   .0742147   .0464622     1.60   0.110    -.0168581    .1652875
          4  |   .0685021   .0502711     1.36   0.173    -.0300367    .1670409
          5  |   .0137822   .0545119     0.25   0.800    -.0930693    .1206337
          6  |  -.0223695   .0586264    -0.38   0.703     -.137286     .092547
          7  |  -.0750245   .0630172    -1.19   0.234    -.1985476    .0484985
          8  |  -.1179878    .067444    -1.75   0.080    -.2501881    .0142124
          9  |  -.1536831    .072094    -2.13   0.033    -.2949982   -.0123681
         10  |  -.1903835   .0767376    -2.48   0.013    -.3408006   -.0399664
         11  |  -.2053998   .0814215    -2.52   0.012     -.364998   -.0458016
         12  |  -.2194893   .0860109    -2.55   0.011    -.3880836   -.0508951
         13  |  -.2695235   .0910498    -2.96   0.003    -.4479947   -.0910522
         14  |  -.2931508   .0960347    -3.05   0.002    -.4813931   -.1049084
         15  |  -.3204912   .1009616    -3.17   0.002    -.5183911   -.1225913
         16  |   -.348607   .1059268    -3.29   0.001    -.5562394   -.1409747
         17  |  -.3811242   .1109444    -3.44   0.001    -.5985917   -.1636567
         18  |  -.4227868   .1161898    -3.64   0.000    -.6505361   -.1950374
         19  |  -.4486402   .1214336    -3.69   0.000    -.6866682   -.2106123
         20  |  -.5343932   .1301551    -4.11   0.000    -.7895166   -.2792697
         25  |  -.6838634   .1471343    -4.65   0.000    -.9722686   -.3954582
         30  |  -.6637097   .1769806    -3.75   0.000    -1.010618   -.3168014
         40  |  -.6867632   .2036038    -3.37   0.001    -1.085857   -.2876693
         50  |  -.5493961   .2299494    -2.39   0.017    -1.000131    -.098661
             |
       _cons |   4.713686    .073896    63.79   0.000     4.568839    4.858534
-------------+----------------------------------------------------------------
     sigma_u |  1.7023236
     sigma_e |  .85652626
         rho |  .79798194   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    353439
Group variable: firm_person                     Number of groups   =     41042

R-sq:  within  = 0.1404                         Obs per group: min =         1
       between = 0.1486                                        avg =       8.6
       overall = 0.1314                                        max =        18

                                                F(78,13202)        =     76.81
corr(u_i, Xb)  = 0.0822                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0821845   .0245425     3.35   0.001     .0340776    .1302913
      during |  -.0027705   .0069891    -0.40   0.692    -.0164702    .0109291
       after |   .0259097   .0125494     2.06   0.039     .0013111    .0505084
during_expat |   .0692722   .0130171     5.32   0.000     .0437567    .0947876
 after_expat |   .0926364   .0182572     5.07   0.000     .0568495    .1284232
             |
    ind_year |
          2  |   .1183412    .025219     4.69   0.000     .0689083    .1677741
          3  |   .2599311   .0319968     8.12   0.000     .1972129    .3226493
          4  |   .4362237   .0352501    12.38   0.000     .3671284    .5053191
          5  |   .5904175   .0381691    15.47   0.000     .5156005    .6652345
          6  |   .7608166   .0421178    18.06   0.000     .6782596    .8433736
          7  |   .8977422   .0444642    20.19   0.000     .8105859    .9848985
          8  |    .980795   .0467278    20.99   0.000     .8892018    1.072388
          9  |   1.104632   .0494806    22.32   0.000     1.007643    1.201621
         10  |    1.19261   .0523994    22.76   0.000     1.089899     1.29532
         11  |   1.272933   .0549703    23.16   0.000     1.165184    1.380683
         12  |   1.291996   .0578857    22.32   0.000     1.178532     1.40546
         13  |   1.357601   .0609965    22.26   0.000     1.238039    1.477163
         14  |   1.403509   .0636219    22.06   0.000     1.278801    1.528217
         15  |   1.465831   .0662042    22.14   0.000     1.336061    1.595601
         16  |   1.493794   .0690669    21.63   0.000     1.358413    1.629175
         17  |   1.556749   .0720161    21.62   0.000     1.415587    1.697911
         18  |   1.498475   .0748723    20.01   0.000     1.351714    1.645235
         19  |   1.542476   .0774858    19.91   0.000     1.390593    1.694359
         20  |    1.58686   .0798481    19.87   0.000     1.430347    1.743374
         21  |   1.607748   .0821337    19.57   0.000     1.446754    1.768741
         22  |   1.666358   .0841684    19.80   0.000     1.501376     1.83134
         23  |   1.724556   .0867129    19.89   0.000     1.554586    1.894525
         24  |   1.758055   .0887546    19.81   0.000     1.584084    1.932027
         25  |   1.753085   .0914152    19.18   0.000     1.573898    1.932272
         26  |  -.4049642   .0633185    -6.40   0.000    -.5290775   -.2808509
         27  |  -.3033236   .0597301    -5.08   0.000    -.4204031   -.1862441
         28  |  -.0884707   .0577083    -1.53   0.125    -.2015874    .0246459
         29  |   .1145532   .0567152     2.02   0.043     .0033833     .225723
         30  |   .3350383   .0548137     6.11   0.000     .2275955     .442481
         31  |   .4988454   .0556904     8.96   0.000     .3896842    .6080067
         32  |   .6740839   .0565956    11.91   0.000     .5631484    .7850194
         33  |   .7542498   .0573908    13.14   0.000     .6417555    .8667441
         34  |   .8931943   .0593076    15.06   0.000     .7769429    1.009446
         35  |   .9896686   .0605843    16.34   0.000     .8709147    1.108423
         36  |   1.032127   .0618843    16.68   0.000     .9108253    1.153429
         37  |   1.124125   .0640681    17.55   0.000     .9985425    1.249708
         38  |   1.213673   .0662833    18.31   0.000     1.083748    1.343598
         39  |   1.282529   .0690605    18.57   0.000     1.147161    1.417898
         40  |   1.387888   .0713923    19.44   0.000     1.247948    1.527827
         41  |   1.450768   .0734772    19.74   0.000     1.306742    1.594794
         42  |   1.520542   .0756424    20.10   0.000     1.372272    1.668812
         43  |   1.503729   .0780689    19.26   0.000     1.350703    1.656755
         44  |   1.570567   .0808234    19.43   0.000     1.412141    1.728992
         45  |   1.652475   .0830277    19.90   0.000     1.489729    1.815221
         46  |    1.66852   .0856063    19.49   0.000      1.50072    1.836321
         47  |   1.710961   .0875088    19.55   0.000     1.539431    1.882491
         48  |   1.759605   .0892637    19.71   0.000     1.584635    1.934574
         49  |   1.757518   .0918935    19.13   0.000     1.577394    1.937643
         50  |   1.781546   .0938371    18.99   0.000     1.597612     1.96548
             |
     age_cat |
          1  |    .620332   .0278325    22.29   0.000     .5657762    .6748877
          2  |   .6798585   .0297761    22.83   0.000     .6214931    .7382239
          3  |   .6906145    .031879    21.66   0.000     .6281272    .7531019
          4  |   .6978893   .0336388    20.75   0.000     .6319524    .7638262
          5  |   .6818249   .0355133    19.20   0.000     .6122137    .7514361
          6  |    .664383   .0376052    17.67   0.000     .5906713    .7380946
          7  |   .6684808   .0398149    16.79   0.000     .5904378    .7465238
          8  |   .6506139   .0422602    15.40   0.000     .5677779      .73345
          9  |   .6443987    .044617    14.44   0.000      .556943    .7318545
         10  |   .6358549   .0471357    13.49   0.000      .543462    .7282477
         11  |   .6232691   .0500053    12.46   0.000     .5252515    .7212868
         12  |   .6109208   .0525941    11.62   0.000     .5078287    .7140129
         13  |   .5898905   .0553307    10.66   0.000     .4814343    .6983466
         14  |   .5903716   .0581442    10.15   0.000     .4764006    .7043426
         15  |   .5919708   .0608988     9.72   0.000     .4726005    .7113412
         16  |   .5629437   .0638258     8.82   0.000      .437836    .6880513
         17  |   .5437654   .0666354     8.16   0.000     .4131506    .6743803
         18  |   .5407473   .0693968     7.79   0.000     .4047197    .6767749
         19  |   .5116477   .0724998     7.06   0.000     .3695376    .6537578
         20  |   .4782026   .0777979     6.15   0.000     .3257075    .6306976
         25  |   .4480501    .086314     5.19   0.000     .2788623    .6172379
         30  |   .4621458     .10638     4.34   0.000     .2536257     .670666
         40  |   .4670203   .1189845     3.93   0.000     .2337936     .700247
         50  |   .4714295    .136411     3.46   0.001     .2040443    .7388146
             |
       _cons |   7.272641   .0503638   144.40   0.000     7.173921    7.371361
-------------+----------------------------------------------------------------
     sigma_u |  1.2839919
     sigma_e |  .58986564
         rho |  .82573096   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1403652017426245

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    353,439
Group variable: firm_person                     Number of groups  =     41,042

R-sq:                                           Obs per group:
     within  = 0.1404                                         min =          1
     between = 0.1486                                         avg =        8.6
     overall = 0.1314                                         max =         18

                                                F(78,13202)       =      76.81
corr(u_i, Xb)  = 0.0822                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0821845   .0245425     3.35   0.001     .0340776    .1302913
      during |  -.0027705   .0069891    -0.40   0.692    -.0164702    .0109291
       after |   .0259097   .0125494     2.06   0.039     .0013111    .0505084
during_expat |   .0692722   .0130171     5.32   0.000     .0437567    .0947876
 after_expat |   .0926364   .0182572     5.07   0.000     .0568495    .1284232
             |
    ind_year |
          2  |   .1183412    .025219     4.69   0.000     .0689083    .1677741
          3  |   .2599311   .0319968     8.12   0.000     .1972129    .3226493
          4  |   .4362237   .0352501    12.38   0.000     .3671284    .5053191
          5  |   .5904175   .0381691    15.47   0.000     .5156005    .6652345
          6  |   .7608166   .0421178    18.06   0.000     .6782596    .8433736
          7  |   .8977422   .0444642    20.19   0.000     .8105859    .9848985
          8  |    .980795   .0467278    20.99   0.000     .8892018    1.072388
          9  |   1.104632   .0494806    22.32   0.000     1.007643    1.201621
         10  |    1.19261   .0523994    22.76   0.000     1.089899     1.29532
         11  |   1.272933   .0549703    23.16   0.000     1.165184    1.380683
         12  |   1.291996   .0578857    22.32   0.000     1.178532     1.40546
         13  |   1.357601   .0609965    22.26   0.000     1.238039    1.477163
         14  |   1.403509   .0636219    22.06   0.000     1.278801    1.528217
         15  |   1.465831   .0662042    22.14   0.000     1.336061    1.595601
         16  |   1.493794   .0690669    21.63   0.000     1.358413    1.629175
         17  |   1.556749   .0720161    21.62   0.000     1.415587    1.697911
         18  |   1.498475   .0748723    20.01   0.000     1.351714    1.645235
         19  |   1.542476   .0774858    19.91   0.000     1.390593    1.694359
         20  |    1.58686   .0798481    19.87   0.000     1.430347    1.743374
         21  |   1.607748   .0821337    19.57   0.000     1.446754    1.768741
         22  |   1.666358   .0841684    19.80   0.000     1.501376     1.83134
         23  |   1.724556   .0867129    19.89   0.000     1.554586    1.894525
         24  |   1.758055   .0887546    19.81   0.000     1.584084    1.932027
         25  |   1.753085   .0914152    19.18   0.000     1.573898    1.932272
         26  |  -.4049642   .0633185    -6.40   0.000    -.5290775   -.2808509
         27  |  -.3033236   .0597301    -5.08   0.000    -.4204031   -.1862441
         28  |  -.0884707   .0577083    -1.53   0.125    -.2015874    .0246459
         29  |   .1145532   .0567152     2.02   0.043     .0033833     .225723
         30  |   .3350383   .0548137     6.11   0.000     .2275955     .442481
         31  |   .4988454   .0556904     8.96   0.000     .3896842    .6080067
         32  |   .6740839   .0565956    11.91   0.000     .5631484    .7850194
         33  |   .7542498   .0573908    13.14   0.000     .6417555    .8667441
         34  |   .8931943   .0593076    15.06   0.000     .7769429    1.009446
         35  |   .9896686   .0605843    16.34   0.000     .8709147    1.108423
         36  |   1.032127   .0618843    16.68   0.000     .9108253    1.153429
         37  |   1.124125   .0640681    17.55   0.000     .9985425    1.249708
         38  |   1.213673   .0662833    18.31   0.000     1.083748    1.343598
         39  |   1.282529   .0690605    18.57   0.000     1.147161    1.417898
         40  |   1.387888   .0713923    19.44   0.000     1.247948    1.527827
         41  |   1.450768   .0734772    19.74   0.000     1.306742    1.594794
         42  |   1.520542   .0756424    20.10   0.000     1.372272    1.668812
         43  |   1.503729   .0780689    19.26   0.000     1.350703    1.656755
         44  |   1.570567   .0808234    19.43   0.000     1.412141    1.728992
         45  |   1.652475   .0830277    19.90   0.000     1.489729    1.815221
         46  |    1.66852   .0856063    19.49   0.000      1.50072    1.836321
         47  |   1.710961   .0875088    19.55   0.000     1.539431    1.882491
         48  |   1.759605   .0892637    19.71   0.000     1.584635    1.934574
         49  |   1.757518   .0918935    19.13   0.000     1.577394    1.937643
         50  |   1.781546   .0938371    18.99   0.000     1.597612     1.96548
             |
     age_cat |
          1  |    .620332   .0278325    22.29   0.000     .5657762    .6748877
          2  |   .6798585   .0297761    22.83   0.000     .6214931    .7382239
          3  |   .6906145    .031879    21.66   0.000     .6281272    .7531019
          4  |   .6978893   .0336388    20.75   0.000     .6319524    .7638262
          5  |   .6818249   .0355133    19.20   0.000     .6122137    .7514361
          6  |    .664383   .0376052    17.67   0.000     .5906713    .7380946
          7  |   .6684808   .0398149    16.79   0.000     .5904378    .7465238
          8  |   .6506139   .0422602    15.40   0.000     .5677779      .73345
          9  |   .6443987    .044617    14.44   0.000      .556943    .7318545
         10  |   .6358549   .0471357    13.49   0.000      .543462    .7282477
         11  |   .6232691   .0500053    12.46   0.000     .5252515    .7212868
         12  |   .6109208   .0525941    11.62   0.000     .5078287    .7140129
         13  |   .5898905   .0553307    10.66   0.000     .4814343    .6983466
         14  |   .5903716   .0581442    10.15   0.000     .4764006    .7043426
         15  |   .5919708   .0608988     9.72   0.000     .4726005    .7113412
         16  |   .5629437   .0638258     8.82   0.000      .437836    .6880513
         17  |   .5437654   .0666354     8.16   0.000     .4131506    .6743803
         18  |   .5407473   .0693968     7.79   0.000     .4047197    .6767749
         19  |   .5116477   .0724998     7.06   0.000     .3695376    .6537578
         20  |   .4782026   .0777979     6.15   0.000     .3257075    .6306976
         25  |   .4480501    .086314     5.19   0.000     .2788623    .6172379
         30  |   .4621458     .10638     4.34   0.000     .2536257     .670666
         40  |   .4670203   .1189845     3.93   0.000     .2337936     .700247
         50  |   .4714295    .136411     3.46   0.001     .2040443    .7388146
             |
       _cons |   7.272641   .0503638   144.40   0.000     7.173921    7.371361
-------------+----------------------------------------------------------------
     sigma_u |  1.2839919
     sigma_e |  .58986564
         rho |  .82573096   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    353439
Group variable: firm_person                     Number of groups   =     41042

R-sq:  within  = 0.0318                         Obs per group: min =         1
       between = 0.1728                                        avg =       8.6
       overall = 0.1077                                        max =        18

                                                F(78,13202)        =     18.60
corr(u_i, Xb)  = 0.2363                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0255338   .0108891     2.34   0.019     .0041896     .046878
      during |  -.0070635   .0030916    -2.28   0.022    -.0131234   -.0010035
       after |  -.0080668   .0052237    -1.54   0.123     -.018306    .0021724
during_expat |   .0141453   .0055547     2.55   0.011     .0032574    .0250332
 after_expat |   .0130543    .007582     1.72   0.085    -.0018075     .027916
             |
    ind_year |
          2  |  -.0143884    .011777    -1.22   0.222     -.037473    .0086962
          3  |  -.0346172    .013724    -2.52   0.012    -.0615181   -.0077162
          4  |  -.0425454   .0151489    -2.81   0.005    -.0722393   -.0128515
          5  |  -.0424498   .0163114    -2.60   0.009    -.0744226   -.0104771
          6  |  -.0732772   .0172019    -4.26   0.000    -.1069955   -.0395589
          7  |  -.0675737   .0178207    -3.79   0.000    -.1025048   -.0326427
          8  |  -.0853254   .0187536    -4.55   0.000    -.1220852   -.0485655
          9  |  -.0867553   .0199617    -4.35   0.000    -.1258831   -.0476275
         10  |  -.0865848   .0207755    -4.17   0.000    -.1273077   -.0458619
         11  |  -.0939587   .0218249    -4.31   0.000    -.1367387   -.0511787
         12  |  -.1004249   .0229022    -4.38   0.000    -.1453165   -.0555332
         13  |  -.0951073    .024045    -3.96   0.000    -.1422389   -.0479757
         14  |  -.0888233   .0250113    -3.55   0.000     -.137849   -.0397976
         15  |  -.0818449    .026055    -3.14   0.002    -.1329164   -.0307735
         16  |  -.0627199   .0270685    -2.32   0.021     -.115778   -.0096618
         17  |  -.0493119    .028229    -1.75   0.081    -.1046448    .0060209
         18  |  -.0382795   .0293135    -1.31   0.192    -.0957382    .0191793
         19  |   -.040529   .0303709    -1.33   0.182    -.1000603    .0190023
         20  |  -.0283943   .0314156    -0.90   0.366    -.0899734    .0331848
         21  |  -.0317945   .0323967    -0.98   0.326    -.0952967    .0317076
         22  |  -.0231613   .0333242    -0.70   0.487    -.0884815    .0421589
         23  |  -.0370053   .0341572    -1.08   0.279    -.1039583    .0299477
         24  |   -.114577   .0352219    -3.25   0.001     -.183617   -.0455371
         25  |  -.1454045   .0363992    -3.99   0.000    -.2167522   -.0740568
         26  |   .1480416    .026762     5.53   0.000     .0955842    .2004989
         27  |   .1149402    .025072     4.58   0.000     .0657954     .164085
         28  |   .1068534   .0234127     4.56   0.000     .0609611    .1527457
         29  |   .0869461   .0234484     3.71   0.000      .040984    .1329083
         30  |   .0954722   .0224628     4.25   0.000     .0514419    .1395025
         31  |   .0657456   .0227185     2.89   0.004     .0212141    .1102771
         32  |   .0584666   .0228238     2.56   0.010     .0137286    .1032046
         33  |   .0579351    .022815     2.54   0.011     .0132143    .1026558
         34  |   .0410242   .0234912     1.75   0.081    -.0050219    .0870704
         35  |   .0483278   .0239965     2.01   0.044     .0012912    .0953644
         36  |   .0341822   .0247181     1.38   0.167    -.0142688    .0826333
         37  |   .0273584   .0253323     1.08   0.280    -.0222965    .0770133
         38  |   .0272605    .026173     1.04   0.298    -.0240424    .0785634
         39  |   .0225236   .0270753     0.83   0.405    -.0305478    .0755951
         40  |   .0104441    .028018     0.37   0.709    -.0444752    .0653634
         41  |   .0216004   .0289879     0.75   0.456    -.0352201    .0784209
         42  |   .0197465   .0300185     0.66   0.511     -.039094    .0785871
         43  |   .0288939   .0311612     0.93   0.354    -.0321865    .0899743
         44  |   .0348213    .032081     1.09   0.278     -.028062    .0977046
         45  |   .0489519   .0331443     1.48   0.140    -.0160157    .1139194
         46  |   .0490533   .0343164     1.43   0.153    -.0182117    .1163183
         47  |   .0496099   .0353777     1.40   0.161    -.0197355    .1189552
         48  |   .0441559   .0362083     1.22   0.223    -.0268176    .1151294
         49  |   -.150621   .0376258    -4.00   0.000     -.224373   -.0768689
         50  |  -.1970681   .0387815    -5.08   0.000    -.2730853   -.1210508
             |
     age_cat |
          1  |   .0658967   .0075987     8.67   0.000     .0510022    .0807913
          2  |   .0932132   .0084656    11.01   0.000     .0766194    .1098069
          3  |   .1113738   .0092718    12.01   0.000     .0931998    .1295478
          4  |   .1375498    .010304    13.35   0.000     .1173526     .157747
          5  |   .1504069   .0113034    13.31   0.000     .1282505    .1725632
          6  |   .1550206   .0123794    12.52   0.000     .1307552    .1792861
          7  |   .1638541   .0134441    12.19   0.000     .1375017    .1902064
          8  |   .1752794   .0146344    11.98   0.000     .1465939    .2039649
          9  |   .1765664   .0158412    11.15   0.000     .1455153    .2076175
         10  |    .177537   .0170713    10.40   0.000     .1440747    .2109992
         11  |   .1857964   .0182567    10.18   0.000     .1500107    .2215821
         12  |   .1863011   .0194319     9.59   0.000     .1482118    .2243904
         13  |   .1858252    .020708     8.97   0.000     .1452347    .2264158
         14  |   .1919309   .0219265     8.75   0.000     .1489517      .23491
         15  |    .199893   .0231455     8.64   0.000     .1545246    .2452615
         16  |   .2112838   .0244646     8.64   0.000     .1633298    .2592379
         17  |   .2119012   .0257337     8.23   0.000     .1614595    .2623429
         18  |   .2041784   .0271212     7.53   0.000     .1510169    .2573399
         19  |   .1990039   .0284286     7.00   0.000     .1432798     .254728
         20  |   .2038036      .0305     6.68   0.000     .1440191     .263588
         25  |   .1985155   .0348808     5.69   0.000      .130144    .2668869
         30  |    .222492   .0446804     4.98   0.000      .134912    .3100719
         40  |   .2031689   .0517097     3.93   0.000     .1018105    .3045273
         50  |   .1934836   .0586499     3.30   0.001     .0785213    .3084459
             |
       _cons |   .2978715   .0178817    16.66   0.000     .2628208    .3329221
-------------+----------------------------------------------------------------
     sigma_u |  .41245729
     sigma_e |  .27124711
         rho |  .69808699   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0318451450283466

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    353,439
Group variable: firm_person                     Number of groups  =     41,042

R-sq:                                           Obs per group:
     within  = 0.0318                                         min =          1
     between = 0.1728                                         avg =        8.6
     overall = 0.1077                                         max =         18

                                                F(78,13202)       =      18.60
corr(u_i, Xb)  = 0.2363                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0255338   .0108891     2.34   0.019     .0041896     .046878
      during |  -.0070635   .0030916    -2.28   0.022    -.0131234   -.0010035
       after |  -.0080668   .0052237    -1.54   0.123     -.018306    .0021724
during_expat |   .0141453   .0055547     2.55   0.011     .0032574    .0250332
 after_expat |   .0130543    .007582     1.72   0.085    -.0018075     .027916
             |
    ind_year |
          2  |  -.0143884    .011777    -1.22   0.222     -.037473    .0086962
          3  |  -.0346172    .013724    -2.52   0.012    -.0615181   -.0077162
          4  |  -.0425454   .0151489    -2.81   0.005    -.0722393   -.0128515
          5  |  -.0424498   .0163114    -2.60   0.009    -.0744226   -.0104771
          6  |  -.0732772   .0172019    -4.26   0.000    -.1069955   -.0395589
          7  |  -.0675737   .0178207    -3.79   0.000    -.1025048   -.0326427
          8  |  -.0853254   .0187536    -4.55   0.000    -.1220852   -.0485655
          9  |  -.0867553   .0199617    -4.35   0.000    -.1258831   -.0476275
         10  |  -.0865848   .0207755    -4.17   0.000    -.1273077   -.0458619
         11  |  -.0939587   .0218249    -4.31   0.000    -.1367387   -.0511787
         12  |  -.1004249   .0229022    -4.38   0.000    -.1453165   -.0555332
         13  |  -.0951073    .024045    -3.96   0.000    -.1422389   -.0479757
         14  |  -.0888233   .0250113    -3.55   0.000     -.137849   -.0397976
         15  |  -.0818449    .026055    -3.14   0.002    -.1329164   -.0307735
         16  |  -.0627199   .0270685    -2.32   0.021     -.115778   -.0096618
         17  |  -.0493119    .028229    -1.75   0.081    -.1046448    .0060209
         18  |  -.0382795   .0293135    -1.31   0.192    -.0957382    .0191793
         19  |   -.040529   .0303709    -1.33   0.182    -.1000603    .0190023
         20  |  -.0283943   .0314156    -0.90   0.366    -.0899734    .0331848
         21  |  -.0317945   .0323967    -0.98   0.326    -.0952967    .0317076
         22  |  -.0231613   .0333242    -0.70   0.487    -.0884815    .0421589
         23  |  -.0370053   .0341572    -1.08   0.279    -.1039583    .0299477
         24  |   -.114577   .0352219    -3.25   0.001     -.183617   -.0455371
         25  |  -.1454045   .0363992    -3.99   0.000    -.2167522   -.0740568
         26  |   .1480416    .026762     5.53   0.000     .0955842    .2004989
         27  |   .1149402    .025072     4.58   0.000     .0657954     .164085
         28  |   .1068534   .0234127     4.56   0.000     .0609611    .1527457
         29  |   .0869461   .0234484     3.71   0.000      .040984    .1329083
         30  |   .0954722   .0224628     4.25   0.000     .0514419    .1395025
         31  |   .0657456   .0227185     2.89   0.004     .0212141    .1102771
         32  |   .0584666   .0228238     2.56   0.010     .0137286    .1032046
         33  |   .0579351    .022815     2.54   0.011     .0132143    .1026558
         34  |   .0410242   .0234912     1.75   0.081    -.0050219    .0870704
         35  |   .0483278   .0239965     2.01   0.044     .0012912    .0953644
         36  |   .0341822   .0247181     1.38   0.167    -.0142688    .0826333
         37  |   .0273584   .0253323     1.08   0.280    -.0222965    .0770133
         38  |   .0272605    .026173     1.04   0.298    -.0240424    .0785634
         39  |   .0225236   .0270753     0.83   0.405    -.0305478    .0755951
         40  |   .0104441    .028018     0.37   0.709    -.0444752    .0653634
         41  |   .0216004   .0289879     0.75   0.456    -.0352201    .0784209
         42  |   .0197465   .0300185     0.66   0.511     -.039094    .0785871
         43  |   .0288939   .0311612     0.93   0.354    -.0321865    .0899743
         44  |   .0348213    .032081     1.09   0.278     -.028062    .0977046
         45  |   .0489519   .0331443     1.48   0.140    -.0160157    .1139194
         46  |   .0490533   .0343164     1.43   0.153    -.0182117    .1163183
         47  |   .0496099   .0353777     1.40   0.161    -.0197355    .1189552
         48  |   .0441559   .0362083     1.22   0.223    -.0268176    .1151294
         49  |   -.150621   .0376258    -4.00   0.000     -.224373   -.0768689
         50  |  -.1970681   .0387815    -5.08   0.000    -.2730853   -.1210508
             |
     age_cat |
          1  |   .0658967   .0075987     8.67   0.000     .0510022    .0807913
          2  |   .0932132   .0084656    11.01   0.000     .0766194    .1098069
          3  |   .1113738   .0092718    12.01   0.000     .0931998    .1295478
          4  |   .1375498    .010304    13.35   0.000     .1173526     .157747
          5  |   .1504069   .0113034    13.31   0.000     .1282505    .1725632
          6  |   .1550206   .0123794    12.52   0.000     .1307552    .1792861
          7  |   .1638541   .0134441    12.19   0.000     .1375017    .1902064
          8  |   .1752794   .0146344    11.98   0.000     .1465939    .2039649
          9  |   .1765664   .0158412    11.15   0.000     .1455153    .2076175
         10  |    .177537   .0170713    10.40   0.000     .1440747    .2109992
         11  |   .1857964   .0182567    10.18   0.000     .1500107    .2215821
         12  |   .1863011   .0194319     9.59   0.000     .1482118    .2243904
         13  |   .1858252    .020708     8.97   0.000     .1452347    .2264158
         14  |   .1919309   .0219265     8.75   0.000     .1489517      .23491
         15  |    .199893   .0231455     8.64   0.000     .1545246    .2452615
         16  |   .2112838   .0244646     8.64   0.000     .1633298    .2592379
         17  |   .2119012   .0257337     8.23   0.000     .1614595    .2623429
         18  |   .2041784   .0271212     7.53   0.000     .1510169    .2573399
         19  |   .1990039   .0284286     7.00   0.000     .1432798     .254728
         20  |   .2038036      .0305     6.68   0.000     .1440191     .263588
         25  |   .1985155   .0348808     5.69   0.000      .130144    .2668869
         30  |    .222492   .0446804     4.98   0.000      .134912    .3100719
         40  |   .2031689   .0517097     3.93   0.000     .1018105    .3045273
         50  |   .1934836   .0586499     3.30   0.001     .0785213    .3084459
             |
       _cons |   .2978715   .0178817    16.66   0.000     .2628208    .3329221
-------------+----------------------------------------------------------------
     sigma_u |  .41245729
     sigma_e |  .27124711
         rho |  .69808699   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    298141
Group variable: firm_person                     Number of groups   =     39636

R-sq:  within  = 0.0328                         Obs per group: min =         1
       between = 0.0137                                        avg =       7.5
       overall = 0.0186                                        max =        18

                                                F(75,12404)        =     45.70
corr(u_i, Xb)  = -0.2743                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 12,405 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0020239   .0278247     0.07   0.942    -.0525168    .0565646
      during |   .0138077   .0090831     1.52   0.128    -.0039965    .0316119
       after |    .029333   .0143491     2.04   0.041     .0012066    .0574595
during_expat |   .0072486   .0144481     0.50   0.616     -.021072    .0355692
 after_expat |   .0228639   .0176836     1.29   0.196    -.0117987    .0575264
             |
    ind_year |
          3  |  -.1112014   .0422643    -2.63   0.009     -.194046   -.0283569
          4  |  -.0320794   .0426462    -0.75   0.452    -.1156725    .0515138
          5  |  -.0570934   .0450372    -1.27   0.205    -.1453733    .0311865
          6  |  -.0996703   .0458886    -2.17   0.030    -.1896192   -.0097214
          7  |   .0084792   .0469634     0.18   0.857    -.0835762    .1005347
          8  |  -.1372333   .0493796    -2.78   0.005     -.234025   -.0404416
          9  |  -.1459365    .050941    -2.86   0.004    -.2457888   -.0460842
         10  |   -.159373   .0533427    -2.99   0.003    -.2639329    -.054813
         11  |  -.1257395   .0557273    -2.26   0.024    -.2349735   -.0165054
         12  |  -.1443812   .0582187    -2.48   0.013    -.2584989   -.0302635
         13  |  -.2463703   .0606553    -4.06   0.000    -.3652642   -.1274764
         14  |  -.3236263   .0633837    -5.11   0.000    -.4478681   -.1993845
         15  |  -.2251861   .0661026    -3.41   0.001    -.3547574   -.0956148
         16  |  -.2245368   .0691248    -3.25   0.001    -.3600321   -.0890415
         17  |  -.2506298   .0723086    -3.47   0.001     -.392366   -.1088937
         18  |  -.2162262   .0748019    -2.89   0.004    -.3628496   -.0696028
         19  |  -.2786336   .0779875    -3.57   0.000    -.4315013   -.1257659
         20  |  -.1913649   .0810607    -2.36   0.018    -.3502564   -.0324735
         21  |  -.3176394   .0838876    -3.79   0.000    -.4820722   -.1532066
         22  |  -.0193783   .0864114    -0.22   0.823     -.188758    .1500014
         23  |  -.3146586   .0893229    -3.52   0.000    -.4897453   -.1395718
         24  |  -.6840457   .0931983    -7.34   0.000    -.8667288   -.5013626
         25  |  -.2915756   .0990323    -2.94   0.003    -.4856942    -.097457
         27  |  -.1782505   .0656219    -2.72   0.007    -.3068795   -.0496214
         28  |  -.4709426   .0606928    -7.76   0.000    -.5899099   -.3519753
         29  |  -.3428815   .0577299    -5.94   0.000    -.4560412   -.2297219
         30  |  -.4369706   .0570782    -7.66   0.000    -.5488528   -.3250884
         31  |  -.2995605   .0566769    -5.29   0.000     -.410656   -.1884649
         32  |  -.3803739   .0568602    -6.69   0.000    -.4918287   -.2689191
         33  |  -.2626734   .0570128    -4.61   0.000    -.3744273   -.1509195
         34  |  -.3924975   .0581099    -6.75   0.000    -.5064018   -.2785932
         35  |  -.3652134   .0597633    -6.11   0.000    -.4823588   -.2480679
         36  |  -.3548629   .0614954    -5.77   0.000    -.4754033   -.2343224
         37  |  -.4357569   .0636466    -6.85   0.000     -.560514   -.3109997
         38  |  -.3607973   .0657763    -5.49   0.000     -.489729   -.2318655
         39  |  -.4582694   .0682132    -6.72   0.000    -.5919779   -.3245608
         40  |  -.4188258    .070737    -5.92   0.000    -.5574812   -.2801704
         41  |  -.4714784   .0737769    -6.39   0.000    -.6160925   -.3268642
         42  |  -.4144705    .076294    -5.43   0.000    -.5640186   -.2649224
         43  |  -.3176582   .0790047    -4.02   0.000    -.4725196   -.1627968
         44  |  -.3856818   .0819545    -4.71   0.000    -.5463253   -.2250383
         45  |  -.6031813   .0848719    -7.11   0.000    -.7695434   -.4368192
         46  |  -.4656446   .0874503    -5.32   0.000    -.6370608   -.2942284
         47  |  -.2524451   .0904011    -2.79   0.005    -.4296453   -.0752448
         48  |  -.5868097   .0928574    -6.32   0.000    -.7688246   -.4047947
         49  |  -1.076572   .0957904   -11.24   0.000    -1.264336   -.8888082
         50  |  -.4928674   .1037591    -4.75   0.000    -.6962514   -.2894834
             |
     age_cat |
          2  |  -.1513662   .0280526    -5.40   0.000    -.2063537   -.0963787
          3  |  -.3230735    .028906   -11.18   0.000    -.3797337   -.2664132
          4  |  -.3700282   .0300894   -12.30   0.000    -.4290082   -.3110483
          5  |  -.4363227   .0319529   -13.66   0.000    -.4989553   -.3736901
          6  |  -.4462694   .0337431   -13.23   0.000    -.5124112   -.3801276
          7  |  -.5122978   .0361212   -14.18   0.000    -.5831009   -.4414947
          8  |  -.5022146   .0387337   -12.97   0.000    -.5781387   -.4262904
          9  |  -.5312642     .04135   -12.85   0.000    -.6123167   -.4502117
         10  |  -.5539379   .0442612   -12.52   0.000    -.6406967   -.4671791
         11  |   -.533457   .0472766   -11.28   0.000    -.6261266   -.4407875
         12  |  -.5406067   .0502729   -10.75   0.000    -.6391494    -.442064
         13  |  -.5917854   .0533499   -11.09   0.000    -.6963594   -.4872114
         14  |  -.5716843   .0565178   -10.12   0.000    -.6824681   -.4609006
         15  |  -.5760978   .0594554    -9.69   0.000    -.6926396   -.4595559
         16  |  -.5891694   .0628041    -9.38   0.000    -.7122752   -.4660636
         17  |  -.5846243    .065865    -8.88   0.000      -.71373   -.4555186
         18  |  -.6045254   .0694494    -8.70   0.000    -.7406571   -.4683937
         19  |   -.589925    .072901    -8.09   0.000    -.7328223   -.4470276
         20  |  -.6236081   .0791386    -7.88   0.000     -.778732   -.4684842
         25  |  -.6438554   .0947875    -6.79   0.000    -.8296536   -.4580573
         30  |  -.6581219   .1185181    -5.55   0.000    -.8904357   -.4258081
         40  |  -.6646689   .1415924    -4.69   0.000     -.942212   -.3871258
         50  |  -.7116154   .1686674    -4.22   0.000     -1.04223   -.3810011
             |
       _cons |    .636608   .0488089    13.04   0.000      .540935    .7322811
-------------+----------------------------------------------------------------
     sigma_u |  .43112963
     sigma_e |   .8552039
         rho |  .20264211   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0327518373256308

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    298,141
Group variable: firm_person                     Number of groups  =     39,636

R-sq:                                           Obs per group:
     within  = 0.0328                                         min =          1
     between = 0.0137                                         avg =        7.5
     overall = 0.0186                                         max =         18

                                                F(75,12404)       =      45.70
corr(u_i, Xb)  = -0.2743                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 12,405 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0020239   .0278247     0.07   0.942    -.0525168    .0565646
      during |   .0138077   .0090831     1.52   0.128    -.0039965    .0316119
       after |    .029333   .0143491     2.04   0.041     .0012066    .0574595
during_expat |   .0072486   .0144481     0.50   0.616     -.021072    .0355692
 after_expat |   .0228639   .0176836     1.29   0.196    -.0117987    .0575264
             |
    ind_year |
          3  |  -.1112014   .0422643    -2.63   0.009     -.194046   -.0283569
          4  |  -.0320794   .0426462    -0.75   0.452    -.1156725    .0515138
          5  |  -.0570934   .0450372    -1.27   0.205    -.1453733    .0311865
          6  |  -.0996703   .0458886    -2.17   0.030    -.1896192   -.0097214
          7  |   .0084792   .0469634     0.18   0.857    -.0835762    .1005347
          8  |  -.1372333   .0493796    -2.78   0.005     -.234025   -.0404416
          9  |  -.1459365    .050941    -2.86   0.004    -.2457888   -.0460842
         10  |   -.159373   .0533427    -2.99   0.003    -.2639329    -.054813
         11  |  -.1257395   .0557273    -2.26   0.024    -.2349735   -.0165054
         12  |  -.1443812   .0582187    -2.48   0.013    -.2584989   -.0302635
         13  |  -.2463703   .0606553    -4.06   0.000    -.3652642   -.1274764
         14  |  -.3236263   .0633837    -5.11   0.000    -.4478681   -.1993845
         15  |  -.2251861   .0661026    -3.41   0.001    -.3547574   -.0956148
         16  |  -.2245368   .0691248    -3.25   0.001    -.3600321   -.0890415
         17  |  -.2506298   .0723086    -3.47   0.001     -.392366   -.1088937
         18  |  -.2162262   .0748019    -2.89   0.004    -.3628496   -.0696028
         19  |  -.2786336   .0779875    -3.57   0.000    -.4315013   -.1257659
         20  |  -.1913649   .0810607    -2.36   0.018    -.3502564   -.0324735
         21  |  -.3176394   .0838876    -3.79   0.000    -.4820722   -.1532066
         22  |  -.0193783   .0864114    -0.22   0.823     -.188758    .1500014
         23  |  -.3146586   .0893229    -3.52   0.000    -.4897453   -.1395718
         24  |  -.6840457   .0931983    -7.34   0.000    -.8667288   -.5013626
         25  |  -.2915756   .0990323    -2.94   0.003    -.4856942    -.097457
         27  |  -.1782505   .0656219    -2.72   0.007    -.3068795   -.0496214
         28  |  -.4709426   .0606928    -7.76   0.000    -.5899099   -.3519753
         29  |  -.3428815   .0577299    -5.94   0.000    -.4560412   -.2297219
         30  |  -.4369706   .0570782    -7.66   0.000    -.5488528   -.3250884
         31  |  -.2995605   .0566769    -5.29   0.000     -.410656   -.1884649
         32  |  -.3803739   .0568602    -6.69   0.000    -.4918287   -.2689191
         33  |  -.2626734   .0570128    -4.61   0.000    -.3744273   -.1509195
         34  |  -.3924975   .0581099    -6.75   0.000    -.5064018   -.2785932
         35  |  -.3652134   .0597633    -6.11   0.000    -.4823588   -.2480679
         36  |  -.3548629   .0614954    -5.77   0.000    -.4754033   -.2343224
         37  |  -.4357569   .0636466    -6.85   0.000     -.560514   -.3109997
         38  |  -.3607973   .0657763    -5.49   0.000     -.489729   -.2318655
         39  |  -.4582694   .0682132    -6.72   0.000    -.5919779   -.3245608
         40  |  -.4188258    .070737    -5.92   0.000    -.5574812   -.2801704
         41  |  -.4714784   .0737769    -6.39   0.000    -.6160925   -.3268642
         42  |  -.4144705    .076294    -5.43   0.000    -.5640186   -.2649224
         43  |  -.3176582   .0790047    -4.02   0.000    -.4725196   -.1627968
         44  |  -.3856818   .0819545    -4.71   0.000    -.5463253   -.2250383
         45  |  -.6031813   .0848719    -7.11   0.000    -.7695434   -.4368192
         46  |  -.4656446   .0874503    -5.32   0.000    -.6370608   -.2942284
         47  |  -.2524451   .0904011    -2.79   0.005    -.4296453   -.0752448
         48  |  -.5868097   .0928574    -6.32   0.000    -.7688246   -.4047947
         49  |  -1.076572   .0957904   -11.24   0.000    -1.264336   -.8888082
         50  |  -.4928674   .1037591    -4.75   0.000    -.6962514   -.2894834
             |
     age_cat |
          2  |  -.1513662   .0280526    -5.40   0.000    -.2063537   -.0963787
          3  |  -.3230735    .028906   -11.18   0.000    -.3797337   -.2664132
          4  |  -.3700282   .0300894   -12.30   0.000    -.4290082   -.3110483
          5  |  -.4363227   .0319529   -13.66   0.000    -.4989553   -.3736901
          6  |  -.4462694   .0337431   -13.23   0.000    -.5124112   -.3801276
          7  |  -.5122978   .0361212   -14.18   0.000    -.5831009   -.4414947
          8  |  -.5022146   .0387337   -12.97   0.000    -.5781387   -.4262904
          9  |  -.5312642     .04135   -12.85   0.000    -.6123167   -.4502117
         10  |  -.5539379   .0442612   -12.52   0.000    -.6406967   -.4671791
         11  |   -.533457   .0472766   -11.28   0.000    -.6261266   -.4407875
         12  |  -.5406067   .0502729   -10.75   0.000    -.6391494    -.442064
         13  |  -.5917854   .0533499   -11.09   0.000    -.6963594   -.4872114
         14  |  -.5716843   .0565178   -10.12   0.000    -.6824681   -.4609006
         15  |  -.5760978   .0594554    -9.69   0.000    -.6926396   -.4595559
         16  |  -.5891694   .0628041    -9.38   0.000    -.7122752   -.4660636
         17  |  -.5846243    .065865    -8.88   0.000      -.71373   -.4555186
         18  |  -.6045254   .0694494    -8.70   0.000    -.7406571   -.4683937
         19  |   -.589925    .072901    -8.09   0.000    -.7328223   -.4470276
         20  |  -.6236081   .0791386    -7.88   0.000     -.778732   -.4684842
         25  |  -.6438554   .0947875    -6.79   0.000    -.8296536   -.4580573
         30  |  -.6581219   .1185181    -5.55   0.000    -.8904357   -.4258081
         40  |  -.6646689   .1415924    -4.69   0.000     -.942212   -.3871258
         50  |  -.7116154   .1686674    -4.22   0.000     -1.04223   -.3810011
             |
       _cons |    .636608   .0488089    13.04   0.000      .540935    .7322811
-------------+----------------------------------------------------------------
     sigma_u |  .43112963
     sigma_e |   .8552039
         rho |  .20264211   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    110609
Group variable: firm_person                     Number of groups   =     14091

R-sq:  within  = 0.0780                         Obs per group: min =         1
       between = 0.0294                                        avg =       7.8
       overall = 0.0380                                        max =        18

                                                F(53,4770)         =     14.70
corr(u_i, Xb)  = -0.0974                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,771 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0518935   .0465877     1.11   0.265    -.0394398    .1432268
      during |  -.0843043   .0129469    -6.51   0.000    -.1096862   -.0589224
       after |  -.1346638   .0254931    -5.28   0.000     -.184642   -.0846856
during_expat |   .0890545   .0227523     3.91   0.000     .0444494    .1336596
 after_expat |   .1698646   .0364628     4.66   0.000     .0983807    .2413485
             |
    ind_year |
         27  |  -.2417996   .0285121    -8.48   0.000    -.2976965   -.1859026
         28  |  -.3811673   .0398633    -9.56   0.000    -.4593176   -.3030169
         29  |  -.5199418    .048216   -10.78   0.000    -.6144674   -.4254162
         30  |  -.6002766   .0535604   -11.21   0.000    -.7052796   -.4952736
         31  |  -.6826518   .0617735   -11.05   0.000    -.8037565   -.5615472
         32  |  -.7563367   .0677198   -11.17   0.000    -.8890988   -.6235746
         33  |  -.8344553    .073542   -11.35   0.000    -.9786315   -.6902791
         34  |  -.8965391   .0798601   -11.23   0.000    -1.053102   -.7399764
         35  |  -.9701188   .0860474   -11.27   0.000    -1.138811   -.8014262
         36  |  -1.073381   .0914182   -11.74   0.000    -1.252603   -.8941594
         37  |  -1.166207   .0965913   -12.07   0.000     -1.35557   -.9768433
         38  |  -1.269686   .1029171   -12.34   0.000    -1.471451   -1.067921
         39  |  -1.368679     .10932   -12.52   0.000    -1.582996   -1.154361
         40  |  -1.417404   .1149649   -12.33   0.000    -1.642788    -1.19202
         41  |  -1.447069   .1206485   -11.99   0.000    -1.683596   -1.210542
         42  |  -1.514011     .12635   -11.98   0.000    -1.761716   -1.266307
         43  |  -1.674674   .1325092   -12.64   0.000    -1.934453   -1.414895
         44  |    -1.7348   .1383541   -12.54   0.000    -2.006038   -1.463562
         45  |  -1.735766   .1429649   -12.14   0.000    -2.016043   -1.455489
         46  |  -1.770043   .1481064   -11.95   0.000      -2.0604   -1.479686
         47  |   -1.78918   .1525518   -11.73   0.000    -2.088252   -1.490108
         48  |  -1.796626   .1571346   -11.43   0.000    -2.104683    -1.48857
         49  |  -1.784814   .1612574   -11.07   0.000    -2.100953   -1.468675
         50  |  -1.782572   .1662011   -10.73   0.000    -2.108403   -1.456741
             |
     age_cat |
          1  |   .4251192   .0389031    10.93   0.000     .3488513    .5013872
          2  |   .7972469   .0457337    17.43   0.000     .7075878     .886906
          3  |   1.002284   .0522716    19.17   0.000      .899808    1.104761
          4  |   1.156257   .0575797    20.08   0.000     1.043374    1.269139
          5  |   1.275491   .0629136    20.27   0.000     1.152151     1.39883
          6  |   1.389776   .0682795    20.35   0.000     1.255916    1.523635
          7  |   1.489554   .0734126    20.29   0.000     1.345631    1.633476
          8  |   1.578349   .0785545    20.09   0.000     1.424346    1.732352
          9  |   1.652638   .0836601    19.75   0.000     1.488626    1.816651
         10  |   1.718768   .0883855    19.45   0.000     1.545492    1.892044
         11  |   1.786828   .0936033    19.09   0.000     1.603322    1.970333
         12  |   1.825739    .099095    18.42   0.000     1.631468    2.020011
         13  |   1.878728   .1043511    18.00   0.000     1.674151    2.083304
         14  |   1.917684   .1097958    17.47   0.000     1.702433    2.132934
         15  |   1.977686   .1154204    17.13   0.000     1.751409    2.203964
         16  |   2.020632   .1213641    16.65   0.000     1.782702    2.258562
         17  |   2.062136   .1271225    16.22   0.000     1.812917    2.311355
         18  |   2.074708   .1330253    15.60   0.000     1.813917    2.335499
         19  |   2.105761   .1384781    15.21   0.000      1.83428    2.377242
         20  |   2.158891   .1477986    14.61   0.000     1.869138    2.448645
         25  |   2.190491   .1628053    13.45   0.000     1.871318    2.509665
         30  |   2.154716   .2057944    10.47   0.000     1.751264    2.558168
         40  |   1.993079   .2451736     8.13   0.000     1.512426    2.473733
         50  |   2.027044   .2599977     7.80   0.000     1.517329     2.53676
             |
       _cons |   3.900474   .0649339    60.07   0.000     3.773174    4.027774
-------------+----------------------------------------------------------------
     sigma_u |   1.388279
     sigma_e |   .5629508
         rho |  .85878752   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0779812739116467

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    110,609
Group variable: firm_person                     Number of groups  =     14,091

R-sq:                                           Obs per group:
     within  = 0.0780                                         min =          1
     between = 0.0294                                         avg =        7.8
     overall = 0.0380                                         max =         18

                                                F(53,4770)        =      14.70
corr(u_i, Xb)  = -0.0974                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,771 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0518935   .0465877     1.11   0.265    -.0394398    .1432268
      during |  -.0843043   .0129469    -6.51   0.000    -.1096862   -.0589224
       after |  -.1346638   .0254931    -5.28   0.000     -.184642   -.0846856
during_expat |   .0890545   .0227523     3.91   0.000     .0444494    .1336596
 after_expat |   .1698646   .0364628     4.66   0.000     .0983807    .2413485
             |
    ind_year |
         27  |  -.2417996   .0285121    -8.48   0.000    -.2976965   -.1859026
         28  |  -.3811673   .0398633    -9.56   0.000    -.4593176   -.3030169
         29  |  -.5199418    .048216   -10.78   0.000    -.6144674   -.4254162
         30  |  -.6002766   .0535604   -11.21   0.000    -.7052796   -.4952736
         31  |  -.6826518   .0617735   -11.05   0.000    -.8037565   -.5615472
         32  |  -.7563367   .0677198   -11.17   0.000    -.8890988   -.6235746
         33  |  -.8344553    .073542   -11.35   0.000    -.9786315   -.6902791
         34  |  -.8965391   .0798601   -11.23   0.000    -1.053102   -.7399764
         35  |  -.9701188   .0860474   -11.27   0.000    -1.138811   -.8014262
         36  |  -1.073381   .0914182   -11.74   0.000    -1.252603   -.8941594
         37  |  -1.166207   .0965913   -12.07   0.000     -1.35557   -.9768433
         38  |  -1.269686   .1029171   -12.34   0.000    -1.471451   -1.067921
         39  |  -1.368679     .10932   -12.52   0.000    -1.582996   -1.154361
         40  |  -1.417404   .1149649   -12.33   0.000    -1.642788    -1.19202
         41  |  -1.447069   .1206485   -11.99   0.000    -1.683596   -1.210542
         42  |  -1.514011     .12635   -11.98   0.000    -1.761716   -1.266307
         43  |  -1.674674   .1325092   -12.64   0.000    -1.934453   -1.414895
         44  |    -1.7348   .1383541   -12.54   0.000    -2.006038   -1.463562
         45  |  -1.735766   .1429649   -12.14   0.000    -2.016043   -1.455489
         46  |  -1.770043   .1481064   -11.95   0.000      -2.0604   -1.479686
         47  |   -1.78918   .1525518   -11.73   0.000    -2.088252   -1.490108
         48  |  -1.796626   .1571346   -11.43   0.000    -2.104683    -1.48857
         49  |  -1.784814   .1612574   -11.07   0.000    -2.100953   -1.468675
         50  |  -1.782572   .1662011   -10.73   0.000    -2.108403   -1.456741
             |
     age_cat |
          1  |   .4251192   .0389031    10.93   0.000     .3488513    .5013872
          2  |   .7972469   .0457337    17.43   0.000     .7075878     .886906
          3  |   1.002284   .0522716    19.17   0.000      .899808    1.104761
          4  |   1.156257   .0575797    20.08   0.000     1.043374    1.269139
          5  |   1.275491   .0629136    20.27   0.000     1.152151     1.39883
          6  |   1.389776   .0682795    20.35   0.000     1.255916    1.523635
          7  |   1.489554   .0734126    20.29   0.000     1.345631    1.633476
          8  |   1.578349   .0785545    20.09   0.000     1.424346    1.732352
          9  |   1.652638   .0836601    19.75   0.000     1.488626    1.816651
         10  |   1.718768   .0883855    19.45   0.000     1.545492    1.892044
         11  |   1.786828   .0936033    19.09   0.000     1.603322    1.970333
         12  |   1.825739    .099095    18.42   0.000     1.631468    2.020011
         13  |   1.878728   .1043511    18.00   0.000     1.674151    2.083304
         14  |   1.917684   .1097958    17.47   0.000     1.702433    2.132934
         15  |   1.977686   .1154204    17.13   0.000     1.751409    2.203964
         16  |   2.020632   .1213641    16.65   0.000     1.782702    2.258562
         17  |   2.062136   .1271225    16.22   0.000     1.812917    2.311355
         18  |   2.074708   .1330253    15.60   0.000     1.813917    2.335499
         19  |   2.105761   .1384781    15.21   0.000      1.83428    2.377242
         20  |   2.158891   .1477986    14.61   0.000     1.869138    2.448645
         25  |   2.190491   .1628053    13.45   0.000     1.871318    2.509665
         30  |   2.154716   .2057944    10.47   0.000     1.751264    2.558168
         40  |   1.993079   .2451736     8.13   0.000     1.512426    2.473733
         50  |   2.027044   .2599977     7.80   0.000     1.517329     2.53676
             |
       _cons |   3.900474   .0649339    60.07   0.000     3.773174    4.027774
-------------+----------------------------------------------------------------
     sigma_u |   1.388279
     sigma_e |   .5629508
         rho |  .85878752   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    103109
Group variable: firm_person                     Number of groups   =     13872

R-sq:  within  = 0.0781                         Obs per group: min =         1
       between = 0.0474                                        avg =       7.4
       overall = 0.0407                                        max =        18

                                                F(53,4645)         =     13.58
corr(u_i, Xb)  = 0.0418                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,646 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1156878   .0821448     1.41   0.159    -.0453549    .2767306
      during |  -.0530694   .0210674    -2.52   0.012    -.0943715   -.0117673
       after |  -.0805582   .0364679    -2.21   0.027    -.1520527   -.0090637
during_expat |  -.0149811   .0352041    -0.43   0.670     -.083998    .0540357
 after_expat |   .0075328   .0500991     0.15   0.880    -.0906852    .1057509
             |
    ind_year |
         27  |   -.129929   .0548604    -2.37   0.018    -.2374814   -.0223767
         28  |   -.064453   .0694106    -0.93   0.353    -.2005307    .0716247
         29  |  -.1426642   .0825099    -1.73   0.084    -.3044229    .0190944
         30  |  -.1306301    .092948    -1.41   0.160    -.3128522     .051592
         31  |   -.121883   .1043516    -1.17   0.243    -.3264617    .0826957
         32  |  -.0009476   .1145717    -0.01   0.993    -.2255625    .2236673
         33  |   .0263189   .1252641     0.21   0.834    -.2192582     .271896
         34  |   .0167075   .1360692     0.12   0.902    -.2500526    .2834677
         35  |   .0012735   .1473507     0.01   0.993    -.2876038    .2901508
         36  |   -.006652    .158714    -0.04   0.967    -.3178068    .3045027
         37  |  -.0160896   .1696175    -0.09   0.924    -.3486204    .3164412
         38  |   -.078745   .1806826    -0.44   0.663    -.4329687    .2754787
         39  |  -.1267748   .1912548    -0.66   0.507     -.501725    .2481754
         40  |  -.1662443   .2028751    -0.82   0.413    -.5639759    .2314873
         41  |  -.1590892   .2142211    -0.74   0.458    -.5790642    .2608858
         42  |  -.1593018   .2258926    -0.71   0.481    -.6021586    .2835549
         43  |  -.2532269   .2372882    -1.07   0.286    -.7184244    .2119705
         44  |  -.3285134   .2495297    -1.32   0.188    -.8177102    .1606833
         45  |  -.2884704   .2597016    -1.11   0.267    -.7976089    .2206681
         46  |  -.3284998     .26914    -1.22   0.222    -.8561419    .1991423
         47  |  -.2793091    .277646    -1.01   0.314     -.823627    .2650089
         48  |   -.231618   .2872045    -0.81   0.420    -.7946752    .3314393
         49  |  -.4393346   .2972626    -1.48   0.139     -1.02211    .1434412
         50  |  -.3388853   .3063931    -1.11   0.269    -.9395613    .2617907
             |
     age_cat |
          1  |   .5157847   .0718079     7.18   0.000     .3750072    .6565623
          2  |   .9759993   .0841286    11.60   0.000     .8110673    1.140931
          3  |   1.220483   .0918754    13.28   0.000     1.040363    1.400602
          4  |   1.422748   .1007503    14.12   0.000      1.22523    1.620267
          5  |   1.506606   .1105626    13.63   0.000     1.289851    1.723361
          6  |   1.617369   .1200357    13.47   0.000     1.382042    1.852696
          7  |   1.684913   .1294785    13.01   0.000     1.431074    1.938752
          8  |   1.785908   .1385879    12.89   0.000      1.51421    2.057606
          9  |   1.864652    .148153    12.59   0.000     1.574202    2.155102
         10  |   1.916167   .1584138    12.10   0.000       1.6056    2.226733
         11  |   1.971343   .1689964    11.66   0.000     1.640029    2.302656
         12  |   2.030631   .1799793    11.28   0.000     1.677786    2.383476
         13  |   2.063987   .1908072    10.82   0.000     1.689914    2.438059
         14  |    2.13278   .2014193    10.59   0.000     1.737903    2.527658
         15  |   2.162019   .2126632    10.17   0.000     1.745098     2.57894
         16  |     2.1792   .2244947     9.71   0.000     1.739084    2.619316
         17  |   2.167217   .2355554     9.20   0.000     1.705416    2.629017
         18  |   2.196909   .2469554     8.90   0.000     1.712759    2.681059
         19  |   2.240108   .2582321     8.67   0.000      1.73385    2.746366
         20  |   2.278318   .2781328     8.19   0.000     1.733045     2.82359
         25  |   2.286547    .310479     7.36   0.000      1.67786    2.895233
         30  |   2.256917   .3803481     5.93   0.000     1.511254     3.00258
         40  |   1.656082   .4412755     3.75   0.000     .7909725    2.521191
         50  |   1.752587   .4835155     3.62   0.000     .8046673    2.700507
             |
       _cons |   9.179254   .1095379    83.80   0.000     8.964508       9.394
-------------+----------------------------------------------------------------
     sigma_u |  2.3638885
     sigma_e |  .86209053
         rho |   .8826125   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0781076002774915

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    103,109
Group variable: firm_person                     Number of groups  =     13,872

R-sq:                                           Obs per group:
     within  = 0.0781                                         min =          1
     between = 0.0474                                         avg =        7.4
     overall = 0.0407                                         max =         18

                                                F(53,4645)        =      13.58
corr(u_i, Xb)  = 0.0418                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,646 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1156878   .0821448     1.41   0.159    -.0453549    .2767306
      during |  -.0530694   .0210674    -2.52   0.012    -.0943715   -.0117673
       after |  -.0805582   .0364679    -2.21   0.027    -.1520527   -.0090637
during_expat |  -.0149811   .0352041    -0.43   0.670     -.083998    .0540357
 after_expat |   .0075328   .0500991     0.15   0.880    -.0906852    .1057509
             |
    ind_year |
         27  |   -.129929   .0548604    -2.37   0.018    -.2374814   -.0223767
         28  |   -.064453   .0694106    -0.93   0.353    -.2005307    .0716247
         29  |  -.1426642   .0825099    -1.73   0.084    -.3044229    .0190944
         30  |  -.1306301    .092948    -1.41   0.160    -.3128522     .051592
         31  |   -.121883   .1043516    -1.17   0.243    -.3264617    .0826957
         32  |  -.0009476   .1145717    -0.01   0.993    -.2255625    .2236673
         33  |   .0263189   .1252641     0.21   0.834    -.2192582     .271896
         34  |   .0167075   .1360692     0.12   0.902    -.2500526    .2834677
         35  |   .0012735   .1473507     0.01   0.993    -.2876038    .2901508
         36  |   -.006652    .158714    -0.04   0.967    -.3178068    .3045027
         37  |  -.0160896   .1696175    -0.09   0.924    -.3486204    .3164412
         38  |   -.078745   .1806826    -0.44   0.663    -.4329687    .2754787
         39  |  -.1267748   .1912548    -0.66   0.507     -.501725    .2481754
         40  |  -.1662443   .2028751    -0.82   0.413    -.5639759    .2314873
         41  |  -.1590892   .2142211    -0.74   0.458    -.5790642    .2608858
         42  |  -.1593018   .2258926    -0.71   0.481    -.6021586    .2835549
         43  |  -.2532269   .2372882    -1.07   0.286    -.7184244    .2119705
         44  |  -.3285134   .2495297    -1.32   0.188    -.8177102    .1606833
         45  |  -.2884704   .2597016    -1.11   0.267    -.7976089    .2206681
         46  |  -.3284998     .26914    -1.22   0.222    -.8561419    .1991423
         47  |  -.2793091    .277646    -1.01   0.314     -.823627    .2650089
         48  |   -.231618   .2872045    -0.81   0.420    -.7946752    .3314393
         49  |  -.4393346   .2972626    -1.48   0.139     -1.02211    .1434412
         50  |  -.3388853   .3063931    -1.11   0.269    -.9395613    .2617907
             |
     age_cat |
          1  |   .5157847   .0718079     7.18   0.000     .3750072    .6565623
          2  |   .9759993   .0841286    11.60   0.000     .8110673    1.140931
          3  |   1.220483   .0918754    13.28   0.000     1.040363    1.400602
          4  |   1.422748   .1007503    14.12   0.000      1.22523    1.620267
          5  |   1.506606   .1105626    13.63   0.000     1.289851    1.723361
          6  |   1.617369   .1200357    13.47   0.000     1.382042    1.852696
          7  |   1.684913   .1294785    13.01   0.000     1.431074    1.938752
          8  |   1.785908   .1385879    12.89   0.000      1.51421    2.057606
          9  |   1.864652    .148153    12.59   0.000     1.574202    2.155102
         10  |   1.916167   .1584138    12.10   0.000       1.6056    2.226733
         11  |   1.971343   .1689964    11.66   0.000     1.640029    2.302656
         12  |   2.030631   .1799793    11.28   0.000     1.677786    2.383476
         13  |   2.063987   .1908072    10.82   0.000     1.689914    2.438059
         14  |    2.13278   .2014193    10.59   0.000     1.737903    2.527658
         15  |   2.162019   .2126632    10.17   0.000     1.745098     2.57894
         16  |     2.1792   .2244947     9.71   0.000     1.739084    2.619316
         17  |   2.167217   .2355554     9.20   0.000     1.705416    2.629017
         18  |   2.196909   .2469554     8.90   0.000     1.712759    2.681059
         19  |   2.240108   .2582321     8.67   0.000      1.73385    2.746366
         20  |   2.278318   .2781328     8.19   0.000     1.733045     2.82359
         25  |   2.286547    .310479     7.36   0.000      1.67786    2.895233
         30  |   2.256917   .3803481     5.93   0.000     1.511254     3.00258
         40  |   1.656082   .4412755     3.75   0.000     .7909725    2.521191
         50  |   1.752587   .4835155     3.62   0.000     .8046673    2.700507
             |
       _cons |   9.179254   .1095379    83.80   0.000     8.964508       9.394
-------------+----------------------------------------------------------------
     sigma_u |  2.3638885
     sigma_e |  .86209053
         rho |   .8826125   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    110609
Group variable: firm_person                     Number of groups   =     14091

R-sq:  within  = 0.1991                         Obs per group: min =         1
       between = 0.1156                                        avg =       7.8
       overall = 0.1086                                        max =        18

                                                F(53,4770)         =     42.43
corr(u_i, Xb)  = 0.0850                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,771 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1114901    .059726     1.87   0.062    -.0056005    .2285807
      during |  -.1160938   .0159794    -7.27   0.000    -.1474208   -.0847668
       after |  -.1251813   .0292248    -4.28   0.000    -.1824753   -.0678873
during_expat |   .2211316   .0269568     8.20   0.000     .1682839    .2739794
 after_expat |   .3466103   .0410455     8.44   0.000     .2661422    .4270784
             |
    ind_year |
         27  |  -.1242999   .0408807    -3.04   0.002    -.2044449   -.0441548
         28  |  -.0692634   .0508804    -1.36   0.173    -.1690125    .0304857
         29  |  -.0192713   .0641705    -0.30   0.764    -.1450751    .1065325
         30  |   .0939675   .0674067     1.39   0.163    -.0381807    .2261158
         31  |   .1556877   .0773356     2.01   0.044     .0040743    .3073011
         32  |   .2364474   .0836139     2.83   0.005     .0725255    .4003693
         33  |   .2188289   .0913497     2.40   0.017     .0397413    .3979165
         34  |   .2952379   .0988153     2.99   0.003     .1015144    .4889614
         35  |   .3011241   .1057919     2.85   0.004     .0937231    .5085251
         36  |   .2196321   .1133812     1.94   0.053    -.0026474    .4419116
         37  |   .2022441   .1198634     1.69   0.092    -.0327434    .4372316
         38  |   .1754155   .1271557     1.38   0.168    -.0738683    .4246993
         39  |   .1280969   .1354962     0.95   0.345    -.1375383    .3937321
         40  |   .1770273   .1424284     1.24   0.214    -.1021982    .4562528
         41  |    .195134   .1490645     1.31   0.191    -.0971013    .4873693
         42  |   .1797852   .1563661     1.15   0.250    -.1267645     .486335
         43  |  -.0207937   .1633796    -0.13   0.899    -.3410932    .2995058
         44  |  -.0268799   .1710113    -0.16   0.875     -.362141    .3083812
         45  |   .0525753   .1770192     0.30   0.766     -.294464    .3996145
         46  |   .0173205   .1831142     0.09   0.925    -.3416677    .3763088
         47  |   .0339031   .1894209     0.18   0.858    -.3374493    .4052556
         48  |   .0764916   .1946065     0.39   0.694    -.3050269    .4580101
         49  |   .0718497   .2000229     0.36   0.719    -.3202875     .463987
         50  |   .0919229   .2058749     0.45   0.655     -.311687    .4955327
             |
     age_cat |
          1  |   1.078408   .0594743    18.13   0.000     .9618111    1.195005
          2  |   1.560525    .065052    23.99   0.000     1.432994    1.688057
          3  |   1.771659   .0720691    24.58   0.000      1.63037    1.912948
          4  |    1.96184   .0768976    25.51   0.000     1.811085    2.112595
          5  |   2.079483   .0831071    25.02   0.000     1.916555    2.242412
          6  |    2.20094   .0883707    24.91   0.000     2.027693    2.374187
          7  |   2.306351   .0948326    24.32   0.000     2.120435    2.492266
          8  |     2.3979   .1015552    23.61   0.000     2.198806    2.596995
          9  |   2.487637   .1073693    23.17   0.000     2.277144     2.69813
         10  |   2.549858   .1138302    22.40   0.000     2.326699    2.773018
         11  |   2.615067   .1201688    21.76   0.000      2.37948    2.850653
         12  |   2.649824   .1269828    20.87   0.000     2.400879    2.898769
         13  |   2.707005   .1332957    20.31   0.000     2.445684    2.968327
         14  |   2.737851   .1404037    19.50   0.000     2.462595    3.013107
         15  |   2.808095   .1472962    19.06   0.000     2.519327    3.096864
         16  |   2.851652   .1543744    18.47   0.000     2.549007    3.154297
         17  |   2.887902   .1612952    17.90   0.000     2.571689    3.204115
         18  |   2.927033   .1684322    17.38   0.000     2.596828    3.257238
         19  |   2.948526   .1747001    16.88   0.000     2.606034    3.291019
         20  |   2.993657   .1882702    15.90   0.000     2.624561    3.362754
         25  |   3.043576    .208064    14.63   0.000     2.635675    3.451478
         30  |   3.048575    .261763    11.65   0.000     2.535399    3.561752
         40  |   2.761233   .3198788     8.63   0.000     2.134123    3.388343
         50  |   2.816237   .3280286     8.59   0.000      2.17315    3.459325
             |
       _cons |   10.67074   .0857689   124.41   0.000     10.50259    10.83889
-------------+----------------------------------------------------------------
     sigma_u |  1.9781435
     sigma_e |  .70081618
         rho |  .88848284   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .199054694248269

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    110,609
Group variable: firm_person                     Number of groups  =     14,091

R-sq:                                           Obs per group:
     within  = 0.1991                                         min =          1
     between = 0.1156                                         avg =        7.8
     overall = 0.1086                                         max =         18

                                                F(53,4770)        =      42.43
corr(u_i, Xb)  = 0.0850                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,771 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1114901    .059726     1.87   0.062    -.0056005    .2285807
      during |  -.1160938   .0159794    -7.27   0.000    -.1474208   -.0847668
       after |  -.1251813   .0292248    -4.28   0.000    -.1824753   -.0678873
during_expat |   .2211316   .0269568     8.20   0.000     .1682839    .2739794
 after_expat |   .3466103   .0410455     8.44   0.000     .2661422    .4270784
             |
    ind_year |
         27  |  -.1242999   .0408807    -3.04   0.002    -.2044449   -.0441548
         28  |  -.0692634   .0508804    -1.36   0.173    -.1690125    .0304857
         29  |  -.0192713   .0641705    -0.30   0.764    -.1450751    .1065325
         30  |   .0939675   .0674067     1.39   0.163    -.0381807    .2261158
         31  |   .1556877   .0773356     2.01   0.044     .0040743    .3073011
         32  |   .2364474   .0836139     2.83   0.005     .0725255    .4003693
         33  |   .2188289   .0913497     2.40   0.017     .0397413    .3979165
         34  |   .2952379   .0988153     2.99   0.003     .1015144    .4889614
         35  |   .3011241   .1057919     2.85   0.004     .0937231    .5085251
         36  |   .2196321   .1133812     1.94   0.053    -.0026474    .4419116
         37  |   .2022441   .1198634     1.69   0.092    -.0327434    .4372316
         38  |   .1754155   .1271557     1.38   0.168    -.0738683    .4246993
         39  |   .1280969   .1354962     0.95   0.345    -.1375383    .3937321
         40  |   .1770273   .1424284     1.24   0.214    -.1021982    .4562528
         41  |    .195134   .1490645     1.31   0.191    -.0971013    .4873693
         42  |   .1797852   .1563661     1.15   0.250    -.1267645     .486335
         43  |  -.0207937   .1633796    -0.13   0.899    -.3410932    .2995058
         44  |  -.0268799   .1710113    -0.16   0.875     -.362141    .3083812
         45  |   .0525753   .1770192     0.30   0.766     -.294464    .3996145
         46  |   .0173205   .1831142     0.09   0.925    -.3416677    .3763088
         47  |   .0339031   .1894209     0.18   0.858    -.3374493    .4052556
         48  |   .0764916   .1946065     0.39   0.694    -.3050269    .4580101
         49  |   .0718497   .2000229     0.36   0.719    -.3202875     .463987
         50  |   .0919229   .2058749     0.45   0.655     -.311687    .4955327
             |
     age_cat |
          1  |   1.078408   .0594743    18.13   0.000     .9618111    1.195005
          2  |   1.560525    .065052    23.99   0.000     1.432994    1.688057
          3  |   1.771659   .0720691    24.58   0.000      1.63037    1.912948
          4  |    1.96184   .0768976    25.51   0.000     1.811085    2.112595
          5  |   2.079483   .0831071    25.02   0.000     1.916555    2.242412
          6  |    2.20094   .0883707    24.91   0.000     2.027693    2.374187
          7  |   2.306351   .0948326    24.32   0.000     2.120435    2.492266
          8  |     2.3979   .1015552    23.61   0.000     2.198806    2.596995
          9  |   2.487637   .1073693    23.17   0.000     2.277144     2.69813
         10  |   2.549858   .1138302    22.40   0.000     2.326699    2.773018
         11  |   2.615067   .1201688    21.76   0.000      2.37948    2.850653
         12  |   2.649824   .1269828    20.87   0.000     2.400879    2.898769
         13  |   2.707005   .1332957    20.31   0.000     2.445684    2.968327
         14  |   2.737851   .1404037    19.50   0.000     2.462595    3.013107
         15  |   2.808095   .1472962    19.06   0.000     2.519327    3.096864
         16  |   2.851652   .1543744    18.47   0.000     2.549007    3.154297
         17  |   2.887902   .1612952    17.90   0.000     2.571689    3.204115
         18  |   2.927033   .1684322    17.38   0.000     2.596828    3.257238
         19  |   2.948526   .1747001    16.88   0.000     2.606034    3.291019
         20  |   2.993657   .1882702    15.90   0.000     2.624561    3.362754
         25  |   3.043576    .208064    14.63   0.000     2.635675    3.451478
         30  |   3.048575    .261763    11.65   0.000     2.535399    3.561752
         40  |   2.761233   .3198788     8.63   0.000     2.134123    3.388343
         50  |   2.816237   .3280286     8.59   0.000      2.17315    3.459325
             |
       _cons |   10.67074   .0857689   124.41   0.000     10.50259    10.83889
-------------+----------------------------------------------------------------
     sigma_u |  1.9781435
     sigma_e |  .70081618
         rho |  .88848284   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    103109
Group variable: firm_person                     Number of groups   =     13872

R-sq:  within  = 0.0547                         Obs per group: min =         1
       between = 0.0707                                        avg =       7.4
       overall = 0.0663                                        max =        18

                                                F(53,4645)         =     12.32
corr(u_i, Xb)  = 0.0714                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,646 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0386091   .0716182     0.54   0.590    -.1017965    .1790147
      during |   .0331474   .0189957     1.74   0.081    -.0040932    .0703879
       after |   .0722275   .0330518     2.19   0.029     .0074303    .1370247
during_expat |   -.106248   .0304646    -3.49   0.000    -.1659731   -.0465228
 after_expat |  -.1883991   .0409203    -4.60   0.000    -.2686223   -.1081758
             |
    ind_year |
         27  |   .0771069   .0504713     1.53   0.127    -.0218408    .1760546
         28  |   .2813651   .0608727     4.62   0.000     .1620257    .4007044
         29  |   .3430813   .0726288     4.72   0.000     .2006944    .4854683
         30  |   .4365137    .081047     5.39   0.000     .2776232    .5954043
         31  |    .518641    .090169     5.75   0.000     .3418668    .6954151
         32  |   .7125245   .1006835     7.08   0.000     .5151371    .9099119
         33  |   .8117746   .1090513     7.44   0.000     .5979823    1.025567
         34  |   .8611453   .1186691     7.26   0.000     .6284975    1.093793
         35  |   .9136029    .128498     7.11   0.000     .6616858     1.16552
         36  |   1.005756   .1379766     7.29   0.000     .7352562    1.276256
         37  |   1.082489     .14779     7.32   0.000     .7927507    1.372228
         38  |   1.104677   .1574828     7.01   0.000     .7959361    1.413418
         39  |   1.145919   .1667697     6.87   0.000     .8189713    1.472867
         40  |   1.144733   .1771399     6.46   0.000     .7974551    1.492012
         41  |   1.171399    .186457     6.28   0.000     .8058544    1.536943
         42  |   1.233051   .1969513     6.26   0.000     .8469329    1.619169
         43  |   1.290122   .2072989     6.22   0.000     .8837176    1.696526
         44  |   1.262529   .2176404     5.80   0.000     .8358501    1.689207
         45  |   1.296828   .2266177     5.72   0.000     .8525494    1.741106
         46  |   1.284404   .2348967     5.47   0.000     .8238951    1.744913
         47  |   1.350061   .2422677     5.57   0.000      .875101     1.82502
         48  |   1.388973   .2510308     5.53   0.000     .8968334    1.881112
         49  |   1.087643    .259411     4.19   0.000     .5790747    1.596212
         50  |   1.157732   .2673608     4.33   0.000     .6335781    1.681886
             |
     age_cat |
          1  |   .1804315   .0721231     2.50   0.012      .039036     .321827
          2  |   .2707503   .0832777     3.25   0.001     .1074865    .4340141
          3  |   .3222045   .0891178     3.62   0.000     .1474913    .4969178
          4  |   .3697963   .0960051     3.85   0.000     .1815808    .5580118
          5  |   .3327035   .1037362     3.21   0.001     .1293313    .5360757
          6  |   .3371601   .1109436     3.04   0.002      .119658    .5546621
          7  |   .3073799   .1189887     2.58   0.010     .0741056    .5406542
          8  |    .321289   .1261088     2.55   0.011     .0740559     .568522
          9  |   .3245926   .1341971     2.42   0.016     .0615026    .5876827
         10  |   .3175256    .142891     2.22   0.026     .0373915    .5976598
         11  |   .3064698   .1516713     2.02   0.043      .009122    .6038176
         12  |   .3336186   .1606757     2.08   0.038     .0186179    .6486193
         13  |   .3170247   .1698592     1.87   0.062      -.01598    .6500294
         14  |   .3605838   .1788939     2.02   0.044     .0098668    .7113008
         15  |    .333606   .1884082     1.77   0.077    -.0357634    .7029755
         16  |   .3009087   .1982083     1.52   0.129    -.0876736    .6894911
         17  |   .2678583   .2075687     1.29   0.197    -.1390749    .6747914
         18  |   .2802541   .2178641     1.29   0.198    -.1468631    .7073713
         19  |   .3117787   .2278735     1.37   0.171    -.1349617     .758519
         20  |   .3079831   .2443512     1.26   0.208    -.1710613    .7870276
         25  |   .3005182   .2721336     1.10   0.270    -.2329928    .8340293
         30  |   .3225591   .3306792     0.98   0.329    -.3257291    .9708473
         40  |  -.1797958   .3828053    -0.47   0.639    -.9302759    .5706843
         50  |  -.1486242   .4300909    -0.35   0.730    -.9918066    .6945583
             |
       _cons |   5.217823   .1008905    51.72   0.000      5.02003    5.415616
-------------+----------------------------------------------------------------
     sigma_u |  1.6250502
     sigma_e |  .78088894
         rho |   .8124063   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .054744393008744

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    103,109
Group variable: firm_person                     Number of groups  =     13,872

R-sq:                                           Obs per group:
     within  = 0.0547                                         min =          1
     between = 0.0707                                         avg =        7.4
     overall = 0.0663                                         max =         18

                                                F(53,4645)        =      12.32
corr(u_i, Xb)  = 0.0714                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,646 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0386091   .0716182     0.54   0.590    -.1017965    .1790147
      during |   .0331474   .0189957     1.74   0.081    -.0040932    .0703879
       after |   .0722275   .0330518     2.19   0.029     .0074303    .1370247
during_expat |   -.106248   .0304646    -3.49   0.000    -.1659731   -.0465228
 after_expat |  -.1883991   .0409203    -4.60   0.000    -.2686223   -.1081758
             |
    ind_year |
         27  |   .0771069   .0504713     1.53   0.127    -.0218408    .1760546
         28  |   .2813651   .0608727     4.62   0.000     .1620257    .4007044
         29  |   .3430813   .0726288     4.72   0.000     .2006944    .4854683
         30  |   .4365137    .081047     5.39   0.000     .2776232    .5954043
         31  |    .518641    .090169     5.75   0.000     .3418668    .6954151
         32  |   .7125245   .1006835     7.08   0.000     .5151371    .9099119
         33  |   .8117746   .1090513     7.44   0.000     .5979823    1.025567
         34  |   .8611453   .1186691     7.26   0.000     .6284975    1.093793
         35  |   .9136029    .128498     7.11   0.000     .6616858     1.16552
         36  |   1.005756   .1379766     7.29   0.000     .7352562    1.276256
         37  |   1.082489     .14779     7.32   0.000     .7927507    1.372228
         38  |   1.104677   .1574828     7.01   0.000     .7959361    1.413418
         39  |   1.145919   .1667697     6.87   0.000     .8189713    1.472867
         40  |   1.144733   .1771399     6.46   0.000     .7974551    1.492012
         41  |   1.171399    .186457     6.28   0.000     .8058544    1.536943
         42  |   1.233051   .1969513     6.26   0.000     .8469329    1.619169
         43  |   1.290122   .2072989     6.22   0.000     .8837176    1.696526
         44  |   1.262529   .2176404     5.80   0.000     .8358501    1.689207
         45  |   1.296828   .2266177     5.72   0.000     .8525494    1.741106
         46  |   1.284404   .2348967     5.47   0.000     .8238951    1.744913
         47  |   1.350061   .2422677     5.57   0.000      .875101     1.82502
         48  |   1.388973   .2510308     5.53   0.000     .8968334    1.881112
         49  |   1.087643    .259411     4.19   0.000     .5790747    1.596212
         50  |   1.157732   .2673608     4.33   0.000     .6335781    1.681886
             |
     age_cat |
          1  |   .1804315   .0721231     2.50   0.012      .039036     .321827
          2  |   .2707503   .0832777     3.25   0.001     .1074865    .4340141
          3  |   .3222045   .0891178     3.62   0.000     .1474913    .4969178
          4  |   .3697963   .0960051     3.85   0.000     .1815808    .5580118
          5  |   .3327035   .1037362     3.21   0.001     .1293313    .5360757
          6  |   .3371601   .1109436     3.04   0.002      .119658    .5546621
          7  |   .3073799   .1189887     2.58   0.010     .0741056    .5406542
          8  |    .321289   .1261088     2.55   0.011     .0740559     .568522
          9  |   .3245926   .1341971     2.42   0.016     .0615026    .5876827
         10  |   .3175256    .142891     2.22   0.026     .0373915    .5976598
         11  |   .3064698   .1516713     2.02   0.043      .009122    .6038176
         12  |   .3336186   .1606757     2.08   0.038     .0186179    .6486193
         13  |   .3170247   .1698592     1.87   0.062      -.01598    .6500294
         14  |   .3605838   .1788939     2.02   0.044     .0098668    .7113008
         15  |    .333606   .1884082     1.77   0.077    -.0357634    .7029755
         16  |   .3009087   .1982083     1.52   0.129    -.0876736    .6894911
         17  |   .2678583   .2075687     1.29   0.197    -.1390749    .6747914
         18  |   .2802541   .2178641     1.29   0.198    -.1468631    .7073713
         19  |   .3117787   .2278735     1.37   0.171    -.1349617     .758519
         20  |   .3079831   .2443512     1.26   0.208    -.1710613    .7870276
         25  |   .3005182   .2721336     1.10   0.270    -.2329928    .8340293
         30  |   .3225591   .3306792     0.98   0.329    -.3257291    .9708473
         40  |  -.1797958   .3828053    -0.47   0.639    -.9302759    .5706843
         50  |  -.1486242   .4300909    -0.35   0.730    -.9918066    .6945583
             |
       _cons |   5.217823   .1008905    51.72   0.000      5.02003    5.415616
-------------+----------------------------------------------------------------
     sigma_u |  1.6250502
     sigma_e |  .78088894
         rho |   .8124063   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    110609
Group variable: firm_person                     Number of groups   =     14091

R-sq:  within  = 0.2302                         Obs per group: min =         1
       between = 0.2595                                        avg =       7.8
       overall = 0.2340                                        max =        18

                                                F(53,4770)         =     67.22
corr(u_i, Xb)  = 0.1463                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,771 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0595966   .0328493     1.81   0.070    -.0048032    .1239963
      during |  -.0317895   .0104997    -3.03   0.002    -.0523736   -.0112053
       after |   .0094825   .0188613     0.50   0.615    -.0274942    .0464593
during_expat |   .1320771   .0174535     7.57   0.000     .0978603     .166294
 after_expat |   .1767457   .0250569     7.05   0.000     .1276227    .2258687
             |
    ind_year |
         27  |   .1174997   .0311099     3.78   0.000       .05651    .1784895
         28  |   .3119039   .0354484     8.80   0.000     .2424087    .3813991
         29  |   .5006705   .0439643    11.39   0.000     .4144801    .5868609
         30  |   .6942441   .0447226    15.52   0.000     .6065671    .7819211
         31  |   .8383395   .0497326    16.86   0.000     .7408407    .9358384
         32  |    .992784   .0531556    18.68   0.000     .8885744    1.096994
         33  |   1.053284   .0571399    18.43   0.000     .9412637    1.165305
         34  |   1.191777   .0611988    19.47   0.000     1.071799    1.311755
         35  |   1.271243   .0648564    19.60   0.000     1.144094    1.398391
         36  |   1.293013    .068556    18.86   0.000     1.158612    1.427415
         37  |   1.368451   .0725014    18.87   0.000     1.226315    1.510587
         38  |   1.445101   .0764831    18.89   0.000     1.295159    1.595044
         39  |   1.496775   .0812893    18.41   0.000     1.337411     1.65614
         40  |   1.594431   .0851694    18.72   0.000      1.42746    1.761403
         41  |   1.642203   .0883398    18.59   0.000     1.469016     1.81539
         42  |   1.693797   .0922932    18.35   0.000      1.51286    1.874734
         43  |   1.653881   .0956709    17.29   0.000     1.466322     1.84144
         44  |    1.70792   .1000342    17.07   0.000     1.511807    1.904034
         45  |   1.788341   .1030967    17.35   0.000     1.586224    1.990459
         46  |   1.787364   .1071792    16.68   0.000     1.577243    1.997485
         47  |   1.823083   .1099157    16.59   0.000     1.607598    2.038569
         48  |   1.873118   .1116875    16.77   0.000     1.654159    2.092077
         49  |   1.856664   .1149444    16.15   0.000      1.63132    2.082008
         50  |   1.874495   .1177987    15.91   0.000     1.643555    2.105434
             |
     age_cat |
          1  |    .653289    .050558    12.92   0.000     .5541719    .7524061
          2  |   .7632785   .0539101    14.16   0.000     .6575899    .8689672
          3  |   .7693746   .0587841    13.09   0.000     .6541306    .8846186
          4  |   .8055834   .0611951    13.16   0.000     .6856128    .9255539
          5  |   .8039926   .0641729    12.53   0.000     .6781842    .9298011
          6  |   .8111642   .0664195    12.21   0.000     .6809514     .941377
          7  |   .8167969   .0697086    11.72   0.000     .6801358     .953458
          8  |   .8195511   .0728011    11.26   0.000     .6768275    .9622748
          9  |   .8349987   .0755698    11.05   0.000     .6868472    .9831503
         10  |     .83109   .0786574    10.57   0.000     .6768852    .9852949
         11  |   .8282391   .0815193    10.16   0.000     .6684236    .9880545
         12  |   .8240843   .0846647     9.73   0.000     .6581024    .9900662
         13  |   .8282778    .087885     9.42   0.000     .6559826    1.000573
         14  |   .8201668   .0913906     8.97   0.000     .6409991    .9993344
         15  |   .8304089   .0945302     8.78   0.000     .6450861    1.015732
         16  |   .8310202   .0979152     8.49   0.000     .6390613    1.022979
         17  |   .8257658   .1011841     8.16   0.000     .6273983    1.024133
         18  |   .8523244    .104906     8.12   0.000     .6466603    1.057989
         19  |   .8427654   .1079429     7.81   0.000     .6311475    1.054383
         20  |   .8347663   .1142818     7.30   0.000     .6107213    1.058811
         25  |   .8530852   .1229075     6.94   0.000     .6121298    1.094041
         30  |   .8938593   .1600144     5.59   0.000     .5801572    1.207561
         40  |    .768154   .1839109     4.18   0.000     .4076037    1.128704
         50  |   .7891931   .1966715     4.01   0.000     .4036263     1.17476
             |
       _cons |   6.770265   .0603638   112.16   0.000     6.651924    6.888606
-------------+----------------------------------------------------------------
     sigma_u |  1.1101767
     sigma_e |  .50083422
         rho |  .83089712   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2301674163255073

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    110,609
Group variable: firm_person                     Number of groups  =     14,091

R-sq:                                           Obs per group:
     within  = 0.2302                                         min =          1
     between = 0.2595                                         avg =        7.8
     overall = 0.2340                                         max =         18

                                                F(53,4770)        =      67.22
corr(u_i, Xb)  = 0.1463                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,771 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0595966   .0328493     1.81   0.070    -.0048032    .1239963
      during |  -.0317895   .0104997    -3.03   0.002    -.0523736   -.0112053
       after |   .0094825   .0188613     0.50   0.615    -.0274942    .0464593
during_expat |   .1320771   .0174535     7.57   0.000     .0978603     .166294
 after_expat |   .1767457   .0250569     7.05   0.000     .1276227    .2258687
             |
    ind_year |
         27  |   .1174997   .0311099     3.78   0.000       .05651    .1784895
         28  |   .3119039   .0354484     8.80   0.000     .2424087    .3813991
         29  |   .5006705   .0439643    11.39   0.000     .4144801    .5868609
         30  |   .6942441   .0447226    15.52   0.000     .6065671    .7819211
         31  |   .8383395   .0497326    16.86   0.000     .7408407    .9358384
         32  |    .992784   .0531556    18.68   0.000     .8885744    1.096994
         33  |   1.053284   .0571399    18.43   0.000     .9412637    1.165305
         34  |   1.191777   .0611988    19.47   0.000     1.071799    1.311755
         35  |   1.271243   .0648564    19.60   0.000     1.144094    1.398391
         36  |   1.293013    .068556    18.86   0.000     1.158612    1.427415
         37  |   1.368451   .0725014    18.87   0.000     1.226315    1.510587
         38  |   1.445101   .0764831    18.89   0.000     1.295159    1.595044
         39  |   1.496775   .0812893    18.41   0.000     1.337411     1.65614
         40  |   1.594431   .0851694    18.72   0.000      1.42746    1.761403
         41  |   1.642203   .0883398    18.59   0.000     1.469016     1.81539
         42  |   1.693797   .0922932    18.35   0.000      1.51286    1.874734
         43  |   1.653881   .0956709    17.29   0.000     1.466322     1.84144
         44  |    1.70792   .1000342    17.07   0.000     1.511807    1.904034
         45  |   1.788341   .1030967    17.35   0.000     1.586224    1.990459
         46  |   1.787364   .1071792    16.68   0.000     1.577243    1.997485
         47  |   1.823083   .1099157    16.59   0.000     1.607598    2.038569
         48  |   1.873118   .1116875    16.77   0.000     1.654159    2.092077
         49  |   1.856664   .1149444    16.15   0.000      1.63132    2.082008
         50  |   1.874495   .1177987    15.91   0.000     1.643555    2.105434
             |
     age_cat |
          1  |    .653289    .050558    12.92   0.000     .5541719    .7524061
          2  |   .7632785   .0539101    14.16   0.000     .6575899    .8689672
          3  |   .7693746   .0587841    13.09   0.000     .6541306    .8846186
          4  |   .8055834   .0611951    13.16   0.000     .6856128    .9255539
          5  |   .8039926   .0641729    12.53   0.000     .6781842    .9298011
          6  |   .8111642   .0664195    12.21   0.000     .6809514     .941377
          7  |   .8167969   .0697086    11.72   0.000     .6801358     .953458
          8  |   .8195511   .0728011    11.26   0.000     .6768275    .9622748
          9  |   .8349987   .0755698    11.05   0.000     .6868472    .9831503
         10  |     .83109   .0786574    10.57   0.000     .6768852    .9852949
         11  |   .8282391   .0815193    10.16   0.000     .6684236    .9880545
         12  |   .8240843   .0846647     9.73   0.000     .6581024    .9900662
         13  |   .8282778    .087885     9.42   0.000     .6559826    1.000573
         14  |   .8201668   .0913906     8.97   0.000     .6409991    .9993344
         15  |   .8304089   .0945302     8.78   0.000     .6450861    1.015732
         16  |   .8310202   .0979152     8.49   0.000     .6390613    1.022979
         17  |   .8257658   .1011841     8.16   0.000     .6273983    1.024133
         18  |   .8523244    .104906     8.12   0.000     .6466603    1.057989
         19  |   .8427654   .1079429     7.81   0.000     .6311475    1.054383
         20  |   .8347663   .1142818     7.30   0.000     .6107213    1.058811
         25  |   .8530852   .1229075     6.94   0.000     .6121298    1.094041
         30  |   .8938593   .1600144     5.59   0.000     .5801572    1.207561
         40  |    .768154   .1839109     4.18   0.000     .4076037    1.128704
         50  |   .7891931   .1966715     4.01   0.000     .4036263     1.17476
             |
       _cons |   6.770265   .0603638   112.16   0.000     6.651924    6.888606
-------------+----------------------------------------------------------------
     sigma_u |  1.1101767
     sigma_e |  .50083422
         rho |  .83089712   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    110609
Group variable: firm_person                     Number of groups   =     14091

R-sq:  within  = 0.0528                         Obs per group: min =         1
       between = 0.0619                                        avg =       7.8
       overall = 0.0420                                        max =        18

                                                F(53,4770)         =     13.00
corr(u_i, Xb)  = 0.0569                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,771 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0377433   .0195501     1.93   0.054    -.0005838    .0760704
      during |  -.0140725   .0059553    -2.36   0.018    -.0257477   -.0023974
       after |  -.0131021   .0101484    -1.29   0.197    -.0329977    .0067934
during_expat |   .0127086   .0079648     1.60   0.111    -.0029061    .0283234
 after_expat |   .0008376   .0109444     0.08   0.939    -.0206184    .0222936
             |
    ind_year |
         27  |  -.0330583   .0161852    -2.04   0.041    -.0647887   -.0013278
         28  |  -.0388627   .0178356    -2.18   0.029    -.0738286   -.0038968
         29  |  -.0643362   .0206097    -3.12   0.002    -.1047407   -.0239318
         30  |  -.0481915   .0240399    -2.00   0.045    -.0953207   -.0010622
         31  |  -.0789073   .0261545    -3.02   0.003    -.1301822   -.0276324
         32  |  -.0857665   .0287827    -2.98   0.003     -.142194   -.0293391
         33  |  -.0888576   .0308428    -2.88   0.004    -.1493238   -.0283914
         34  |  -.1098431   .0335619    -3.27   0.001      -.17564   -.0440462
         35  |  -.1068551   .0360934    -2.96   0.003    -.1776148   -.0360955
         36  |  -.1251358   .0385527    -3.25   0.001    -.2007168   -.0495548
         37  |  -.1343538   .0410545    -3.27   0.001    -.2148395    -.053868
         38  |  -.1392952   .0438554    -3.18   0.002    -.2252719   -.0533184
         39  |  -.1473156   .0463875    -3.18   0.002    -.2382565   -.0563747
         40  |  -.1636586   .0490139    -3.34   0.001    -.2597485   -.0675688
         41  |  -.1563395   .0516924    -3.02   0.003    -.2576806   -.0549985
         42  |  -.1602442    .054505    -2.94   0.003    -.2670992   -.0533892
         43  |  -.1494221   .0571647    -2.61   0.009    -.2614914   -.0373529
         44  |  -.1484103   .0595103    -2.49   0.013     -.265078   -.0317427
         45  |  -.1351847   .0620886    -2.18   0.030     -.256907   -.0134624
         46  |  -.1370474   .0646763    -2.12   0.034    -.2638428   -.0102519
         47  |  -.1361807   .0669349    -2.03   0.042     -.267404   -.0049574
         48  |  -.1427118   .0689992    -2.07   0.039    -.2779821   -.0074415
         49  |  -.3484057    .071722    -4.86   0.000     -.489014   -.2077974
         50  |   -.395419   .0741169    -5.34   0.000    -.5407222   -.2501157
             |
     age_cat |
          1  |   .0950271   .0163833     5.80   0.000     .0629083    .1271459
          2  |   .1191885   .0179765     6.63   0.000     .0839462    .1544308
          3  |   .1452054   .0195232     7.44   0.000     .1069309    .1834799
          4  |   .1687922   .0216998     7.78   0.000     .1262506    .2113339
          5  |   .1770266   .0238044     7.44   0.000      .130359    .2236942
          6  |   .1895128   .0260034     7.29   0.000     .1385341    .2404916
          7  |   .2022255   .0285094     7.09   0.000      .146334    .2581171
          8  |   .2026968   .0310916     6.52   0.000     .1417429    .2636506
          9  |   .2232101   .0334861     6.67   0.000     .1575619    .2888583
         10  |   .2241527   .0360101     6.22   0.000     .1535563    .2947491
         11  |     .23663   .0384758     6.15   0.000     .1611998    .3120603
         12  |   .2381096   .0409629     5.81   0.000     .1578035    .3184157
         13  |   .2434608   .0436774     5.57   0.000     .1578331    .3290886
         14  |   .2569497   .0462302     5.56   0.000     .1663171    .3475823
         15  |   .2780971   .0490266     5.67   0.000     .1819823    .3742119
         16  |   .2730903   .0515043     5.30   0.000     .1721181    .3740625
         17  |   .2793438   .0541947     5.15   0.000     .1730973    .3855903
         18  |   .2684724   .0570261     4.71   0.000      .156675    .3802699
         19  |   .2615098   .0598479     4.37   0.000     .1441802    .3788393
         20  |   .2712433   .0643522     4.21   0.000     .1450834    .3974032
         25  |   .2351376   .0732985     3.21   0.001     .0914387    .3788366
         30  |   .2193335   .0927821     2.36   0.018     .0374377    .4012292
         40  |   .1480622   .1163867     1.27   0.203    -.0801095    .3762339
         50  |   .1852279   .1292542     1.43   0.152      -.06817    .4386257
             |
       _cons |    .621199   .0264613    23.48   0.000     .5693226    .6730753
-------------+----------------------------------------------------------------
     sigma_u |  .34891975
     sigma_e |   .2702333
         rho |  .62506725   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0528192940031522

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    110,609
Group variable: firm_person                     Number of groups  =     14,091

R-sq:                                           Obs per group:
     within  = 0.0528                                         min =          1
     between = 0.0619                                         avg =        7.8
     overall = 0.0420                                         max =         18

                                                F(53,4770)        =      13.00
corr(u_i, Xb)  = 0.0569                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,771 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0377433   .0195501     1.93   0.054    -.0005838    .0760704
      during |  -.0140725   .0059553    -2.36   0.018    -.0257477   -.0023974
       after |  -.0131021   .0101484    -1.29   0.197    -.0329977    .0067934
during_expat |   .0127086   .0079648     1.60   0.111    -.0029061    .0283234
 after_expat |   .0008376   .0109444     0.08   0.939    -.0206184    .0222936
             |
    ind_year |
         27  |  -.0330583   .0161852    -2.04   0.041    -.0647887   -.0013278
         28  |  -.0388627   .0178356    -2.18   0.029    -.0738286   -.0038968
         29  |  -.0643362   .0206097    -3.12   0.002    -.1047407   -.0239318
         30  |  -.0481915   .0240399    -2.00   0.045    -.0953207   -.0010622
         31  |  -.0789073   .0261545    -3.02   0.003    -.1301822   -.0276324
         32  |  -.0857665   .0287827    -2.98   0.003     -.142194   -.0293391
         33  |  -.0888576   .0308428    -2.88   0.004    -.1493238   -.0283914
         34  |  -.1098431   .0335619    -3.27   0.001      -.17564   -.0440462
         35  |  -.1068551   .0360934    -2.96   0.003    -.1776148   -.0360955
         36  |  -.1251358   .0385527    -3.25   0.001    -.2007168   -.0495548
         37  |  -.1343538   .0410545    -3.27   0.001    -.2148395    -.053868
         38  |  -.1392952   .0438554    -3.18   0.002    -.2252719   -.0533184
         39  |  -.1473156   .0463875    -3.18   0.002    -.2382565   -.0563747
         40  |  -.1636586   .0490139    -3.34   0.001    -.2597485   -.0675688
         41  |  -.1563395   .0516924    -3.02   0.003    -.2576806   -.0549985
         42  |  -.1602442    .054505    -2.94   0.003    -.2670992   -.0533892
         43  |  -.1494221   .0571647    -2.61   0.009    -.2614914   -.0373529
         44  |  -.1484103   .0595103    -2.49   0.013     -.265078   -.0317427
         45  |  -.1351847   .0620886    -2.18   0.030     -.256907   -.0134624
         46  |  -.1370474   .0646763    -2.12   0.034    -.2638428   -.0102519
         47  |  -.1361807   .0669349    -2.03   0.042     -.267404   -.0049574
         48  |  -.1427118   .0689992    -2.07   0.039    -.2779821   -.0074415
         49  |  -.3484057    .071722    -4.86   0.000     -.489014   -.2077974
         50  |   -.395419   .0741169    -5.34   0.000    -.5407222   -.2501157
             |
     age_cat |
          1  |   .0950271   .0163833     5.80   0.000     .0629083    .1271459
          2  |   .1191885   .0179765     6.63   0.000     .0839462    .1544308
          3  |   .1452054   .0195232     7.44   0.000     .1069309    .1834799
          4  |   .1687922   .0216998     7.78   0.000     .1262506    .2113339
          5  |   .1770266   .0238044     7.44   0.000      .130359    .2236942
          6  |   .1895128   .0260034     7.29   0.000     .1385341    .2404916
          7  |   .2022255   .0285094     7.09   0.000      .146334    .2581171
          8  |   .2026968   .0310916     6.52   0.000     .1417429    .2636506
          9  |   .2232101   .0334861     6.67   0.000     .1575619    .2888583
         10  |   .2241527   .0360101     6.22   0.000     .1535563    .2947491
         11  |     .23663   .0384758     6.15   0.000     .1611998    .3120603
         12  |   .2381096   .0409629     5.81   0.000     .1578035    .3184157
         13  |   .2434608   .0436774     5.57   0.000     .1578331    .3290886
         14  |   .2569497   .0462302     5.56   0.000     .1663171    .3475823
         15  |   .2780971   .0490266     5.67   0.000     .1819823    .3742119
         16  |   .2730903   .0515043     5.30   0.000     .1721181    .3740625
         17  |   .2793438   .0541947     5.15   0.000     .1730973    .3855903
         18  |   .2684724   .0570261     4.71   0.000      .156675    .3802699
         19  |   .2615098   .0598479     4.37   0.000     .1441802    .3788393
         20  |   .2712433   .0643522     4.21   0.000     .1450834    .3974032
         25  |   .2351376   .0732985     3.21   0.001     .0914387    .3788366
         30  |   .2193335   .0927821     2.36   0.018     .0374377    .4012292
         40  |   .1480622   .1163867     1.27   0.203    -.0801095    .3762339
         50  |   .1852279   .1292542     1.43   0.152      -.06817    .4386257
             |
       _cons |    .621199   .0264613    23.48   0.000     .5693226    .6730753
-------------+----------------------------------------------------------------
     sigma_u |  .34891975
     sigma_e |   .2702333
         rho |  .62506725   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =     95983
Group variable: firm_person                     Number of groups   =     13611

R-sq:  within  = 0.0406                         Obs per group: min =         1
       between = 0.0074                                        avg =       7.1
       overall = 0.0236                                        max =        18

                                                F(51,4508)         =     33.61
corr(u_i, Xb)  = -0.2161                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,509 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1144126   .0513292     2.23   0.026     .0137823     .215043
      during |   .0061969   .0159223     0.39   0.697    -.0250186    .0374123
       after |   .0297313   .0256703     1.16   0.247    -.0205951    .0800577
during_expat |   .0542047   .0221624     2.45   0.014     .0107556    .0976537
 after_expat |   .0325175   .0276739     1.18   0.240     -.021737     .086772
             |
    ind_year |
         28  |  -.2802132   .0562676    -4.98   0.000    -.3905253   -.1699011
         29  |   -.167851    .055987    -3.00   0.003    -.2776129   -.0580891
         30  |   -.271144   .0575695    -4.71   0.000    -.3840085   -.1582795
         31  |  -.1360645   .0619111    -2.20   0.028    -.2574406   -.0146883
         32  |  -.2293733   .0663794    -3.46   0.001    -.3595096   -.0992371
         33  |  -.1148826   .0709002    -1.62   0.105    -.2538818    .0241166
         34  |  -.2550202   .0751738    -3.39   0.001    -.4023978   -.1076426
         35  |  -.2506668   .0811795    -3.09   0.002    -.4098184   -.0915151
         36  |  -.2282327   .0862601    -2.65   0.008    -.3973448   -.0591206
         37  |  -.3192551   .0920807    -3.47   0.001    -.4997785   -.1387317
         38  |  -.2666911    .097689    -2.73   0.006    -.4582094   -.0751727
         39  |  -.3522277   .1036366    -3.40   0.001    -.5554061   -.1490492
         40  |  -.3189329   .1099862    -2.90   0.004    -.5345599    -.103306
         41  |  -.3671238   .1164303    -3.15   0.002    -.5953844   -.1388633
         42  |  -.3541533   .1225474    -2.89   0.004    -.5944063   -.1139004
         43  |  -.2599541    .129002    -2.02   0.044    -.5128612   -.0070469
         44  |  -.3469361   .1348238    -2.57   0.010    -.6112568   -.0826153
         45  |  -.5307713   .1415022    -3.75   0.000     -.808185   -.2533577
         46  |  -.4055024   .1470853    -2.76   0.006    -.6938617    -.117143
         47  |  -.2090778   .1522225    -1.37   0.170    -.5075085    .0893528
         48  |  -.5292888   .1575381    -3.36   0.001    -.8381407   -.2204369
         49  |  -1.064081   .1634011    -6.51   0.000    -1.384427   -.7437347
         50  |   -.392592   .1733672    -2.26   0.024    -.7324766   -.0527073
             |
     age_cat |
          2  |  -.1440096   .0487677    -2.95   0.003    -.2396181   -.0484011
          3  |  -.3111884   .0496116    -6.27   0.000    -.4084515   -.2139252
          4  |   -.371233   .0521674    -7.12   0.000    -.4735066   -.2689593
          5  |  -.4747782   .0553654    -8.58   0.000    -.5833216   -.3662348
          6  |  -.4516723   .0601632    -7.51   0.000    -.5696217   -.3337229
          7  |  -.5400227   .0652102    -8.28   0.000    -.6678666   -.4121788
          8  |  -.4754466   .0700628    -6.79   0.000    -.6128041   -.3380891
          9  |  -.5011717   .0753194    -6.65   0.000    -.6488347   -.3535086
         10  |  -.5454564   .0808305    -6.75   0.000    -.7039238   -.3869889
         11  |  -.5042993    .086945    -5.80   0.000    -.6747542   -.3338445
         12  |  -.4624432   .0928809    -4.98   0.000    -.6445353   -.2803512
         13  |  -.5026311   .0990877    -5.07   0.000    -.6968916   -.3083706
         14  |  -.4944027    .105088    -4.70   0.000    -.7004266   -.2883788
         15  |  -.4816271   .1107555    -4.35   0.000    -.6987622   -.2644919
         16  |  -.5256628   .1169138    -4.50   0.000    -.7548712   -.2964545
         17  |  -.5301326   .1229361    -4.31   0.000    -.7711476   -.2891175
         18  |  -.5006341   .1297943    -3.86   0.000    -.7550945   -.2461736
         19  |  -.4886349   .1363731    -3.58   0.000     -.755993   -.2212767
         20  |  -.5107643   .1487055    -3.43   0.001    -.8023001   -.2192286
         25  |  -.5207633    .175735    -2.96   0.003      -.86529   -.1762366
         30  |  -.4773211   .2301258    -2.07   0.038    -.9284805   -.0261617
         40  |  -.4304917   .2936089    -1.47   0.143    -1.006109    .1451257
         50  |  -.4106634    .343121    -1.20   0.231    -1.083349    .2620221
             |
       _cons |   .5304832   .0672988     7.88   0.000     .3985445    .6624218
-------------+----------------------------------------------------------------
     sigma_u |  .44195127
     sigma_e |  .83951538
         rho |  .21699746   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0405938133098191

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =     95,983
Group variable: firm_person                     Number of groups  =     13,611

R-sq:                                           Obs per group:
     within  = 0.0406                                         min =          1
     between = 0.0074                                         avg =        7.1
     overall = 0.0236                                         max =         18

                                                F(51,4508)        =      33.61
corr(u_i, Xb)  = -0.2161                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,509 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1144126   .0513292     2.23   0.026     .0137823     .215043
      during |   .0061969   .0159223     0.39   0.697    -.0250186    .0374123
       after |   .0297313   .0256703     1.16   0.247    -.0205951    .0800577
during_expat |   .0542047   .0221624     2.45   0.014     .0107556    .0976537
 after_expat |   .0325175   .0276739     1.18   0.240     -.021737     .086772
             |
    ind_year |
         28  |  -.2802132   .0562676    -4.98   0.000    -.3905253   -.1699011
         29  |   -.167851    .055987    -3.00   0.003    -.2776129   -.0580891
         30  |   -.271144   .0575695    -4.71   0.000    -.3840085   -.1582795
         31  |  -.1360645   .0619111    -2.20   0.028    -.2574406   -.0146883
         32  |  -.2293733   .0663794    -3.46   0.001    -.3595096   -.0992371
         33  |  -.1148826   .0709002    -1.62   0.105    -.2538818    .0241166
         34  |  -.2550202   .0751738    -3.39   0.001    -.4023978   -.1076426
         35  |  -.2506668   .0811795    -3.09   0.002    -.4098184   -.0915151
         36  |  -.2282327   .0862601    -2.65   0.008    -.3973448   -.0591206
         37  |  -.3192551   .0920807    -3.47   0.001    -.4997785   -.1387317
         38  |  -.2666911    .097689    -2.73   0.006    -.4582094   -.0751727
         39  |  -.3522277   .1036366    -3.40   0.001    -.5554061   -.1490492
         40  |  -.3189329   .1099862    -2.90   0.004    -.5345599    -.103306
         41  |  -.3671238   .1164303    -3.15   0.002    -.5953844   -.1388633
         42  |  -.3541533   .1225474    -2.89   0.004    -.5944063   -.1139004
         43  |  -.2599541    .129002    -2.02   0.044    -.5128612   -.0070469
         44  |  -.3469361   .1348238    -2.57   0.010    -.6112568   -.0826153
         45  |  -.5307713   .1415022    -3.75   0.000     -.808185   -.2533577
         46  |  -.4055024   .1470853    -2.76   0.006    -.6938617    -.117143
         47  |  -.2090778   .1522225    -1.37   0.170    -.5075085    .0893528
         48  |  -.5292888   .1575381    -3.36   0.001    -.8381407   -.2204369
         49  |  -1.064081   .1634011    -6.51   0.000    -1.384427   -.7437347
         50  |   -.392592   .1733672    -2.26   0.024    -.7324766   -.0527073
             |
     age_cat |
          2  |  -.1440096   .0487677    -2.95   0.003    -.2396181   -.0484011
          3  |  -.3111884   .0496116    -6.27   0.000    -.4084515   -.2139252
          4  |   -.371233   .0521674    -7.12   0.000    -.4735066   -.2689593
          5  |  -.4747782   .0553654    -8.58   0.000    -.5833216   -.3662348
          6  |  -.4516723   .0601632    -7.51   0.000    -.5696217   -.3337229
          7  |  -.5400227   .0652102    -8.28   0.000    -.6678666   -.4121788
          8  |  -.4754466   .0700628    -6.79   0.000    -.6128041   -.3380891
          9  |  -.5011717   .0753194    -6.65   0.000    -.6488347   -.3535086
         10  |  -.5454564   .0808305    -6.75   0.000    -.7039238   -.3869889
         11  |  -.5042993    .086945    -5.80   0.000    -.6747542   -.3338445
         12  |  -.4624432   .0928809    -4.98   0.000    -.6445353   -.2803512
         13  |  -.5026311   .0990877    -5.07   0.000    -.6968916   -.3083706
         14  |  -.4944027    .105088    -4.70   0.000    -.7004266   -.2883788
         15  |  -.4816271   .1107555    -4.35   0.000    -.6987622   -.2644919
         16  |  -.5256628   .1169138    -4.50   0.000    -.7548712   -.2964545
         17  |  -.5301326   .1229361    -4.31   0.000    -.7711476   -.2891175
         18  |  -.5006341   .1297943    -3.86   0.000    -.7550945   -.2461736
         19  |  -.4886349   .1363731    -3.58   0.000     -.755993   -.2212767
         20  |  -.5107643   .1487055    -3.43   0.001    -.8023001   -.2192286
         25  |  -.5207633    .175735    -2.96   0.003      -.86529   -.1762366
         30  |  -.4773211   .2301258    -2.07   0.038    -.9284805   -.0261617
         40  |  -.4304917   .2936089    -1.47   0.143    -1.006109    .1451257
         50  |  -.4106634    .343121    -1.20   0.231    -1.083349    .2620221
             |
       _cons |   .5304832   .0672988     7.88   0.000     .3985445    .6624218
-------------+----------------------------------------------------------------
     sigma_u |  .44195127
     sigma_e |  .83951538
         rho |  .21699746   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    234392
Group variable: firm_person                     Number of groups   =     27037

R-sq:  within  = 0.0985                         Obs per group: min =         1
       between = 0.0457                                        avg =       8.7
       overall = 0.0582                                        max =        18

                                                F(78,9942)         =     24.97
corr(u_i, Xb)  = -0.1707                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 9,943 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0351855   .0434283     0.81   0.418    -.0499429    .1203138
      during |  -.0552386    .009994    -5.53   0.000    -.0748287   -.0356484
       after |   -.122346   .0186492    -6.56   0.000    -.1589022   -.0857897
during_expat |  -.0262878   .0403973    -0.65   0.515    -.1054747    .0528992
 after_expat |   .0461023    .051646     0.89   0.372    -.0551344    .1473389
             |
    ind_year |
          2  |  -.2681429   .0306817    -8.74   0.000    -.3282854   -.2080005
          3  |  -.4770977   .0437516   -10.90   0.000    -.5628597   -.3913357
          4  |   -.639931   .0499423   -12.81   0.000    -.7378281   -.5420338
          5  |   -.790373   .0553676   -14.27   0.000    -.8989048   -.6818412
          6  |  -.9219221   .0602496   -15.30   0.000    -1.040024   -.8038207
          7  |  -1.023352   .0637962   -16.04   0.000    -1.148406   -.8982986
          8  |  -1.121234   .0689148   -16.27   0.000    -1.256321   -.9861471
          9  |  -1.217951   .0739758   -16.46   0.000    -1.362959   -1.072944
         10  |  -1.301483   .0781307   -16.66   0.000    -1.454635   -1.148331
         11  |  -1.422374   .0816387   -17.42   0.000    -1.582403   -1.262346
         12  |  -1.490812   .0849586   -17.55   0.000    -1.657348   -1.324276
         13  |  -1.581147   .0881711   -17.93   0.000    -1.753981   -1.408314
         14  |  -1.650711   .0913131   -18.08   0.000    -1.829703   -1.471719
         15  |  -1.711867   .0944496   -18.12   0.000    -1.897007   -1.526726
         16  |  -1.786899   .0974361   -18.34   0.000    -1.977894   -1.595905
         17  |  -1.850707     .10033   -18.45   0.000    -2.047374    -1.65404
         18  |  -1.927397   .1028079   -18.75   0.000    -2.128922   -1.725873
         19  |  -1.987604   .1054601   -18.85   0.000    -2.194327   -1.780881
         20  |  -2.033296   .1076536   -18.89   0.000    -2.244319   -1.822273
         21  |  -2.092261   .1101314   -19.00   0.000    -2.308141   -1.876381
         22  |  -2.147286   .1124305   -19.10   0.000    -2.367672   -1.926899
         23  |  -2.171364   .1145672   -18.95   0.000    -2.395939   -1.946789
         24  |  -2.206937   .1171434   -18.84   0.000    -2.436562   -1.977312
         25  |  -2.217445   .1198687   -18.50   0.000    -2.452412   -1.982478
         26  |   .7500166   .1034373     7.25   0.000     .5472586    .9527746
         27  |   .4683839   .0979457     4.78   0.000     .2763906    .6603773
         28  |   .2419256   .0944618     2.56   0.010     .0567612    .4270899
         29  |   .0714027    .092644     0.77   0.441    -.1101982    .2530037
         30  |  -.1077003   .0907664    -1.19   0.235    -.2856208    .0702202
         31  |  -.2563434   .0906699    -2.83   0.005    -.4340747    -.078612
         32  |  -.3707709   .0904894    -4.10   0.000    -.5481485   -.1933933
         33  |  -.4823206   .0906701    -5.32   0.000    -.6600524   -.3045889
         34  |  -.5880984    .091271    -6.44   0.000    -.7670081   -.4091888
         35  |  -.6616423   .0929067    -7.12   0.000    -.8437582   -.4795265
         36  |  -.7617278   .0945986    -8.05   0.000    -.9471603   -.5762953
         37  |   -.877247   .0965475    -9.09   0.000      -1.0665   -.6879942
         38  |  -.9913135   .0987696   -10.04   0.000    -1.184922   -.7977051
         39  |  -1.088001   .1015477   -10.71   0.000    -1.287055   -.8889467
         40  |  -1.149288   .1037565   -11.08   0.000    -1.352671   -.9459038
         41  |  -1.208601   .1057826   -11.43   0.000    -1.415956   -1.001246
         42  |  -1.285024   .1083637   -11.86   0.000    -1.497439   -1.072609
         43  |  -1.417064   .1110212   -12.76   0.000    -1.634688    -1.19944
         44  |  -1.482264   .1139534   -13.01   0.000    -1.705636   -1.258893
         45  |  -1.504816   .1163853   -12.93   0.000    -1.732954   -1.276677
         46  |  -1.543213   .1192335   -12.94   0.000    -1.776935   -1.309492
         47  |   -1.57674   .1211601   -13.01   0.000    -1.814239   -1.339242
         48  |  -1.599426   .1235713   -12.94   0.000    -1.841651   -1.357202
         49  |  -1.636547   .1261032   -12.98   0.000    -1.883735   -1.389359
         50  |  -1.646318    .128692   -12.79   0.000     -1.89858   -1.394055
             |
     age_cat |
          1  |   .4830957   .0268218    18.01   0.000     .4305195    .5356718
          2  |   .8731937   .0320228    27.27   0.000     .8104225     .935965
          3  |   1.133507   .0367428    30.85   0.000     1.061483     1.20553
          4  |   1.339852   .0407468    32.88   0.000      1.25998    1.419724
          5  |   1.530332   .0441432    34.67   0.000     1.443803    1.616862
          6  |   1.666994   .0475123    35.09   0.000      1.57386    1.760128
          7  |   1.780315   .0508527    35.01   0.000     1.680633    1.879996
          8  |   1.880724   .0546487    34.41   0.000     1.773601    1.987846
          9  |   1.952929   .0581473    33.59   0.000     1.838949     2.06691
         10  |    2.01278   .0616954    32.62   0.000     1.891845    2.133716
         11  |   2.100613   .0653859    32.13   0.000     1.972443    2.228782
         12  |   2.155334   .0686057    31.42   0.000     2.020853    2.289815
         13  |   2.217708    .071908    30.84   0.000     2.076754    2.358662
         14  |   2.258675   .0752504    30.02   0.000     2.111169     2.40618
         15  |   2.295347   .0786009    29.20   0.000     2.141274    2.449421
         16  |   2.332158   .0821843    28.38   0.000      2.17106    2.493256
         17  |   2.377477   .0857321    27.73   0.000     2.209425    2.545529
         18  |   2.418742   .0890144    27.17   0.000     2.244256    2.593229
         19  |   2.453877   .0926589    26.48   0.000     2.272247    2.635507
         20  |   2.485044   .0983392    25.27   0.000     2.292279    2.677809
         25  |   2.502841   .1087209    23.02   0.000     2.289726    2.715956
         30  |   2.430288   .1313077    18.51   0.000     2.172898    2.687678
         40  |   2.330649   .1477733    15.77   0.000     2.040983    2.620314
         50  |   2.402141    .161541    14.87   0.000     2.085488    2.718794
             |
       _cons |   3.340253   .0694867    48.07   0.000     3.204045    3.476461
-------------+----------------------------------------------------------------
     sigma_u |  1.3833311
     sigma_e |  .67631467
         rho |  .80708549   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0985061776241507

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    234,392
Group variable: firm_person                     Number of groups  =     27,037

R-sq:                                           Obs per group:
     within  = 0.0985                                         min =          1
     between = 0.0457                                         avg =        8.7
     overall = 0.0582                                         max =         18

                                                F(78,9942)        =      24.97
corr(u_i, Xb)  = -0.1707                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 9,943 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0351855   .0434283     0.81   0.418    -.0499429    .1203138
      during |  -.0552386    .009994    -5.53   0.000    -.0748287   -.0356484
       after |   -.122346   .0186492    -6.56   0.000    -.1589022   -.0857897
during_expat |  -.0262878   .0403973    -0.65   0.515    -.1054747    .0528992
 after_expat |   .0461023    .051646     0.89   0.372    -.0551344    .1473389
             |
    ind_year |
          2  |  -.2681429   .0306817    -8.74   0.000    -.3282854   -.2080005
          3  |  -.4770977   .0437516   -10.90   0.000    -.5628597   -.3913357
          4  |   -.639931   .0499423   -12.81   0.000    -.7378281   -.5420338
          5  |   -.790373   .0553676   -14.27   0.000    -.8989048   -.6818412
          6  |  -.9219221   .0602496   -15.30   0.000    -1.040024   -.8038207
          7  |  -1.023352   .0637962   -16.04   0.000    -1.148406   -.8982986
          8  |  -1.121234   .0689148   -16.27   0.000    -1.256321   -.9861471
          9  |  -1.217951   .0739758   -16.46   0.000    -1.362959   -1.072944
         10  |  -1.301483   .0781307   -16.66   0.000    -1.454635   -1.148331
         11  |  -1.422374   .0816387   -17.42   0.000    -1.582403   -1.262346
         12  |  -1.490812   .0849586   -17.55   0.000    -1.657348   -1.324276
         13  |  -1.581147   .0881711   -17.93   0.000    -1.753981   -1.408314
         14  |  -1.650711   .0913131   -18.08   0.000    -1.829703   -1.471719
         15  |  -1.711867   .0944496   -18.12   0.000    -1.897007   -1.526726
         16  |  -1.786899   .0974361   -18.34   0.000    -1.977894   -1.595905
         17  |  -1.850707     .10033   -18.45   0.000    -2.047374    -1.65404
         18  |  -1.927397   .1028079   -18.75   0.000    -2.128922   -1.725873
         19  |  -1.987604   .1054601   -18.85   0.000    -2.194327   -1.780881
         20  |  -2.033296   .1076536   -18.89   0.000    -2.244319   -1.822273
         21  |  -2.092261   .1101314   -19.00   0.000    -2.308141   -1.876381
         22  |  -2.147286   .1124305   -19.10   0.000    -2.367672   -1.926899
         23  |  -2.171364   .1145672   -18.95   0.000    -2.395939   -1.946789
         24  |  -2.206937   .1171434   -18.84   0.000    -2.436562   -1.977312
         25  |  -2.217445   .1198687   -18.50   0.000    -2.452412   -1.982478
         26  |   .7500166   .1034373     7.25   0.000     .5472586    .9527746
         27  |   .4683839   .0979457     4.78   0.000     .2763906    .6603773
         28  |   .2419256   .0944618     2.56   0.010     .0567612    .4270899
         29  |   .0714027    .092644     0.77   0.441    -.1101982    .2530037
         30  |  -.1077003   .0907664    -1.19   0.235    -.2856208    .0702202
         31  |  -.2563434   .0906699    -2.83   0.005    -.4340747    -.078612
         32  |  -.3707709   .0904894    -4.10   0.000    -.5481485   -.1933933
         33  |  -.4823206   .0906701    -5.32   0.000    -.6600524   -.3045889
         34  |  -.5880984    .091271    -6.44   0.000    -.7670081   -.4091888
         35  |  -.6616423   .0929067    -7.12   0.000    -.8437582   -.4795265
         36  |  -.7617278   .0945986    -8.05   0.000    -.9471603   -.5762953
         37  |   -.877247   .0965475    -9.09   0.000      -1.0665   -.6879942
         38  |  -.9913135   .0987696   -10.04   0.000    -1.184922   -.7977051
         39  |  -1.088001   .1015477   -10.71   0.000    -1.287055   -.8889467
         40  |  -1.149288   .1037565   -11.08   0.000    -1.352671   -.9459038
         41  |  -1.208601   .1057826   -11.43   0.000    -1.415956   -1.001246
         42  |  -1.285024   .1083637   -11.86   0.000    -1.497439   -1.072609
         43  |  -1.417064   .1110212   -12.76   0.000    -1.634688    -1.19944
         44  |  -1.482264   .1139534   -13.01   0.000    -1.705636   -1.258893
         45  |  -1.504816   .1163853   -12.93   0.000    -1.732954   -1.276677
         46  |  -1.543213   .1192335   -12.94   0.000    -1.776935   -1.309492
         47  |   -1.57674   .1211601   -13.01   0.000    -1.814239   -1.339242
         48  |  -1.599426   .1235713   -12.94   0.000    -1.841651   -1.357202
         49  |  -1.636547   .1261032   -12.98   0.000    -1.883735   -1.389359
         50  |  -1.646318    .128692   -12.79   0.000     -1.89858   -1.394055
             |
     age_cat |
          1  |   .4830957   .0268218    18.01   0.000     .4305195    .5356718
          2  |   .8731937   .0320228    27.27   0.000     .8104225     .935965
          3  |   1.133507   .0367428    30.85   0.000     1.061483     1.20553
          4  |   1.339852   .0407468    32.88   0.000      1.25998    1.419724
          5  |   1.530332   .0441432    34.67   0.000     1.443803    1.616862
          6  |   1.666994   .0475123    35.09   0.000      1.57386    1.760128
          7  |   1.780315   .0508527    35.01   0.000     1.680633    1.879996
          8  |   1.880724   .0546487    34.41   0.000     1.773601    1.987846
          9  |   1.952929   .0581473    33.59   0.000     1.838949     2.06691
         10  |    2.01278   .0616954    32.62   0.000     1.891845    2.133716
         11  |   2.100613   .0653859    32.13   0.000     1.972443    2.228782
         12  |   2.155334   .0686057    31.42   0.000     2.020853    2.289815
         13  |   2.217708    .071908    30.84   0.000     2.076754    2.358662
         14  |   2.258675   .0752504    30.02   0.000     2.111169     2.40618
         15  |   2.295347   .0786009    29.20   0.000     2.141274    2.449421
         16  |   2.332158   .0821843    28.38   0.000      2.17106    2.493256
         17  |   2.377477   .0857321    27.73   0.000     2.209425    2.545529
         18  |   2.418742   .0890144    27.17   0.000     2.244256    2.593229
         19  |   2.453877   .0926589    26.48   0.000     2.272247    2.635507
         20  |   2.485044   .0983392    25.27   0.000     2.292279    2.677809
         25  |   2.502841   .1087209    23.02   0.000     2.289726    2.715956
         30  |   2.430288   .1313077    18.51   0.000     2.172898    2.687678
         40  |   2.330649   .1477733    15.77   0.000     2.040983    2.620314
         50  |   2.402141    .161541    14.87   0.000     2.085488    2.718794
             |
       _cons |   3.340253   .0694867    48.07   0.000     3.204045    3.476461
-------------+----------------------------------------------------------------
     sigma_u |  1.3833311
     sigma_e |  .67631467
         rho |  .80708549   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    212589
Group variable: firm_person                     Number of groups   =     26482

R-sq:  within  = 0.0904                         Obs per group: min =         1
       between = 0.0918                                        avg =       8.0
       overall = 0.0712                                        max =        18

                                                F(78,9613)         =     23.11
corr(u_i, Xb)  = 0.0894                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 9,614 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0950497   .0620741     1.53   0.126    -.0266286     .216728
      during |  -.0520484   .0140293    -3.71   0.000    -.0795488    -.024548
       after |  -.0914567   .0252421    -3.62   0.000    -.1409365   -.0419769
during_expat |  -.0359599   .0529012    -0.68   0.497    -.1396574    .0677375
 after_expat |    .014193   .0688355     0.21   0.837     -.120739     .149125
             |
    ind_year |
          2  |  -.2194579   .0530628    -4.14   0.000    -.3234721   -.1154437
          3  |   .0313589   .0668427     0.47   0.639    -.0996669    .1623846
          4  |   .0117077   .0745061     0.16   0.875    -.1343399    .1577554
          5  |  -.0020396     .08534    -0.02   0.981     -.169324    .1652447
          6  |   .0674503   .0909114     0.74   0.458    -.1107551    .2456557
          7  |   .2169713   .0973662     2.23   0.026      .026113    .4078295
          8  |   .2704331   .1033313     2.62   0.009      .067882    .4729842
          9  |   .3381195   .1099653     3.07   0.002     .1225643    .5536747
         10  |   .4005956   .1140351     3.51   0.000     .1770627    .6241286
         11  |   .4211045   .1191505     3.53   0.000     .1875444    .6546646
         12  |    .416805   .1254586     3.32   0.001     .1708796    .6627303
         13  |   .4235732   .1310148     3.23   0.001     .1667565      .68039
         14  |   .3987839   .1364769     2.92   0.003     .1312605    .6663073
         15  |   .3474587   .1419498     2.45   0.014     .0692071    .6257103
         16  |   .3512041   .1473983     2.38   0.017     .0622725    .6401358
         17  |   .3638241   .1528088     2.38   0.017     .0642867    .6633614
         18  |    .342111   .1582042     2.16   0.031     .0319974    .6522245
         19  |   .2679743   .1630096     1.64   0.100     -.051559    .5875075
         20  |   .2489918   .1679542     1.48   0.138    -.0802339    .5782175
         21  |   .2748277   .1729129     1.59   0.112     -.064118    .6137734
         22  |   .2802245   .1774647     1.58   0.114    -.0676436    .6280927
         23  |   .3586538    .181924     1.97   0.049     .0020444    .7152632
         24  |  -.0582677   .1877208    -0.31   0.756    -.4262401    .3097047
         25  |  -.0086291   .1951324    -0.04   0.965    -.3911297    .3738716
         26  |   .8537296   .1416172     6.03   0.000     .5761301    1.131329
         27  |   .6715549   .1326147     5.06   0.000     .4116021    .9315077
         28  |     .69569   .1257902     5.53   0.000     .4491147    .9422653
         29  |   .6402638   .1248346     5.13   0.000     .3955617    .8849658
         30  |   .6252102    .121885     5.13   0.000     .3862899    .8641304
         31  |   .6108729   .1222663     5.00   0.000     .3712051    .8505407
         32  |   .7753312   .1213689     6.39   0.000     .5374225     1.01324
         33  |   .7709292    .122926     6.27   0.000     .5299682     1.01189
         34  |   .7579377   .1259412     6.02   0.000     .5110664    1.004809
         35  |   .7738835   .1296041     5.97   0.000     .5198323    1.027935
         36  |   .8419253   .1340084     6.28   0.000     .5792405     1.10461
         37  |   .8765842   .1378044     6.36   0.000     .6064585     1.14671
         38  |   .8366984   .1417301     5.90   0.000     .5588774    1.114519
         39  |   .8090701   .1460774     5.54   0.000     .5227277    1.095413
         40  |   .7843891   .1509981     5.19   0.000      .488401    1.080377
         41  |   .7978469   .1561599     5.11   0.000     .4917406    1.103953
         42  |   .8158507   .1608681     5.07   0.000     .5005152    1.131186
         43  |   .7587533   .1659096     4.57   0.000     .4335356    1.083971
         44  |   .7135427   .1718557     4.15   0.000     .3766693    1.050416
         45  |   .7666699   .1767134     4.34   0.000     .4202744    1.113065
         46  |   .7381095    .181501     4.07   0.000     .3823294     1.09389
         47  |   .7682132   .1853722     4.14   0.000     .4048447    1.131582
         48  |   .8302819   .1900212     4.37   0.000     .4578003    1.202763
         49  |   .6275263   .1975447     3.18   0.001      .240297    1.014756
         50  |   .7949267   .2029995     3.92   0.000     .3970049    1.192848
             |
     age_cat |
          1  |   .5738317   .0471104    12.18   0.000     .4814854    .6661779
          2  |   .9539268   .0550679    17.32   0.000     .8459821    1.061871
          3  |   1.235033   .0604503    20.43   0.000     1.116538    1.353529
          4  |   1.438715   .0656703    21.91   0.000     1.309987    1.567443
          5  |   1.574261   .0710197    22.17   0.000     1.435048    1.713475
          6  |   1.672593   .0760376    22.00   0.000     1.523544    1.821643
          7  |   1.750736   .0811181    21.58   0.000     1.591727    1.909744
          8  |   1.815451   .0862678    21.04   0.000     1.646348    1.984554
          9  |    1.87828   .0915994    20.51   0.000     1.698726    2.057834
         10  |   1.920371   .0972876    19.74   0.000     1.729666    2.111075
         11  |   1.984451   .1029336    19.28   0.000     1.782679    2.186222
         12  |   2.037444   .1085714    18.77   0.000     1.824621    2.250267
         13  |   2.039981    .114589    17.80   0.000     1.815362      2.2646
         14  |   2.060041   .1207103    17.07   0.000     1.823423    2.296659
         15  |    2.08213   .1266631    16.44   0.000     1.833843    2.330416
         16  |   2.092351    .132671    15.77   0.000     1.832288    2.352414
         17  |    2.09125    .138719    15.08   0.000     1.819331    2.363168
         18  |   2.090818   .1449061    14.43   0.000     1.806771    2.374864
         19  |   2.103822    .150897    13.94   0.000     1.808032    2.399612
         20  |   2.029081   .1615945    12.56   0.000     1.712322     2.34584
         25  |   1.898366   .1829775    10.37   0.000     1.539692     2.25704
         30  |   1.833837   .2181181     8.41   0.000      1.40628    2.261395
         40  |   1.723183   .2481946     6.94   0.000     1.236669    2.209697
         50  |   1.919528   .2737476     7.01   0.000     1.382925    2.456131
             |
       _cons |   7.931403   .1020074    77.75   0.000     7.731447    8.131359
-------------+----------------------------------------------------------------
     sigma_u |  2.2608701
     sigma_e |  .93218188
         rho |  .85470052   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0903639470074636

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    212,589
Group variable: firm_person                     Number of groups  =     26,482

R-sq:                                           Obs per group:
     within  = 0.0904                                         min =          1
     between = 0.0918                                         avg =        8.0
     overall = 0.0712                                         max =         18

                                                F(78,9613)        =      23.11
corr(u_i, Xb)  = 0.0894                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 9,614 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0950497   .0620741     1.53   0.126    -.0266286     .216728
      during |  -.0520484   .0140293    -3.71   0.000    -.0795488    -.024548
       after |  -.0914567   .0252421    -3.62   0.000    -.1409365   -.0419769
during_expat |  -.0359599   .0529012    -0.68   0.497    -.1396574    .0677375
 after_expat |    .014193   .0688355     0.21   0.837     -.120739     .149125
             |
    ind_year |
          2  |  -.2194579   .0530628    -4.14   0.000    -.3234721   -.1154437
          3  |   .0313589   .0668427     0.47   0.639    -.0996669    .1623846
          4  |   .0117077   .0745061     0.16   0.875    -.1343399    .1577554
          5  |  -.0020396     .08534    -0.02   0.981     -.169324    .1652447
          6  |   .0674503   .0909114     0.74   0.458    -.1107551    .2456557
          7  |   .2169713   .0973662     2.23   0.026      .026113    .4078295
          8  |   .2704331   .1033313     2.62   0.009      .067882    .4729842
          9  |   .3381195   .1099653     3.07   0.002     .1225643    .5536747
         10  |   .4005956   .1140351     3.51   0.000     .1770627    .6241286
         11  |   .4211045   .1191505     3.53   0.000     .1875444    .6546646
         12  |    .416805   .1254586     3.32   0.001     .1708796    .6627303
         13  |   .4235732   .1310148     3.23   0.001     .1667565      .68039
         14  |   .3987839   .1364769     2.92   0.003     .1312605    .6663073
         15  |   .3474587   .1419498     2.45   0.014     .0692071    .6257103
         16  |   .3512041   .1473983     2.38   0.017     .0622725    .6401358
         17  |   .3638241   .1528088     2.38   0.017     .0642867    .6633614
         18  |    .342111   .1582042     2.16   0.031     .0319974    .6522245
         19  |   .2679743   .1630096     1.64   0.100     -.051559    .5875075
         20  |   .2489918   .1679542     1.48   0.138    -.0802339    .5782175
         21  |   .2748277   .1729129     1.59   0.112     -.064118    .6137734
         22  |   .2802245   .1774647     1.58   0.114    -.0676436    .6280927
         23  |   .3586538    .181924     1.97   0.049     .0020444    .7152632
         24  |  -.0582677   .1877208    -0.31   0.756    -.4262401    .3097047
         25  |  -.0086291   .1951324    -0.04   0.965    -.3911297    .3738716
         26  |   .8537296   .1416172     6.03   0.000     .5761301    1.131329
         27  |   .6715549   .1326147     5.06   0.000     .4116021    .9315077
         28  |     .69569   .1257902     5.53   0.000     .4491147    .9422653
         29  |   .6402638   .1248346     5.13   0.000     .3955617    .8849658
         30  |   .6252102    .121885     5.13   0.000     .3862899    .8641304
         31  |   .6108729   .1222663     5.00   0.000     .3712051    .8505407
         32  |   .7753312   .1213689     6.39   0.000     .5374225     1.01324
         33  |   .7709292    .122926     6.27   0.000     .5299682     1.01189
         34  |   .7579377   .1259412     6.02   0.000     .5110664    1.004809
         35  |   .7738835   .1296041     5.97   0.000     .5198323    1.027935
         36  |   .8419253   .1340084     6.28   0.000     .5792405     1.10461
         37  |   .8765842   .1378044     6.36   0.000     .6064585     1.14671
         38  |   .8366984   .1417301     5.90   0.000     .5588774    1.114519
         39  |   .8090701   .1460774     5.54   0.000     .5227277    1.095413
         40  |   .7843891   .1509981     5.19   0.000      .488401    1.080377
         41  |   .7978469   .1561599     5.11   0.000     .4917406    1.103953
         42  |   .8158507   .1608681     5.07   0.000     .5005152    1.131186
         43  |   .7587533   .1659096     4.57   0.000     .4335356    1.083971
         44  |   .7135427   .1718557     4.15   0.000     .3766693    1.050416
         45  |   .7666699   .1767134     4.34   0.000     .4202744    1.113065
         46  |   .7381095    .181501     4.07   0.000     .3823294     1.09389
         47  |   .7682132   .1853722     4.14   0.000     .4048447    1.131582
         48  |   .8302819   .1900212     4.37   0.000     .4578003    1.202763
         49  |   .6275263   .1975447     3.18   0.001      .240297    1.014756
         50  |   .7949267   .2029995     3.92   0.000     .3970049    1.192848
             |
     age_cat |
          1  |   .5738317   .0471104    12.18   0.000     .4814854    .6661779
          2  |   .9539268   .0550679    17.32   0.000     .8459821    1.061871
          3  |   1.235033   .0604503    20.43   0.000     1.116538    1.353529
          4  |   1.438715   .0656703    21.91   0.000     1.309987    1.567443
          5  |   1.574261   .0710197    22.17   0.000     1.435048    1.713475
          6  |   1.672593   .0760376    22.00   0.000     1.523544    1.821643
          7  |   1.750736   .0811181    21.58   0.000     1.591727    1.909744
          8  |   1.815451   .0862678    21.04   0.000     1.646348    1.984554
          9  |    1.87828   .0915994    20.51   0.000     1.698726    2.057834
         10  |   1.920371   .0972876    19.74   0.000     1.729666    2.111075
         11  |   1.984451   .1029336    19.28   0.000     1.782679    2.186222
         12  |   2.037444   .1085714    18.77   0.000     1.824621    2.250267
         13  |   2.039981    .114589    17.80   0.000     1.815362      2.2646
         14  |   2.060041   .1207103    17.07   0.000     1.823423    2.296659
         15  |    2.08213   .1266631    16.44   0.000     1.833843    2.330416
         16  |   2.092351    .132671    15.77   0.000     1.832288    2.352414
         17  |    2.09125    .138719    15.08   0.000     1.819331    2.363168
         18  |   2.090818   .1449061    14.43   0.000     1.806771    2.374864
         19  |   2.103822    .150897    13.94   0.000     1.808032    2.399612
         20  |   2.029081   .1615945    12.56   0.000     1.712322     2.34584
         25  |   1.898366   .1829775    10.37   0.000     1.539692     2.25704
         30  |   1.833837   .2181181     8.41   0.000      1.40628    2.261395
         40  |   1.723183   .2481946     6.94   0.000     1.236669    2.209697
         50  |   1.919528   .2737476     7.01   0.000     1.382925    2.456131
             |
       _cons |   7.931403   .1020074    77.75   0.000     7.731447    8.131359
-------------+----------------------------------------------------------------
     sigma_u |  2.2608701
     sigma_e |  .93218188
         rho |  .85470052   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    234392
Group variable: firm_person                     Number of groups   =     27037

R-sq:  within  = 0.1342                         Obs per group: min =         1
       between = 0.0780                                        avg =       8.7
       overall = 0.0786                                        max =        18

                                                F(78,9942)         =     39.78
corr(u_i, Xb)  = 0.0268                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 9,943 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1611737   .0467228     3.45   0.001     .0695875    .2527599
      during |  -.0476408   .0117007    -4.07   0.000    -.0705764   -.0247051
       after |  -.0780018   .0217063    -3.59   0.000    -.1205506    -.035453
during_expat |   .0866679   .0501384     1.73   0.084    -.0116135    .1849493
 after_expat |    .229635   .0600785     3.82   0.000     .1118689    .3474012
             |
    ind_year |
          2  |  -.1610105   .0384928    -4.18   0.000    -.2364641   -.0855569
          3  |  -.2197752   .0525513    -4.18   0.000    -.3227864   -.1167639
          4  |   -.201039   .0592035    -3.40   0.001    -.3170899   -.0849881
          5  |  -.2269498   .0665515    -3.41   0.001    -.3574042   -.0964955
          6  |  -.1923361   .0738745    -2.60   0.009     -.337145   -.0475271
          7  |  -.1625691    .078694    -2.07   0.039    -.3168252   -.0083129
          8  |  -.1774393   .0850106    -2.09   0.037    -.3440773   -.0108012
          9  |  -.1428398   .0904311    -1.58   0.114    -.3201031    .0344235
         10  |  -.1278464   .0954987    -1.34   0.181    -.3150432    .0593505
         11  |  -.1661961   .0997652    -1.67   0.096    -.3617561    .0293639
         12  |  -.2233938   .1044854    -2.14   0.033    -.4282063   -.0185813
         13  |  -.2508646   .1089876    -2.30   0.021    -.4645024   -.0372269
         14  |   -.281207   .1135502    -2.48   0.013    -.5037883   -.0586257
         15  |  -.2731688   .1179966    -2.32   0.021     -.504466   -.0418716
         16  |  -.3121539   .1220818    -2.56   0.011     -.551459   -.0728489
         17  |  -.3070714   .1263649    -2.43   0.015    -.5547721   -.0593706
         18  |  -.4502354    .130989    -3.44   0.001    -.7070003   -.1934704
         19  |  -.4632036   .1338144    -3.46   0.001     -.725507   -.2009002
         20  |  -.4674847   .1370454    -3.41   0.001    -.7361214   -.1988481
         21  |  -.4973452   .1404934    -3.54   0.000    -.7727407   -.2219498
         22  |  -.4898842   .1437389    -3.41   0.001    -.7716415   -.2081269
         23  |  -.4638495   .1472978    -3.15   0.002     -.752583    -.175116
         24  |    -.45935   .1508129    -3.05   0.002    -.7549739   -.1637261
         25  |    -.47395   .1545418    -3.07   0.002    -.7768832   -.1710168
         26  |   .3672815   .1217712     3.02   0.003     .1285852    .6059778
         27  |   .1902485   .1140262     1.67   0.095    -.0332659    .4137629
         28  |   .1397234   .1085004     1.29   0.198    -.0729594    .3524062
         29  |   .1656991   .1079498     1.53   0.125    -.0459045    .3773026
         30  |   .2201912   .1030811     2.14   0.033     .0181313    .4222511
         31  |    .225027   .1037203     2.17   0.030     .0217142    .4283398
         32  |   .2917627    .103601     2.82   0.005     .0886837    .4948418
         33  |   .2497575   .1055734     2.37   0.018     .0428122    .4567027
         34  |   .2788337   .1072643     2.60   0.009     .0685738    .4890935
         35  |   .3008332   .1096253     2.74   0.006     .0859454    .5157209
         36  |   .2567969     .11131     2.31   0.021     .0386067    .4749871
         37  |   .2153047   .1141647     1.89   0.059    -.0084812    .4390906
         38  |   .1955389   .1170281     1.67   0.095    -.0338599    .4249376
         39  |     .14705   .1209685     1.22   0.224    -.0900728    .3841728
         40  |   .1840331   .1243898     1.48   0.139    -.0597961    .4278622
         41  |   .2066852   .1273632     1.62   0.105    -.0429725    .4563429
         42  |   .2046509   .1315656     1.56   0.120    -.0532443     .462546
         43  |   .0603808   .1353158     0.45   0.655    -.2048656    .3256273
         44  |   .0299297   .1400148     0.21   0.831    -.2445277     .304387
         45  |   .0967591   .1434744     0.67   0.500    -.1844799    .3779981
         46  |   .0652812   .1478657     0.44   0.659    -.2245656    .3551279
         47  |   .0599248   .1506533     0.40   0.691    -.2353862    .3552357
         48  |   .0786051   .1536627     0.51   0.609    -.2226049    .3798151
         49  |   .0523279   .1569613     0.33   0.739    -.2553481    .3600039
         50  |    .052878   .1602873     0.33   0.741    -.2613176    .3670735
             |
     age_cat |
          1  |   1.055037   .0361787    29.16   0.000     .9841191    1.125954
          2  |   1.456883   .0409143    35.61   0.000     1.376683    1.537084
          3  |   1.711579   .0456857    37.46   0.000     1.622025    1.801132
          4  |   1.917777   .0496435    38.63   0.000     1.820466    2.015089
          5  |   2.091573   .0539406    38.78   0.000     1.985838    2.197307
          6  |   2.197299   .0584558    37.59   0.000     2.082714    2.311884
          7  |    2.31961   .0625896    37.06   0.000     2.196922    2.442298
          8  |   2.409748   .0674844    35.71   0.000     2.277465    2.542032
          9  |   2.477647   .0719443    34.44   0.000     2.336621    2.618672
         10  |   2.525608   .0766069    32.97   0.000     2.375443    2.675773
         11  |   2.597545   .0812965    31.95   0.000     2.438187    2.756902
         12  |   2.653945   .0859833    30.87   0.000     2.485401     2.82249
         13  |   2.690782   .0905296    29.72   0.000     2.513326    2.868239
         14  |   2.731756   .0953587    28.65   0.000     2.544834    2.918678
         15  |   2.769647   .1000067    27.69   0.000     2.573613     2.96568
         16  |   2.776455   .1048006    26.49   0.000     2.571024    2.981885
         17  |    2.79801   .1094215    25.57   0.000     2.583522    3.012498
         18  |   2.838479   .1137305    24.96   0.000     2.615544    3.061414
         19  |   2.850625   .1183502    24.09   0.000     2.618635    3.082616
         20  |   2.844725   .1267279    22.45   0.000     2.596312    3.093137
         25  |   2.844878   .1405597    20.24   0.000     2.569352    3.120403
         30  |   2.779111   .1742379    15.95   0.000     2.437569    3.120652
         40  |   2.682513   .1955848    13.72   0.000     2.299127    3.065899
         50  |    2.74865   .2127658    12.92   0.000     2.331586    3.165714
             |
       _cons |    10.5808   .0839973   125.97   0.000     10.41615    10.74545
-------------+----------------------------------------------------------------
     sigma_u |  1.8905821
     sigma_e |  .80311455
         rho |  .84713248   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1342481925158341

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    234,392
Group variable: firm_person                     Number of groups  =     27,037

R-sq:                                           Obs per group:
     within  = 0.1342                                         min =          1
     between = 0.0780                                         avg =        8.7
     overall = 0.0786                                         max =         18

                                                F(78,9942)        =      39.78
corr(u_i, Xb)  = 0.0268                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 9,943 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1611737   .0467228     3.45   0.001     .0695875    .2527599
      during |  -.0476408   .0117007    -4.07   0.000    -.0705764   -.0247051
       after |  -.0780018   .0217063    -3.59   0.000    -.1205506    -.035453
during_expat |   .0866679   .0501384     1.73   0.084    -.0116135    .1849493
 after_expat |    .229635   .0600785     3.82   0.000     .1118689    .3474012
             |
    ind_year |
          2  |  -.1610105   .0384928    -4.18   0.000    -.2364641   -.0855569
          3  |  -.2197752   .0525513    -4.18   0.000    -.3227864   -.1167639
          4  |   -.201039   .0592035    -3.40   0.001    -.3170899   -.0849881
          5  |  -.2269498   .0665515    -3.41   0.001    -.3574042   -.0964955
          6  |  -.1923361   .0738745    -2.60   0.009     -.337145   -.0475271
          7  |  -.1625691    .078694    -2.07   0.039    -.3168252   -.0083129
          8  |  -.1774393   .0850106    -2.09   0.037    -.3440773   -.0108012
          9  |  -.1428398   .0904311    -1.58   0.114    -.3201031    .0344235
         10  |  -.1278464   .0954987    -1.34   0.181    -.3150432    .0593505
         11  |  -.1661961   .0997652    -1.67   0.096    -.3617561    .0293639
         12  |  -.2233938   .1044854    -2.14   0.033    -.4282063   -.0185813
         13  |  -.2508646   .1089876    -2.30   0.021    -.4645024   -.0372269
         14  |   -.281207   .1135502    -2.48   0.013    -.5037883   -.0586257
         15  |  -.2731688   .1179966    -2.32   0.021     -.504466   -.0418716
         16  |  -.3121539   .1220818    -2.56   0.011     -.551459   -.0728489
         17  |  -.3070714   .1263649    -2.43   0.015    -.5547721   -.0593706
         18  |  -.4502354    .130989    -3.44   0.001    -.7070003   -.1934704
         19  |  -.4632036   .1338144    -3.46   0.001     -.725507   -.2009002
         20  |  -.4674847   .1370454    -3.41   0.001    -.7361214   -.1988481
         21  |  -.4973452   .1404934    -3.54   0.000    -.7727407   -.2219498
         22  |  -.4898842   .1437389    -3.41   0.001    -.7716415   -.2081269
         23  |  -.4638495   .1472978    -3.15   0.002     -.752583    -.175116
         24  |    -.45935   .1508129    -3.05   0.002    -.7549739   -.1637261
         25  |    -.47395   .1545418    -3.07   0.002    -.7768832   -.1710168
         26  |   .3672815   .1217712     3.02   0.003     .1285852    .6059778
         27  |   .1902485   .1140262     1.67   0.095    -.0332659    .4137629
         28  |   .1397234   .1085004     1.29   0.198    -.0729594    .3524062
         29  |   .1656991   .1079498     1.53   0.125    -.0459045    .3773026
         30  |   .2201912   .1030811     2.14   0.033     .0181313    .4222511
         31  |    .225027   .1037203     2.17   0.030     .0217142    .4283398
         32  |   .2917627    .103601     2.82   0.005     .0886837    .4948418
         33  |   .2497575   .1055734     2.37   0.018     .0428122    .4567027
         34  |   .2788337   .1072643     2.60   0.009     .0685738    .4890935
         35  |   .3008332   .1096253     2.74   0.006     .0859454    .5157209
         36  |   .2567969     .11131     2.31   0.021     .0386067    .4749871
         37  |   .2153047   .1141647     1.89   0.059    -.0084812    .4390906
         38  |   .1955389   .1170281     1.67   0.095    -.0338599    .4249376
         39  |     .14705   .1209685     1.22   0.224    -.0900728    .3841728
         40  |   .1840331   .1243898     1.48   0.139    -.0597961    .4278622
         41  |   .2066852   .1273632     1.62   0.105    -.0429725    .4563429
         42  |   .2046509   .1315656     1.56   0.120    -.0532443     .462546
         43  |   .0603808   .1353158     0.45   0.655    -.2048656    .3256273
         44  |   .0299297   .1400148     0.21   0.831    -.2445277     .304387
         45  |   .0967591   .1434744     0.67   0.500    -.1844799    .3779981
         46  |   .0652812   .1478657     0.44   0.659    -.2245656    .3551279
         47  |   .0599248   .1506533     0.40   0.691    -.2353862    .3552357
         48  |   .0786051   .1536627     0.51   0.609    -.2226049    .3798151
         49  |   .0523279   .1569613     0.33   0.739    -.2553481    .3600039
         50  |    .052878   .1602873     0.33   0.741    -.2613176    .3670735
             |
     age_cat |
          1  |   1.055037   .0361787    29.16   0.000     .9841191    1.125954
          2  |   1.456883   .0409143    35.61   0.000     1.376683    1.537084
          3  |   1.711579   .0456857    37.46   0.000     1.622025    1.801132
          4  |   1.917777   .0496435    38.63   0.000     1.820466    2.015089
          5  |   2.091573   .0539406    38.78   0.000     1.985838    2.197307
          6  |   2.197299   .0584558    37.59   0.000     2.082714    2.311884
          7  |    2.31961   .0625896    37.06   0.000     2.196922    2.442298
          8  |   2.409748   .0674844    35.71   0.000     2.277465    2.542032
          9  |   2.477647   .0719443    34.44   0.000     2.336621    2.618672
         10  |   2.525608   .0766069    32.97   0.000     2.375443    2.675773
         11  |   2.597545   .0812965    31.95   0.000     2.438187    2.756902
         12  |   2.653945   .0859833    30.87   0.000     2.485401     2.82249
         13  |   2.690782   .0905296    29.72   0.000     2.513326    2.868239
         14  |   2.731756   .0953587    28.65   0.000     2.544834    2.918678
         15  |   2.769647   .1000067    27.69   0.000     2.573613     2.96568
         16  |   2.776455   .1048006    26.49   0.000     2.571024    2.981885
         17  |    2.79801   .1094215    25.57   0.000     2.583522    3.012498
         18  |   2.838479   .1137305    24.96   0.000     2.615544    3.061414
         19  |   2.850625   .1183502    24.09   0.000     2.618635    3.082616
         20  |   2.844725   .1267279    22.45   0.000     2.596312    3.093137
         25  |   2.844878   .1405597    20.24   0.000     2.569352    3.120403
         30  |   2.779111   .1742379    15.95   0.000     2.437569    3.120652
         40  |   2.682513   .1955848    13.72   0.000     2.299127    3.065899
         50  |    2.74865   .2127658    12.92   0.000     2.331586    3.165714
             |
       _cons |    10.5808   .0839973   125.97   0.000     10.41615    10.74545
-------------+----------------------------------------------------------------
     sigma_u |  1.8905821
     sigma_e |  .80311455
         rho |  .84713248   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    212589
Group variable: firm_person                     Number of groups   =     26482

R-sq:  within  = 0.0721                         Obs per group: min =         1
       between = 0.0386                                        avg =       8.0
       overall = 0.0480                                        max =        18

                                                F(78,9613)         =     23.37
corr(u_i, Xb)  = -0.0497                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 9,614 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0901345   .0549238     1.64   0.101    -.0175278    .1977967
      during |    .002713   .0128083     0.21   0.832    -.0223939      .02782
       after |   .0194222    .022847     0.85   0.395    -.0253627    .0642071
during_expat |  -.0063389   .0450538    -0.14   0.888    -.0946539    .0819762
 after_expat |  -.0631138   .0605356    -1.04   0.297    -.1817764    .0555488
             |
    ind_year |
          2  |   .0728722   .0473449     1.54   0.124    -.0199337    .1656782
          3  |   .5400765   .0568128     9.51   0.000     .4287114    .6514416
          4  |   .6933328   .0629185    11.02   0.000     .5699993    .8166664
          5  |   .8335643   .0693453    12.02   0.000      .697633    .9694956
          6  |   1.046349     .07508    13.94   0.000     .8991763    1.193522
          7  |   1.296639   .0795995    16.29   0.000     1.140608    1.452671
          8  |    1.44439   .0848691    17.02   0.000     1.278028    1.610751
          9  |   1.601753   .0905184    17.70   0.000     1.424317    1.779188
         10  |   1.743631   .0939722    18.55   0.000     1.559425    1.927836
         11  |   1.887964   .0982013    19.23   0.000     1.695468    2.080459
         12  |    1.94229   .1028524    18.88   0.000     1.740677    2.143902
         13  |   2.031954    .107881    18.84   0.000     1.820484    2.243423
         14  |   2.064657   .1126182    18.33   0.000     1.843902    2.285413
         15  |   2.067278   .1176868    17.57   0.000     1.836587    2.297969
         16  |   2.144406   .1221488    17.56   0.000     1.904968    2.383843
         17  |   2.212961   .1270635    17.42   0.000      1.96389    2.462032
         18  |   2.272056   .1316875    17.25   0.000      2.01392    2.530191
         19  |   2.257571   .1358442    16.62   0.000     1.991287    2.523854
         20  |   2.273001   .1402976    16.20   0.000     1.997988    2.548014
         21  |   2.351577   .1445977    16.26   0.000     2.068135    2.635019
         22  |   2.401339   .1481543    16.21   0.000     2.110925    2.691752
         23  |   2.495493   .1522826    16.39   0.000     2.196987    2.793999
         24  |   2.034318   .1577628    12.89   0.000     1.725069    2.343566
         25  |   2.091859   .1642637    12.73   0.000     1.769867     2.41385
         26  |    .237965   .1158212     2.05   0.040      .010931     .464999
         27  |    .317662   .1093101     2.91   0.004     .1033912    .5319329
         28  |   .5776795   .1030611     5.61   0.000      .375658     .779701
         29  |   .6939343   .1024938     6.77   0.000     .4930248    .8948438
         30  |   .8469855    .100522     8.43   0.000     .6499412     1.04403
         31  |   .9662277   .1011362     9.55   0.000     .7679795    1.164476
         32  |   1.253233   .1009879    12.41   0.000     1.055275    1.451191
         33  |   1.347054   .1016002    13.26   0.000     1.147896    1.546212
         34  |   1.435957   .1045218    13.74   0.000     1.231072    1.640842
         35  |   1.523087   .1079696    14.11   0.000     1.311444     1.73473
         36  |   1.690827   .1113193    15.19   0.000     1.472618    1.909036
         37  |   1.840507   .1151212    15.99   0.000     1.614845    2.066168
         38  |   1.896005   .1191966    15.91   0.000     1.662355    2.129655
         39  |    1.96452   .1227447    16.00   0.000     1.723914    2.205125
         40  |   1.993585   .1269651    15.70   0.000     1.744706    2.242463
         41  |    2.06695   .1310105    15.78   0.000     1.810142    2.323758
         42  |   2.157996   .1354631    15.93   0.000      1.89246    2.423532
         43  |   2.229158   .1400081    15.92   0.000     1.954712    2.503603
         44  |   2.244172   .1447193    15.51   0.000     1.960492    2.527853
         45  |   2.321728   .1491262    15.57   0.000      2.02941    2.614047
         46  |   2.334879   .1533587    15.22   0.000     2.034263    2.635494
         47  |   2.395959   .1568277    15.28   0.000     2.088544    2.703374
         48  |   2.471493   .1608492    15.37   0.000     2.156194    2.786791
         49  |   2.195326   .1674456    13.11   0.000     1.867098    2.523555
         50  |   2.319195   .1723454    13.46   0.000     1.981362    2.657029
             |
     age_cat |
          1  |   .1201299   .0458835     2.62   0.009     .0301887    .2100712
          2  |   .1528942   .0519814     2.94   0.003     .0509996    .2547887
          3  |   .1804527   .0561959     3.21   0.001     .0702969    .2906084
          4  |   .1883103   .0602982     3.12   0.002     .0701131    .3065076
          5  |    .154187   .0649087     2.38   0.018     .0269523    .2814216
          6  |   .1174211   .0689526     1.70   0.089    -.0177405    .2525827
          7  |   .0895841   .0733109     1.22   0.222    -.0541207    .2332889
          8  |   .0606438   .0777844     0.78   0.436    -.0918301    .2131177
          9  |   .0546898   .0822929     0.66   0.506    -.1066216    .2160012
         10  |   .0293262   .0869437     0.34   0.736    -.1411019    .1997543
         11  |   .0143312   .0917386     0.16   0.876    -.1654958    .1941582
         12  |   .0103858   .0962848     0.11   0.914    -.1783527    .1991243
         13  |  -.0368517   .1014224    -0.36   0.716     -.235661    .1619577
         14  |  -.0538719   .1064727    -0.51   0.613    -.2625808    .1548371
         15  |  -.0717528   .1115221    -0.64   0.520    -.2903596    .1468541
         16  |  -.1085179   .1164402    -0.93   0.351    -.3367651    .1197294
         17  |  -.1420567   .1215165    -1.17   0.242    -.3802546    .0961413
         18  |  -.1767236   .1269563    -1.39   0.164    -.4255848    .0721375
         19  |    -.19899   .1321324    -1.51   0.132    -.4579974    .0600174
         20  |  -.2999852   .1409365    -2.13   0.033    -.5762504     -.02372
         25  |   -.440585   .1591318    -2.77   0.006     -.752517   -.1286531
         30  |  -.4287468     .18891    -2.27   0.023    -.7990503   -.0584433
         40  |  -.4652905   .2158458    -2.16   0.031    -.8883938   -.0421872
         50  |  -.3433401   .2430577    -1.41   0.158    -.8197845    .1331042
             |
       _cons |   4.412806   .0855393    51.59   0.000     4.245131    4.580481
-------------+----------------------------------------------------------------
     sigma_u |  1.6814896
     sigma_e |  .86572222
         rho |  .79046696   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0721439271358495

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    212,589
Group variable: firm_person                     Number of groups  =     26,482

R-sq:                                           Obs per group:
     within  = 0.0721                                         min =          1
     between = 0.0386                                         avg =        8.0
     overall = 0.0480                                         max =         18

                                                F(78,9613)        =      23.37
corr(u_i, Xb)  = -0.0497                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 9,614 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0901345   .0549238     1.64   0.101    -.0175278    .1977967
      during |    .002713   .0128083     0.21   0.832    -.0223939      .02782
       after |   .0194222    .022847     0.85   0.395    -.0253627    .0642071
during_expat |  -.0063389   .0450538    -0.14   0.888    -.0946539    .0819762
 after_expat |  -.0631138   .0605356    -1.04   0.297    -.1817764    .0555488
             |
    ind_year |
          2  |   .0728722   .0473449     1.54   0.124    -.0199337    .1656782
          3  |   .5400765   .0568128     9.51   0.000     .4287114    .6514416
          4  |   .6933328   .0629185    11.02   0.000     .5699993    .8166664
          5  |   .8335643   .0693453    12.02   0.000      .697633    .9694956
          6  |   1.046349     .07508    13.94   0.000     .8991763    1.193522
          7  |   1.296639   .0795995    16.29   0.000     1.140608    1.452671
          8  |    1.44439   .0848691    17.02   0.000     1.278028    1.610751
          9  |   1.601753   .0905184    17.70   0.000     1.424317    1.779188
         10  |   1.743631   .0939722    18.55   0.000     1.559425    1.927836
         11  |   1.887964   .0982013    19.23   0.000     1.695468    2.080459
         12  |    1.94229   .1028524    18.88   0.000     1.740677    2.143902
         13  |   2.031954    .107881    18.84   0.000     1.820484    2.243423
         14  |   2.064657   .1126182    18.33   0.000     1.843902    2.285413
         15  |   2.067278   .1176868    17.57   0.000     1.836587    2.297969
         16  |   2.144406   .1221488    17.56   0.000     1.904968    2.383843
         17  |   2.212961   .1270635    17.42   0.000      1.96389    2.462032
         18  |   2.272056   .1316875    17.25   0.000      2.01392    2.530191
         19  |   2.257571   .1358442    16.62   0.000     1.991287    2.523854
         20  |   2.273001   .1402976    16.20   0.000     1.997988    2.548014
         21  |   2.351577   .1445977    16.26   0.000     2.068135    2.635019
         22  |   2.401339   .1481543    16.21   0.000     2.110925    2.691752
         23  |   2.495493   .1522826    16.39   0.000     2.196987    2.793999
         24  |   2.034318   .1577628    12.89   0.000     1.725069    2.343566
         25  |   2.091859   .1642637    12.73   0.000     1.769867     2.41385
         26  |    .237965   .1158212     2.05   0.040      .010931     .464999
         27  |    .317662   .1093101     2.91   0.004     .1033912    .5319329
         28  |   .5776795   .1030611     5.61   0.000      .375658     .779701
         29  |   .6939343   .1024938     6.77   0.000     .4930248    .8948438
         30  |   .8469855    .100522     8.43   0.000     .6499412     1.04403
         31  |   .9662277   .1011362     9.55   0.000     .7679795    1.164476
         32  |   1.253233   .1009879    12.41   0.000     1.055275    1.451191
         33  |   1.347054   .1016002    13.26   0.000     1.147896    1.546212
         34  |   1.435957   .1045218    13.74   0.000     1.231072    1.640842
         35  |   1.523087   .1079696    14.11   0.000     1.311444     1.73473
         36  |   1.690827   .1113193    15.19   0.000     1.472618    1.909036
         37  |   1.840507   .1151212    15.99   0.000     1.614845    2.066168
         38  |   1.896005   .1191966    15.91   0.000     1.662355    2.129655
         39  |    1.96452   .1227447    16.00   0.000     1.723914    2.205125
         40  |   1.993585   .1269651    15.70   0.000     1.744706    2.242463
         41  |    2.06695   .1310105    15.78   0.000     1.810142    2.323758
         42  |   2.157996   .1354631    15.93   0.000      1.89246    2.423532
         43  |   2.229158   .1400081    15.92   0.000     1.954712    2.503603
         44  |   2.244172   .1447193    15.51   0.000     1.960492    2.527853
         45  |   2.321728   .1491262    15.57   0.000      2.02941    2.614047
         46  |   2.334879   .1533587    15.22   0.000     2.034263    2.635494
         47  |   2.395959   .1568277    15.28   0.000     2.088544    2.703374
         48  |   2.471493   .1608492    15.37   0.000     2.156194    2.786791
         49  |   2.195326   .1674456    13.11   0.000     1.867098    2.523555
         50  |   2.319195   .1723454    13.46   0.000     1.981362    2.657029
             |
     age_cat |
          1  |   .1201299   .0458835     2.62   0.009     .0301887    .2100712
          2  |   .1528942   .0519814     2.94   0.003     .0509996    .2547887
          3  |   .1804527   .0561959     3.21   0.001     .0702969    .2906084
          4  |   .1883103   .0602982     3.12   0.002     .0701131    .3065076
          5  |    .154187   .0649087     2.38   0.018     .0269523    .2814216
          6  |   .1174211   .0689526     1.70   0.089    -.0177405    .2525827
          7  |   .0895841   .0733109     1.22   0.222    -.0541207    .2332889
          8  |   .0606438   .0777844     0.78   0.436    -.0918301    .2131177
          9  |   .0546898   .0822929     0.66   0.506    -.1066216    .2160012
         10  |   .0293262   .0869437     0.34   0.736    -.1411019    .1997543
         11  |   .0143312   .0917386     0.16   0.876    -.1654958    .1941582
         12  |   .0103858   .0962848     0.11   0.914    -.1783527    .1991243
         13  |  -.0368517   .1014224    -0.36   0.716     -.235661    .1619577
         14  |  -.0538719   .1064727    -0.51   0.613    -.2625808    .1548371
         15  |  -.0717528   .1115221    -0.64   0.520    -.2903596    .1468541
         16  |  -.1085179   .1164402    -0.93   0.351    -.3367651    .1197294
         17  |  -.1420567   .1215165    -1.17   0.242    -.3802546    .0961413
         18  |  -.1767236   .1269563    -1.39   0.164    -.4255848    .0721375
         19  |    -.19899   .1321324    -1.51   0.132    -.4579974    .0600174
         20  |  -.2999852   .1409365    -2.13   0.033    -.5762504     -.02372
         25  |   -.440585   .1591318    -2.77   0.006     -.752517   -.1286531
         30  |  -.4287468     .18891    -2.27   0.023    -.7990503   -.0584433
         40  |  -.4652905   .2158458    -2.16   0.031    -.8883938   -.0421872
         50  |  -.3433401   .2430577    -1.41   0.158    -.8197845    .1331042
             |
       _cons |   4.412806   .0855393    51.59   0.000     4.245131    4.580481
-------------+----------------------------------------------------------------
     sigma_u |  1.6814896
     sigma_e |  .86572222
         rho |  .79046696   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    234392
Group variable: firm_person                     Number of groups   =     27037

R-sq:  within  = 0.1234                         Obs per group: min =         1
       between = 0.1350                                        avg =       8.7
       overall = 0.1214                                        max =        18

                                                F(78,9942)         =     51.87
corr(u_i, Xb)  = 0.0634                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 9,943 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1259882   .0321642     3.92   0.000     .0629398    .1890367
      during |   .0075978   .0079608     0.95   0.340    -.0080069    .0232025
       after |   .0443442   .0145305     3.05   0.002     .0158615    .0728269
during_expat |   .1129556   .0317238     3.56   0.000     .0507706    .1751407
 after_expat |   .1835328   .0365168     5.03   0.000     .1119524    .2551131
             |
    ind_year |
          2  |   .1071324   .0273156     3.92   0.000     .0535883    .1606765
          3  |   .2573225   .0341082     7.54   0.000     .1904635    .3241815
          4  |    .438892   .0381036    11.52   0.000     .3642013    .5135827
          5  |   .5634231   .0416024    13.54   0.000      .481874    .6449723
          6  |   .7295861    .046764    15.60   0.000     .6379191    .8212531
          7  |   .8607831   .0484033    17.78   0.000     .7659027    .9556634
          8  |   .9437949   .0508924    18.54   0.000     .8440355    1.043554
          9  |   1.075111   .0538968    19.95   0.000     .9694627     1.18076
         10  |   1.173637   .0574398    20.43   0.000     1.061043     1.28623
         11  |   1.256178   .0601467    20.89   0.000     1.138278    1.374078
         12  |   1.267418     .06336    20.00   0.000      1.14322    1.391617
         13  |   1.330283   .0666678    19.95   0.000       1.1996    1.460965
         14  |   1.369504   .0695413    19.69   0.000     1.233189    1.505819
         15  |   1.438698   .0722974    19.90   0.000      1.29698    1.580416
         16  |   1.474745   .0753145    19.58   0.000     1.327114    1.622377
         17  |   1.543635   .0784507    19.68   0.000     1.389856    1.697415
         18  |   1.477162   .0815056    18.12   0.000     1.317394    1.636929
         19  |     1.5244   .0841295    18.12   0.000     1.359489    1.689311
         20  |   1.565811   .0864342    18.12   0.000     1.396382    1.735239
         21  |   1.594916   .0889854    17.92   0.000     1.420487    1.769345
         22  |   1.657402    .091004    18.21   0.000     1.479015    1.835788
         23  |   1.707514    .093604    18.24   0.000     1.524032    1.890997
         24  |   1.747587   .0957407    18.25   0.000     1.559916    1.935258
         25  |   1.743495   .0984698    17.71   0.000     1.550474    1.936516
         26  |  -.3827351    .071375    -5.36   0.000    -.5226446   -.2428256
         27  |  -.2781354   .0679018    -4.10   0.000    -.4112367   -.1450341
         28  |  -.1022022   .0669961    -1.53   0.127    -.2335281    .0291237
         29  |   .0942964   .0644703     1.46   0.144    -.0320784    .2206712
         30  |   .3278915   .0623267     5.26   0.000     .2057185    .4500646
         31  |   .4813704   .0630766     7.63   0.000     .3577274    .6050134
         32  |   .6625337   .0637088    10.40   0.000     .5376516    .7874157
         33  |   .7320781   .0638423    11.47   0.000     .6069344    .8572219
         34  |   .8669322   .0655995    13.22   0.000     .7383439    .9955204
         35  |   .9624755   .0670639    14.35   0.000     .8310167    1.093934
         36  |   1.018525    .068241    14.93   0.000     .8847586    1.152291
         37  |   1.092552   .0707519    15.44   0.000     .9538636     1.23124
         38  |   1.186852   .0728591    16.29   0.000     1.044034    1.329671
         39  |   1.235051    .075818    16.29   0.000     1.086432    1.383669
         40  |   1.333321   .0779936    17.10   0.000     1.180437    1.486204
         41  |   1.415286   .0799272    17.71   0.000     1.258613     1.57196
         42  |   1.489675   .0823933    18.08   0.000     1.328167    1.651182
         43  |   1.477445   .0847252    17.44   0.000     1.311366    1.643524
         44  |   1.512194   .0878007    17.22   0.000     1.340087    1.684301
         45  |   1.601575   .0898662    17.82   0.000     1.425419    1.777731
         46  |   1.608495    .093016    17.29   0.000     1.426164    1.790825
         47  |   1.636665   .0946034    17.30   0.000     1.451223    1.822107
         48  |   1.678031   .0963605    17.41   0.000     1.489145    1.866917
         49  |   1.688875   .0991869    17.03   0.000     1.494448    1.883301
         50  |   1.699195   .1011128    16.80   0.000     1.500994    1.897397
             |
     age_cat |
          1  |    .571941   .0305683    18.71   0.000     .5120209     .631861
          2  |   .5836895   .0330913    17.64   0.000     .5188238    .6485553
          3  |   .5780718   .0356908    16.20   0.000     .5081106     .648033
          4  |   .5779255   .0379399    15.23   0.000     .5035556    .6522953
          5  |   .5612406   .0398963    14.07   0.000     .4830358    .6394454
          6  |    .530305   .0421062    12.59   0.000     .4477683    .6128417
          7  |   .5392956   .0443721    12.15   0.000     .4523172    .6262739
          8  |   .5290248   .0469587    11.27   0.000     .4369764    .6210733
          9  |   .5247171   .0494179    10.62   0.000      .427848    .6215861
         10  |   .5128274   .0520904     9.84   0.000     .4107197    .6149352
         11  |    .496932   .0552235     9.00   0.000     .3886828    .6051813
         12  |   .4986116   .0578881     8.61   0.000     .3851392     .612084
         13  |   .4730745   .0607612     7.79   0.000     .3539702    .5921787
         14  |   .4730815   .0636617     7.43   0.000     .3482916    .5978714
         15  |   .4742995   .0664558     7.14   0.000     .3440327    .6045663
         16  |   .4442965   .0695109     6.39   0.000      .308041     .580552
         17  |   .4205331   .0723805     5.81   0.000     .2786526    .5624135
         18  |   .4197363   .0752911     5.57   0.000     .2721504    .5673222
         19  |   .3967484   .0785909     5.05   0.000     .2426943    .5508025
         20  |   .3596809   .0839855     4.28   0.000     .1950523    .5243095
         25  |   .3420364   .0931568     3.67   0.000     .1594302    .5246426
         30  |   .3488228   .1137849     3.07   0.002     .1257813    .5718642
         40  |   .3518643   .1269119     2.77   0.006     .1030913    .6006373
         50  |   .3465092   .1447578     2.39   0.017     .0627545    .6302639
             |
       _cons |   7.240544   .0534487   135.47   0.000     7.135774    7.345315
-------------+----------------------------------------------------------------
     sigma_u |  1.2035834
     sigma_e |  .59472797
         rho |  .80375159   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1233642376254694

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    234,392
Group variable: firm_person                     Number of groups  =     27,037

R-sq:                                           Obs per group:
     within  = 0.1234                                         min =          1
     between = 0.1350                                         avg =        8.7
     overall = 0.1214                                         max =         18

                                                F(78,9942)        =      51.87
corr(u_i, Xb)  = 0.0634                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 9,943 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1259882   .0321642     3.92   0.000     .0629398    .1890367
      during |   .0075978   .0079608     0.95   0.340    -.0080069    .0232025
       after |   .0443442   .0145305     3.05   0.002     .0158615    .0728269
during_expat |   .1129556   .0317238     3.56   0.000     .0507706    .1751407
 after_expat |   .1835328   .0365168     5.03   0.000     .1119524    .2551131
             |
    ind_year |
          2  |   .1071324   .0273156     3.92   0.000     .0535883    .1606765
          3  |   .2573225   .0341082     7.54   0.000     .1904635    .3241815
          4  |    .438892   .0381036    11.52   0.000     .3642013    .5135827
          5  |   .5634231   .0416024    13.54   0.000      .481874    .6449723
          6  |   .7295861    .046764    15.60   0.000     .6379191    .8212531
          7  |   .8607831   .0484033    17.78   0.000     .7659027    .9556634
          8  |   .9437949   .0508924    18.54   0.000     .8440355    1.043554
          9  |   1.075111   .0538968    19.95   0.000     .9694627     1.18076
         10  |   1.173637   .0574398    20.43   0.000     1.061043     1.28623
         11  |   1.256178   .0601467    20.89   0.000     1.138278    1.374078
         12  |   1.267418     .06336    20.00   0.000      1.14322    1.391617
         13  |   1.330283   .0666678    19.95   0.000       1.1996    1.460965
         14  |   1.369504   .0695413    19.69   0.000     1.233189    1.505819
         15  |   1.438698   .0722974    19.90   0.000      1.29698    1.580416
         16  |   1.474745   .0753145    19.58   0.000     1.327114    1.622377
         17  |   1.543635   .0784507    19.68   0.000     1.389856    1.697415
         18  |   1.477162   .0815056    18.12   0.000     1.317394    1.636929
         19  |     1.5244   .0841295    18.12   0.000     1.359489    1.689311
         20  |   1.565811   .0864342    18.12   0.000     1.396382    1.735239
         21  |   1.594916   .0889854    17.92   0.000     1.420487    1.769345
         22  |   1.657402    .091004    18.21   0.000     1.479015    1.835788
         23  |   1.707514    .093604    18.24   0.000     1.524032    1.890997
         24  |   1.747587   .0957407    18.25   0.000     1.559916    1.935258
         25  |   1.743495   .0984698    17.71   0.000     1.550474    1.936516
         26  |  -.3827351    .071375    -5.36   0.000    -.5226446   -.2428256
         27  |  -.2781354   .0679018    -4.10   0.000    -.4112367   -.1450341
         28  |  -.1022022   .0669961    -1.53   0.127    -.2335281    .0291237
         29  |   .0942964   .0644703     1.46   0.144    -.0320784    .2206712
         30  |   .3278915   .0623267     5.26   0.000     .2057185    .4500646
         31  |   .4813704   .0630766     7.63   0.000     .3577274    .6050134
         32  |   .6625337   .0637088    10.40   0.000     .5376516    .7874157
         33  |   .7320781   .0638423    11.47   0.000     .6069344    .8572219
         34  |   .8669322   .0655995    13.22   0.000     .7383439    .9955204
         35  |   .9624755   .0670639    14.35   0.000     .8310167    1.093934
         36  |   1.018525    .068241    14.93   0.000     .8847586    1.152291
         37  |   1.092552   .0707519    15.44   0.000     .9538636     1.23124
         38  |   1.186852   .0728591    16.29   0.000     1.044034    1.329671
         39  |   1.235051    .075818    16.29   0.000     1.086432    1.383669
         40  |   1.333321   .0779936    17.10   0.000     1.180437    1.486204
         41  |   1.415286   .0799272    17.71   0.000     1.258613     1.57196
         42  |   1.489675   .0823933    18.08   0.000     1.328167    1.651182
         43  |   1.477445   .0847252    17.44   0.000     1.311366    1.643524
         44  |   1.512194   .0878007    17.22   0.000     1.340087    1.684301
         45  |   1.601575   .0898662    17.82   0.000     1.425419    1.777731
         46  |   1.608495    .093016    17.29   0.000     1.426164    1.790825
         47  |   1.636665   .0946034    17.30   0.000     1.451223    1.822107
         48  |   1.678031   .0963605    17.41   0.000     1.489145    1.866917
         49  |   1.688875   .0991869    17.03   0.000     1.494448    1.883301
         50  |   1.699195   .1011128    16.80   0.000     1.500994    1.897397
             |
     age_cat |
          1  |    .571941   .0305683    18.71   0.000     .5120209     .631861
          2  |   .5836895   .0330913    17.64   0.000     .5188238    .6485553
          3  |   .5780718   .0356908    16.20   0.000     .5081106     .648033
          4  |   .5779255   .0379399    15.23   0.000     .5035556    .6522953
          5  |   .5612406   .0398963    14.07   0.000     .4830358    .6394454
          6  |    .530305   .0421062    12.59   0.000     .4477683    .6128417
          7  |   .5392956   .0443721    12.15   0.000     .4523172    .6262739
          8  |   .5290248   .0469587    11.27   0.000     .4369764    .6210733
          9  |   .5247171   .0494179    10.62   0.000      .427848    .6215861
         10  |   .5128274   .0520904     9.84   0.000     .4107197    .6149352
         11  |    .496932   .0552235     9.00   0.000     .3886828    .6051813
         12  |   .4986116   .0578881     8.61   0.000     .3851392     .612084
         13  |   .4730745   .0607612     7.79   0.000     .3539702    .5921787
         14  |   .4730815   .0636617     7.43   0.000     .3482916    .5978714
         15  |   .4742995   .0664558     7.14   0.000     .3440327    .6045663
         16  |   .4442965   .0695109     6.39   0.000      .308041     .580552
         17  |   .4205331   .0723805     5.81   0.000     .2786526    .5624135
         18  |   .4197363   .0752911     5.57   0.000     .2721504    .5673222
         19  |   .3967484   .0785909     5.05   0.000     .2426943    .5508025
         20  |   .3596809   .0839855     4.28   0.000     .1950523    .5243095
         25  |   .3420364   .0931568     3.67   0.000     .1594302    .5246426
         30  |   .3488228   .1137849     3.07   0.002     .1257813    .5718642
         40  |   .3518643   .1269119     2.77   0.006     .1030913    .6006373
         50  |   .3465092   .1447578     2.39   0.017     .0627545    .6302639
             |
       _cons |   7.240544   .0534487   135.47   0.000     7.135774    7.345315
-------------+----------------------------------------------------------------
     sigma_u |  1.2035834
     sigma_e |  .59472797
         rho |  .80375159   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    234392
Group variable: firm_person                     Number of groups   =     27037

R-sq:  within  = 0.0351                         Obs per group: min =         1
       between = 0.1184                                        avg =       8.7
       overall = 0.0766                                        max =        18

                                                F(78,9942)         =     15.16
corr(u_i, Xb)  = 0.1571                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 9,943 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0124023   .0132591     0.94   0.350    -.0135882    .0383927
      during |  -.0055967   .0035223    -1.59   0.112     -.012501    .0013076
       after |   -.007904   .0060344    -1.31   0.190    -.0197326    .0039246
during_expat |     .03672    .012687     2.89   0.004     .0118509    .0615891
 after_expat |   .0581813   .0170878     3.40   0.001     .0246858    .0916769
             |
    ind_year |
          2  |  -.0184834   .0124217    -1.49   0.137    -.0428325    .0058656
          3  |  -.0395664   .0145227    -2.72   0.006    -.0680339    -.011099
          4  |  -.0509648   .0163313    -3.12   0.002    -.0829774   -.0189521
          5  |  -.0542294   .0174799    -3.10   0.002    -.0884935   -.0199653
          6  |  -.0796984   .0186166    -4.28   0.000    -.1161907   -.0432061
          7  |  -.0810957   .0193123    -4.20   0.000    -.1189516   -.0432397
          8  |  -.0994526   .0202437    -4.91   0.000    -.1391344   -.0597708
          9  |  -.0952226   .0216927    -4.39   0.000    -.1377446   -.0527005
         10  |  -.0991153    .022499    -4.41   0.000    -.1432179   -.0550127
         11  |  -.1104361    .023652    -4.67   0.000    -.1567988   -.0640733
         12  |  -.1119265   .0248277    -4.51   0.000    -.1605938   -.0632593
         13  |  -.1090264   .0260709    -4.18   0.000    -.1601306   -.0579222
         14  |  -.1061454   .0270906    -3.92   0.000    -.1592483   -.0530424
         15  |  -.0992048   .0281417    -3.53   0.000    -.1543682   -.0440414
         16  |  -.0779164   .0291632    -2.67   0.008    -.1350822   -.0207506
         17  |  -.0614658   .0304164    -2.02   0.043    -.1210882   -.0018435
         18  |  -.0475708   .0315637    -1.51   0.132    -.1094419    .0143004
         19  |  -.0500397   .0326531    -1.53   0.125    -.1140463     .013967
         20  |  -.0383214   .0337371    -1.14   0.256     -.104453    .0278101
         21  |  -.0502607   .0347534    -1.45   0.148    -.1183845     .017863
         22  |  -.0420946   .0356736    -1.18   0.238    -.1120221    .0278329
         23  |  -.0566566   .0365079    -1.55   0.121    -.1282195    .0149064
         24  |  -.1353366   .0376592    -3.59   0.000    -.2091563   -.0615169
         25  |   -.165681   .0388883    -4.26   0.000      -.24191    -.089452
         26  |   .1499255   .0320284     4.68   0.000     .0871434    .2127076
         27  |   .1016421   .0304065     3.34   0.001     .0420391     .161245
         28  |   .1025817    .027672     3.71   0.000     .0483389    .1568245
         29  |   .0802682   .0278818     2.88   0.004     .0256143    .1349221
         30  |    .092047   .0262047     3.51   0.000     .0406805    .1434136
         31  |   .0581362   .0263936     2.20   0.028     .0063994    .1098731
         32  |   .0638234   .0262096     2.44   0.015     .0124473    .1151996
         33  |   .0465319   .0262512     1.77   0.076    -.0049258    .0979896
         34  |   .0340232   .0268411     1.27   0.205    -.0185907    .0866371
         35  |   .0474259   .0272587     1.74   0.082    -.0060067    .1008585
         36  |   .0283583   .0278594     1.02   0.309    -.0262517    .0829684
         37  |   .0174269   .0283858     0.61   0.539    -.0382151    .0730688
         38  |   .0106296   .0291212     0.37   0.715    -.0464537     .067713
         39  |    .008864   .0300763     0.29   0.768    -.0500918    .0678197
         40  |   .0083828   .0310477     0.27   0.787    -.0524771    .0692426
         41  |   .0169371   .0320788     0.53   0.598    -.0459439    .0798181
         42  |   .0156488   .0330763     0.47   0.636    -.0491875    .0804851
         43  |   .0304465   .0341709     0.89   0.373    -.0365353    .0974284
         44  |   .0370891   .0350945     1.06   0.291    -.0317032    .1058813
         45  |    .053982   .0362425     1.49   0.136    -.0170606    .1250246
         46  |   .0508177   .0374476     1.36   0.175    -.0225872    .1242227
         47  |   .0572527   .0385423     1.49   0.137    -.0182979    .1328033
         48  |   .0511827   .0393129     1.30   0.193    -.0258786     .128244
         49  |  -.1726605   .0409627    -4.22   0.000    -.2529556   -.0923654
         50  |  -.2246153   .0422539    -5.32   0.000    -.3074414   -.1417892
             |
     age_cat |
          1  |   .0740861   .0083634     8.86   0.000     .0576921    .0904802
          2  |   .0929905   .0094337     9.86   0.000     .0744985    .1114824
          3  |   .1116118   .0103851    10.75   0.000     .0912549    .1319687
          4  |   .1378705   .0115762    11.91   0.000     .1151787    .1605623
          5  |   .1517576   .0126408    12.01   0.000      .126979    .1765362
          6  |   .1564522    .013738    11.39   0.000     .1295229    .1833815
          7  |   .1674835   .0148904    11.25   0.000     .1382952    .1966717
          8  |   .1832179   .0161558    11.34   0.000     .1515492    .2148866
          9  |   .1828843   .0174209    10.50   0.000     .1487359    .2170328
         10  |   .1862872   .0187076     9.96   0.000     .1496165    .2229579
         11  |   .1967744   .0199337     9.87   0.000     .1577002    .2358486
         12  |   .1987265   .0211542     9.39   0.000     .1572599     .240193
         13  |   .1969901   .0224961     8.76   0.000     .1528932     .241087
         14  |    .200136   .0237381     8.43   0.000     .1536044    .2466676
         15  |   .2081972   .0250053     8.33   0.000     .1591818    .2572127
         16  |   .2175254   .0263847     8.24   0.000      .165806    .2692449
         17  |   .2200096   .0276948     7.94   0.000     .1657221    .2742971
         18  |   .2121766   .0291681     7.27   0.000     .1550011    .2693521
         19  |   .2075464    .030489     6.81   0.000     .1477818     .267311
         20  |    .217863   .0325038     6.70   0.000     .1541489    .2815771
         25  |   .2070054   .0371793     5.57   0.000     .1341264    .2798844
         30  |   .2409702   .0471553     5.11   0.000     .1485363    .3334042
         40  |   .2238534   .0544257     4.11   0.000      .117168    .3305388
         50  |   .2165983   .0615137     3.52   0.000     .0960191    .3371775
             |
       _cons |   .2082987    .019296    10.79   0.000     .1704746    .2461228
-------------+----------------------------------------------------------------
     sigma_u |  .39630538
     sigma_e |  .27411037
         rho |  .67640702   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0350866370331822

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    234,392
Group variable: firm_person                     Number of groups  =     27,037

R-sq:                                           Obs per group:
     within  = 0.0351                                         min =          1
     between = 0.1184                                         avg =        8.7
     overall = 0.0766                                         max =         18

                                                F(78,9942)        =      15.16
corr(u_i, Xb)  = 0.1571                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 9,943 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0124023   .0132591     0.94   0.350    -.0135882    .0383927
      during |  -.0055967   .0035223    -1.59   0.112     -.012501    .0013076
       after |   -.007904   .0060344    -1.31   0.190    -.0197326    .0039246
during_expat |     .03672    .012687     2.89   0.004     .0118509    .0615891
 after_expat |   .0581813   .0170878     3.40   0.001     .0246858    .0916769
             |
    ind_year |
          2  |  -.0184834   .0124217    -1.49   0.137    -.0428325    .0058656
          3  |  -.0395664   .0145227    -2.72   0.006    -.0680339    -.011099
          4  |  -.0509648   .0163313    -3.12   0.002    -.0829774   -.0189521
          5  |  -.0542294   .0174799    -3.10   0.002    -.0884935   -.0199653
          6  |  -.0796984   .0186166    -4.28   0.000    -.1161907   -.0432061
          7  |  -.0810957   .0193123    -4.20   0.000    -.1189516   -.0432397
          8  |  -.0994526   .0202437    -4.91   0.000    -.1391344   -.0597708
          9  |  -.0952226   .0216927    -4.39   0.000    -.1377446   -.0527005
         10  |  -.0991153    .022499    -4.41   0.000    -.1432179   -.0550127
         11  |  -.1104361    .023652    -4.67   0.000    -.1567988   -.0640733
         12  |  -.1119265   .0248277    -4.51   0.000    -.1605938   -.0632593
         13  |  -.1090264   .0260709    -4.18   0.000    -.1601306   -.0579222
         14  |  -.1061454   .0270906    -3.92   0.000    -.1592483   -.0530424
         15  |  -.0992048   .0281417    -3.53   0.000    -.1543682   -.0440414
         16  |  -.0779164   .0291632    -2.67   0.008    -.1350822   -.0207506
         17  |  -.0614658   .0304164    -2.02   0.043    -.1210882   -.0018435
         18  |  -.0475708   .0315637    -1.51   0.132    -.1094419    .0143004
         19  |  -.0500397   .0326531    -1.53   0.125    -.1140463     .013967
         20  |  -.0383214   .0337371    -1.14   0.256     -.104453    .0278101
         21  |  -.0502607   .0347534    -1.45   0.148    -.1183845     .017863
         22  |  -.0420946   .0356736    -1.18   0.238    -.1120221    .0278329
         23  |  -.0566566   .0365079    -1.55   0.121    -.1282195    .0149064
         24  |  -.1353366   .0376592    -3.59   0.000    -.2091563   -.0615169
         25  |   -.165681   .0388883    -4.26   0.000      -.24191    -.089452
         26  |   .1499255   .0320284     4.68   0.000     .0871434    .2127076
         27  |   .1016421   .0304065     3.34   0.001     .0420391     .161245
         28  |   .1025817    .027672     3.71   0.000     .0483389    .1568245
         29  |   .0802682   .0278818     2.88   0.004     .0256143    .1349221
         30  |    .092047   .0262047     3.51   0.000     .0406805    .1434136
         31  |   .0581362   .0263936     2.20   0.028     .0063994    .1098731
         32  |   .0638234   .0262096     2.44   0.015     .0124473    .1151996
         33  |   .0465319   .0262512     1.77   0.076    -.0049258    .0979896
         34  |   .0340232   .0268411     1.27   0.205    -.0185907    .0866371
         35  |   .0474259   .0272587     1.74   0.082    -.0060067    .1008585
         36  |   .0283583   .0278594     1.02   0.309    -.0262517    .0829684
         37  |   .0174269   .0283858     0.61   0.539    -.0382151    .0730688
         38  |   .0106296   .0291212     0.37   0.715    -.0464537     .067713
         39  |    .008864   .0300763     0.29   0.768    -.0500918    .0678197
         40  |   .0083828   .0310477     0.27   0.787    -.0524771    .0692426
         41  |   .0169371   .0320788     0.53   0.598    -.0459439    .0798181
         42  |   .0156488   .0330763     0.47   0.636    -.0491875    .0804851
         43  |   .0304465   .0341709     0.89   0.373    -.0365353    .0974284
         44  |   .0370891   .0350945     1.06   0.291    -.0317032    .1058813
         45  |    .053982   .0362425     1.49   0.136    -.0170606    .1250246
         46  |   .0508177   .0374476     1.36   0.175    -.0225872    .1242227
         47  |   .0572527   .0385423     1.49   0.137    -.0182979    .1328033
         48  |   .0511827   .0393129     1.30   0.193    -.0258786     .128244
         49  |  -.1726605   .0409627    -4.22   0.000    -.2529556   -.0923654
         50  |  -.2246153   .0422539    -5.32   0.000    -.3074414   -.1417892
             |
     age_cat |
          1  |   .0740861   .0083634     8.86   0.000     .0576921    .0904802
          2  |   .0929905   .0094337     9.86   0.000     .0744985    .1114824
          3  |   .1116118   .0103851    10.75   0.000     .0912549    .1319687
          4  |   .1378705   .0115762    11.91   0.000     .1151787    .1605623
          5  |   .1517576   .0126408    12.01   0.000      .126979    .1765362
          6  |   .1564522    .013738    11.39   0.000     .1295229    .1833815
          7  |   .1674835   .0148904    11.25   0.000     .1382952    .1966717
          8  |   .1832179   .0161558    11.34   0.000     .1515492    .2148866
          9  |   .1828843   .0174209    10.50   0.000     .1487359    .2170328
         10  |   .1862872   .0187076     9.96   0.000     .1496165    .2229579
         11  |   .1967744   .0199337     9.87   0.000     .1577002    .2358486
         12  |   .1987265   .0211542     9.39   0.000     .1572599     .240193
         13  |   .1969901   .0224961     8.76   0.000     .1528932     .241087
         14  |    .200136   .0237381     8.43   0.000     .1536044    .2466676
         15  |   .2081972   .0250053     8.33   0.000     .1591818    .2572127
         16  |   .2175254   .0263847     8.24   0.000      .165806    .2692449
         17  |   .2200096   .0276948     7.94   0.000     .1657221    .2742971
         18  |   .2121766   .0291681     7.27   0.000     .1550011    .2693521
         19  |   .2075464    .030489     6.81   0.000     .1477818     .267311
         20  |    .217863   .0325038     6.70   0.000     .1541489    .2815771
         25  |   .2070054   .0371793     5.57   0.000     .1341264    .2798844
         30  |   .2409702   .0471553     5.11   0.000     .1485363    .3334042
         40  |   .2238534   .0544257     4.11   0.000      .117168    .3305388
         50  |   .2165983   .0615137     3.52   0.000     .0960191    .3371775
             |
       _cons |   .2082987    .019296    10.79   0.000     .1704746    .2461228
-------------+----------------------------------------------------------------
     sigma_u |  .39630538
     sigma_e |  .27411037
         rho |  .67640702   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    198638
Group variable: firm_person                     Number of groups   =     25979

R-sq:  within  = 0.0310                         Obs per group: min =         1
       between = 0.0140                                        avg =       7.6
       overall = 0.0175                                        max =        18

                                                F(75,9295)         =     30.40
corr(u_i, Xb)  = -0.2833                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 9,296 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   -.026094   .0339994    -0.77   0.443    -.0927404    .0405524
      during |   .0221443   .0103159     2.15   0.032     .0019229    .0423657
       after |   .0438852   .0164861     2.66   0.008     .0115689    .0762015
during_expat |   .0049892   .0296732     0.17   0.866    -.0531768    .0631551
 after_expat |   .0175802   .0342914     0.51   0.608    -.0496384    .0847989
             |
    ind_year |
          3  |   -.106595   .0488395    -2.18   0.029    -.2023312   -.0108588
          4  |  -.0681098   .0487496    -1.40   0.162    -.1636698    .0274501
          5  |  -.0910035   .0514321    -1.77   0.077    -.1918217    .0098146
          6  |  -.1103159   .0523698    -2.11   0.035    -.2129721   -.0076597
          7  |  -.0069372   .0530188    -0.13   0.896    -.1108657    .0969914
          8  |  -.1437012   .0553692    -2.60   0.009    -.2522369   -.0351654
          9  |  -.1569611   .0569591    -2.76   0.006    -.2686134   -.0453087
         10  |  -.1806767   .0593544    -3.04   0.002    -.2970243   -.0643292
         11  |  -.1278398   .0616264    -2.07   0.038    -.2486411   -.0070384
         12  |   -.147684   .0641886    -2.30   0.021    -.2735078   -.0218602
         13  |  -.2764362   .0666767    -4.15   0.000    -.4071372   -.1457353
         14  |  -.3495446   .0695201    -5.03   0.000    -.4858192     -.21327
         15  |  -.2527445   .0722122    -3.50   0.000    -.3942962   -.1111927
         16  |  -.2591434   .0753835    -3.44   0.001    -.4069116   -.1113751
         17  |    -.28657   .0787537    -3.64   0.000    -.4409444   -.1321955
         18  |   -.243779   .0811741    -3.00   0.003     -.402898   -.0846601
         19  |  -.3159001   .0844752    -3.74   0.000      -.48149   -.1503102
         20  |  -.2338205   .0876518    -2.67   0.008    -.4056373   -.0620037
         21  |  -.3582898   .0905706    -3.96   0.000    -.5358281   -.1807515
         22  |  -.0583114   .0931184    -0.63   0.531    -.2408439    .1242212
         23  |  -.3366063    .096157    -3.50   0.000    -.5250951   -.1481176
         24  |  -.7655504   .1004066    -7.62   0.000    -.9623692   -.5687315
         25  |  -.3024272    .106925    -2.83   0.005    -.5120237   -.0928307
         27  |  -.1746433     .07691    -2.27   0.023    -.3254038   -.0238829
         28  |  -.5073761   .0721865    -7.03   0.000    -.6488775   -.3658748
         29  |  -.3498076   .0677429    -5.16   0.000    -.4825986   -.2170167
         30  |  -.4889711   .0667656    -7.32   0.000    -.6198464   -.3580959
         31  |   -.319004   .0657773    -4.85   0.000    -.4479419   -.1900661
         32  |  -.3933279    .065701    -5.99   0.000    -.5221163   -.2645396
         33  |  -.2547541      .0659    -3.87   0.000    -.3839326   -.1255756
         34  |  -.4153467   .0661781    -6.28   0.000    -.5450702   -.2856232
         35  |  -.3612045   .0680668    -5.31   0.000    -.4946303   -.2277786
         36  |  -.3304112   .0695074    -4.75   0.000    -.4666608   -.1941615
         37  |  -.4385521   .0717088    -6.12   0.000    -.5791171    -.297987
         38  |  -.3348418   .0734728    -4.56   0.000    -.4788647    -.190819
         39  |  -.4548475   .0760755    -5.98   0.000    -.6039721   -.3057229
         40  |  -.4452574   .0784447    -5.68   0.000    -.5990261   -.2914887
         41  |  -.4906748   .0817306    -6.00   0.000    -.6508847   -.3304648
         42  |  -.4069787   .0840876    -4.84   0.000    -.5718088   -.2421486
         43  |  -.3313481   .0870013    -3.81   0.000    -.5018898   -.1608065
         44  |  -.4201698   .0897953    -4.68   0.000    -.5961883   -.2441514
         45  |  -.6586685   .0926465    -7.11   0.000     -.840276   -.4770611
         46  |  -.5231305   .0952625    -5.49   0.000     -.709866    -.336395
         47  |  -.3031052   .0983895    -3.08   0.002    -.4959701   -.1102402
         48  |   -.629098   .1007615    -6.24   0.000    -.8266126   -.4315834
         49  |  -1.101087   .1047449   -10.51   0.000     -1.30641   -.8957641
         50  |  -.4819855   .1154614    -4.17   0.000    -.7083151   -.2556558
             |
     age_cat |
          2  |  -.1365614   .0330167    -4.14   0.000    -.2012814   -.0718413
          3  |  -.2806448   .0342468    -8.19   0.000    -.3477761   -.2135135
          4  |  -.3068723   .0355492    -8.63   0.000    -.3765565   -.2371881
          5  |  -.3781844   .0372747   -10.15   0.000    -.4512509   -.3051179
          6  |  -.3917815   .0389377   -10.06   0.000    -.4681079   -.3154551
          7  |  -.4587249    .041239   -11.12   0.000    -.5395623   -.3778874
          8  |  -.4613444   .0439037   -10.51   0.000    -.5474053   -.3752835
          9  |  -.4836788   .0465261   -10.40   0.000    -.5748802   -.3924774
         10  |   -.508626   .0494151   -10.29   0.000    -.6054905   -.4117615
         11  |  -.4852239   .0524003    -9.26   0.000      -.58794   -.3825077
         12  |  -.5136471   .0554293    -9.27   0.000    -.6223006   -.4049936
         13  |  -.5603705   .0584586    -9.59   0.000    -.6749621   -.4457789
         14  |  -.5341902   .0617569    -8.65   0.000    -.6552473   -.4131331
         15  |  -.5218808   .0646025    -8.08   0.000    -.6485158   -.3952458
         16  |  -.5548526   .0681581    -8.14   0.000    -.6884575   -.4212477
         17  |  -.5515951   .0711146    -7.76   0.000    -.6909953   -.4121949
         18  |  -.5579865   .0748751    -7.45   0.000    -.7047582   -.4112148
         19  |   -.535489   .0782385    -6.84   0.000    -.6888537   -.3821243
         20  |  -.5860857    .084279    -6.95   0.000     -.751291   -.4208804
         25  |  -.5974385   .1014727    -5.89   0.000    -.7963472   -.3985297
         30  |  -.6143672   .1253095    -4.90   0.000    -.8600014   -.3687331
         40  |  -.6221363   .1489659    -4.18   0.000    -.9141422   -.3301304
         50  |  -.6692834   .1767686    -3.79   0.000    -1.015789   -.3227782
             |
       _cons |   .6114837   .0551985    11.08   0.000     .5032826    .7196849
-------------+----------------------------------------------------------------
     sigma_u |  .43131916
     sigma_e |   .8566947
         rho |  .20222163   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0310360756045438

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    198,638
Group variable: firm_person                     Number of groups  =     25,979

R-sq:                                           Obs per group:
     within  = 0.0310                                         min =          1
     between = 0.0140                                         avg =        7.6
     overall = 0.0175                                         max =         18

                                                F(75,9295)        =      30.40
corr(u_i, Xb)  = -0.2833                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 9,296 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   -.026094   .0339994    -0.77   0.443    -.0927404    .0405524
      during |   .0221443   .0103159     2.15   0.032     .0019229    .0423657
       after |   .0438852   .0164861     2.66   0.008     .0115689    .0762015
during_expat |   .0049892   .0296732     0.17   0.866    -.0531768    .0631551
 after_expat |   .0175802   .0342914     0.51   0.608    -.0496384    .0847989
             |
    ind_year |
          3  |   -.106595   .0488395    -2.18   0.029    -.2023312   -.0108588
          4  |  -.0681098   .0487496    -1.40   0.162    -.1636698    .0274501
          5  |  -.0910035   .0514321    -1.77   0.077    -.1918217    .0098146
          6  |  -.1103159   .0523698    -2.11   0.035    -.2129721   -.0076597
          7  |  -.0069372   .0530188    -0.13   0.896    -.1108657    .0969914
          8  |  -.1437012   .0553692    -2.60   0.009    -.2522369   -.0351654
          9  |  -.1569611   .0569591    -2.76   0.006    -.2686134   -.0453087
         10  |  -.1806767   .0593544    -3.04   0.002    -.2970243   -.0643292
         11  |  -.1278398   .0616264    -2.07   0.038    -.2486411   -.0070384
         12  |   -.147684   .0641886    -2.30   0.021    -.2735078   -.0218602
         13  |  -.2764362   .0666767    -4.15   0.000    -.4071372   -.1457353
         14  |  -.3495446   .0695201    -5.03   0.000    -.4858192     -.21327
         15  |  -.2527445   .0722122    -3.50   0.000    -.3942962   -.1111927
         16  |  -.2591434   .0753835    -3.44   0.001    -.4069116   -.1113751
         17  |    -.28657   .0787537    -3.64   0.000    -.4409444   -.1321955
         18  |   -.243779   .0811741    -3.00   0.003     -.402898   -.0846601
         19  |  -.3159001   .0844752    -3.74   0.000      -.48149   -.1503102
         20  |  -.2338205   .0876518    -2.67   0.008    -.4056373   -.0620037
         21  |  -.3582898   .0905706    -3.96   0.000    -.5358281   -.1807515
         22  |  -.0583114   .0931184    -0.63   0.531    -.2408439    .1242212
         23  |  -.3366063    .096157    -3.50   0.000    -.5250951   -.1481176
         24  |  -.7655504   .1004066    -7.62   0.000    -.9623692   -.5687315
         25  |  -.3024272    .106925    -2.83   0.005    -.5120237   -.0928307
         27  |  -.1746433     .07691    -2.27   0.023    -.3254038   -.0238829
         28  |  -.5073761   .0721865    -7.03   0.000    -.6488775   -.3658748
         29  |  -.3498076   .0677429    -5.16   0.000    -.4825986   -.2170167
         30  |  -.4889711   .0667656    -7.32   0.000    -.6198464   -.3580959
         31  |   -.319004   .0657773    -4.85   0.000    -.4479419   -.1900661
         32  |  -.3933279    .065701    -5.99   0.000    -.5221163   -.2645396
         33  |  -.2547541      .0659    -3.87   0.000    -.3839326   -.1255756
         34  |  -.4153467   .0661781    -6.28   0.000    -.5450702   -.2856232
         35  |  -.3612045   .0680668    -5.31   0.000    -.4946303   -.2277786
         36  |  -.3304112   .0695074    -4.75   0.000    -.4666608   -.1941615
         37  |  -.4385521   .0717088    -6.12   0.000    -.5791171    -.297987
         38  |  -.3348418   .0734728    -4.56   0.000    -.4788647    -.190819
         39  |  -.4548475   .0760755    -5.98   0.000    -.6039721   -.3057229
         40  |  -.4452574   .0784447    -5.68   0.000    -.5990261   -.2914887
         41  |  -.4906748   .0817306    -6.00   0.000    -.6508847   -.3304648
         42  |  -.4069787   .0840876    -4.84   0.000    -.5718088   -.2421486
         43  |  -.3313481   .0870013    -3.81   0.000    -.5018898   -.1608065
         44  |  -.4201698   .0897953    -4.68   0.000    -.5961883   -.2441514
         45  |  -.6586685   .0926465    -7.11   0.000     -.840276   -.4770611
         46  |  -.5231305   .0952625    -5.49   0.000     -.709866    -.336395
         47  |  -.3031052   .0983895    -3.08   0.002    -.4959701   -.1102402
         48  |   -.629098   .1007615    -6.24   0.000    -.8266126   -.4315834
         49  |  -1.101087   .1047449   -10.51   0.000     -1.30641   -.8957641
         50  |  -.4819855   .1154614    -4.17   0.000    -.7083151   -.2556558
             |
     age_cat |
          2  |  -.1365614   .0330167    -4.14   0.000    -.2012814   -.0718413
          3  |  -.2806448   .0342468    -8.19   0.000    -.3477761   -.2135135
          4  |  -.3068723   .0355492    -8.63   0.000    -.3765565   -.2371881
          5  |  -.3781844   .0372747   -10.15   0.000    -.4512509   -.3051179
          6  |  -.3917815   .0389377   -10.06   0.000    -.4681079   -.3154551
          7  |  -.4587249    .041239   -11.12   0.000    -.5395623   -.3778874
          8  |  -.4613444   .0439037   -10.51   0.000    -.5474053   -.3752835
          9  |  -.4836788   .0465261   -10.40   0.000    -.5748802   -.3924774
         10  |   -.508626   .0494151   -10.29   0.000    -.6054905   -.4117615
         11  |  -.4852239   .0524003    -9.26   0.000      -.58794   -.3825077
         12  |  -.5136471   .0554293    -9.27   0.000    -.6223006   -.4049936
         13  |  -.5603705   .0584586    -9.59   0.000    -.6749621   -.4457789
         14  |  -.5341902   .0617569    -8.65   0.000    -.6552473   -.4131331
         15  |  -.5218808   .0646025    -8.08   0.000    -.6485158   -.3952458
         16  |  -.5548526   .0681581    -8.14   0.000    -.6884575   -.4212477
         17  |  -.5515951   .0711146    -7.76   0.000    -.6909953   -.4121949
         18  |  -.5579865   .0748751    -7.45   0.000    -.7047582   -.4112148
         19  |   -.535489   .0782385    -6.84   0.000    -.6888537   -.3821243
         20  |  -.5860857    .084279    -6.95   0.000     -.751291   -.4208804
         25  |  -.5974385   .1014727    -5.89   0.000    -.7963472   -.3985297
         30  |  -.6143672   .1253095    -4.90   0.000    -.8600014   -.3687331
         40  |  -.6221363   .1489659    -4.18   0.000    -.9141422   -.3301304
         50  |  -.6692834   .1767686    -3.79   0.000    -1.015789   -.3227782
             |
       _cons |   .6114837   .0551985    11.08   0.000     .5032826    .7196849
-------------+----------------------------------------------------------------
     sigma_u |  .43131916
     sigma_e |   .8566947
         rho |  .20222163   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
. *Szelekci az akviczis mintban
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. areg f1.expat lnL lnQ lnK exporter if ever_foreign==1&greenfield!=1, a(industry_year) cluster(frame_id)

Linear regression, absorbing indicators         Number of obs     =    107,455
Absorbed variable: industry_year                No. of categories =      1,653
                                                F(   4,   1352)   =       4.68
                                                Prob > F          =     0.0009
                                                R-squared         =     0.0762
                                                Adj R-squared     =     0.0617
                                                Root MSE          =     0.4528

                           (Std. Err. adjusted for 1,353 clusters in frame_id)
------------------------------------------------------------------------------
             |               Robust
     F.expat |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         lnL |  -.0238634   .0109652    -2.18   0.030    -.0453739   -.0023528
         lnQ |   .0230453   .0092428     2.49   0.013     .0049134    .0411771
         lnK |   .0023352   .0071066     0.33   0.743    -.0116059    .0162762
    exporter |   .0435343   .0187465     2.32   0.020      .006759    .0803095
       _cons |   .0464254   .0821814     0.56   0.572    -.1147916    .2076423
------------------------------------------------------------------------------

. do regram output/regression/selection 1 1

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Linear regression, absorbing indicators         Number of obs     =    107,455
Absorbed variable: industry_year                No. of categories =      1,653
                                                F(   4,   1352)   =       4.68
                                                Prob > F          =     0.0009
                                                R-squared         =     0.0762
                                                Adj R-squared     =     0.0617
                                                Root MSE          =     0.4528

                           (Std. Err. adjusted for 1,353 clusters in frame_id)
------------------------------------------------------------------------------
             |               Robust
     F.expat |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         lnL |  -.0238634   .0109652    -2.18   0.030    -.0453739   -.0023528
         lnQ |   .0230453   .0092428     2.49   0.013     .0049134    .0411771
         lnK |   .0023352   .0071066     0.33   0.743    -.0116059    .0162762
    exporter |   .0435343   .0187465     2.32   0.020      .006759    .0803095
       _cons |   .0464254   .0821814     0.56   0.572    -.1147916    .2076423
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
. keep if ever_foreign==1
(337,379 observations deleted)

. 
. local N = Tbefore+Tduring+1

. 
. do event_study

. local T1 = Tbefore 

. local T2 = Tduring

. 
. foreach X in expat domestic {
  2.         gen byte `X'_p_0 = tenure==0 & (`X'==1)
  3.         forval t=1/`T1' {
  4.                 gen byte `X'_m_`t' = tenure== -`t' & (`X'==1)
  5.         }
  6.         forval t=1/`T2' {
  7.                 gen byte `X'_p_`t' = tenure== `t' & (`X'==1)
  8.         }
  9.         replace `X'_p_`T2' = tenure>= `T2' & (`X'==1)
 10. }
(34,755 real changes made)
(30,298 real changes made)

. local X foreign

. gen byte `X'_p_0 = tenure_`X'==0

. forval t=1/`T1' {
  2.         gen byte `X'_m_`t' = tenure_`X'== -`t'
  3. }

. forval t=1/`T2' {
  2.         gen byte `X'_p_`t' = tenure_`X'== `t'
  3. }

. replace `X'_p_`T2' = tenure_`X'>= `T2' 
(177,405 real changes made)

. sort frame_id year

. 
. * illustrate window overlap and recoding
. l manager_id expat year tenure* if frame_id=="ft10072219"

        +--------------------------------------------------------------------------+
        |      manager_id   expat   year   tenure~n   tenure   tenure~c   tenure~t |
        |--------------------------------------------------------------------------|
  4450. |         PP45376       0   1992        -19      -21        -21          0 |
  4451. |         PP18562       0   1992        -19      -21        -21          0 |
  4452. | PP177715_998327       0   1992        -19      -20        -20          0 |
  4453. | PP177715_998327       0   1993        -18      -19        -19          0 |
  4454. |         PP18562       0   1993        -18      -20        -20          0 |
        |--------------------------------------------------------------------------|
  4455. |         PP45376       0   1993        -18      -20        -20          0 |
  4456. |         PP45376       0   1994        -17      -19        -19          0 |
  4457. |         PP18562       0   1994        -17      -19        -19          0 |
  4458. | PP177715_998327       0   1994        -17      -18        -18          0 |
  4459. |         PP45376       0   1995        -16      -18        -18          0 |
        |--------------------------------------------------------------------------|
  4460. | PP177715_998327       0   1995        -16      -17        -17          0 |
  4461. |         PP18562       0   1995        -16      -18        -18          0 |
  4462. |         PP45376       0   1996        -15      -17        -17          0 |
  4463. | PP177715_998327       0   1996        -15      -16        -16          0 |
  4464. |         PP18562       0   1996        -15      -17        -17          0 |
        |--------------------------------------------------------------------------|
  4465. |         PP45376       0   1997        -14      -16        -16          0 |
  4466. | PP177715_998327       0   1997        -14      -15        -15          0 |
  4467. |         PP18562       0   1997        -14      -16        -16          0 |
  4468. | PP177715_998327       0   1998        -13      -14        -14          0 |
  4469. |         PP18562       0   1998        -13      -15        -15          0 |
        |--------------------------------------------------------------------------|
  4470. |         PP45376       0   1998        -13      -15        -15          0 |
  4471. | PP177715_998327       0   1999        -12      -13        -13          0 |
  4472. |         PP18562       0   1999        -12      -14        -14          0 |
  4473. |         PP45376       0   1999        -12      -14        -14          0 |
  4474. | PP177715_998327       0   2000        -11      -12        -12          0 |
        |--------------------------------------------------------------------------|
  4475. |         PP45376       0   2000        -11      -13        -13          0 |
  4476. |         PP18562       0   2000        -11      -13        -13          0 |
  4477. |         PP45376       0   2001        -10      -12        -12          0 |
  4478. | PP177715_998327       0   2001        -10      -11        -11          0 |
  4479. |         PP18562       0   2001        -10      -12        -12          0 |
        |--------------------------------------------------------------------------|
  4480. |         PP45376       0   2002         -9      -11        -11          0 |
  4481. | PP177715_998327       0   2002         -9      -10        -10          0 |
  4482. |         PP18562       0   2002         -9      -11        -11          0 |
  4483. |         PP45376       0   2003         -8      -10        -10          0 |
  4484. | PP177715_998327       0   2003         -8       -9         -9          0 |
        |--------------------------------------------------------------------------|
  4485. |         PP18562       0   2003         -8      -10        -10          0 |
  4486. | PP177715_998327       0   2004         -7       -8         -8          0 |
  4487. |         PP18562       0   2004         -7       -9         -9          0 |
  4488. |         PP45376       0   2004         -7       -9         -9          0 |
  4489. | PP177715_998327       0   2005         -6       -7         -7          0 |
        |--------------------------------------------------------------------------|
  4490. |         PP45376       0   2005         -6       -8         -8          0 |
  4491. |         PP18562       0   2005         -6       -8         -8          0 |
  4492. |         PP18562       0   2006         -5       -7         -7          0 |
  4493. | PP177715_998327       0   2006         -5       -6         -6          0 |
  4494. |         PP45376       0   2006         -5       -7         -7          0 |
        |--------------------------------------------------------------------------|
  4495. | PP177715_998327       0   2007         -4       -5         -5          0 |
  4496. |         PP45376       0   2007         -4       -6         -6          0 |
  4497. |         PP18562       0   2007         -4       -6         -6          0 |
  4498. | PP177715_998327       0   2008         -3       -4         -4          0 |
  4499. |         PP18562       0   2008         -3       -5         -5          0 |
        |--------------------------------------------------------------------------|
  4500. |         PP45376       0   2008         -3       -5         -5          0 |
  4501. | PP177715_998327       0   2009         -2       -3         -3          0 |
  4502. |         PP18562       0   2009         -2       -4         -4          0 |
  4503. |         PP45376       0   2009         -2       -4         -4          0 |
  4504. |         PP18562       0   2010         -1       -3         -3          0 |
        |--------------------------------------------------------------------------|
  4505. |         PP45376       0   2010         -1       -3         -3          0 |
  4506. | PP177715_998327       0   2010         -1       -2         -2          0 |
  4507. |         PP45376       0   2011          0       -2         -2          0 |
  4508. |         PP18562       0   2011          0       -2         -2          0 |
  4509. | PP177715_998327       0   2011          0       -1         -1          0 |
        |--------------------------------------------------------------------------|
  4510. |         PP18562       0   2012          1       -1         -1          0 |
  4511. | PP177715_998327       0   2012          1        0          0          0 |
  4512. |         PP45376       0   2012          1       -1         -1          0 |
  4513. | PP177715_998327       0   2013          2        1          1          0 |
  4514. |         PP18562       0   2013          2        0          0          0 |
        |--------------------------------------------------------------------------|
  4515. |         PP45376       0   2013          2        0          0          0 |
  4516. | PP177715_998327       0   2014          3        2          2          0 |
  4517. |         PP45376       0   2014          3        1          1          0 |
  4518. |         PP18562       0   2014          3        1          1          0 |
  4519. |         PP18562       0   2015          4        2          2          0 |
        |--------------------------------------------------------------------------|
  4520. |         PP45376       0   2015          4        2          2          0 |
  4521. | PP177715_998327       0   2015          4        3          3          0 |
  4522. |         PP18562       0   2016          5        3          3          0 |
  4523. |         PP45376       0   2016          5        3          3          0 |
  4524. | PP177715_998327       0   2016          5        4          4          0 |
        +--------------------------------------------------------------------------+

. 
end of do-file

. 
. local Tbefore = Tbefore

. local Tafter = Tduring

. 
. foreach Y of var `scale' `intensity' {
  2.         * with firm FE, controls are years more than Tbefore before any event happens
.         xtreg `Y' *_m_* *_p_* i.ind_year i.age_cat if expat!=. & ever_foreign==1 & after==0 [aw=inverse_weight], i(firm_person
> ) fe vce(cluster id)
  3.         preserve
  4.         clear
  5.         set obs `N'
  6.         gen t = _n-1-`Tbefore'
  7.         label var t "Time since event (year)"
  8. 
.         foreach X in foreign expat domestic {
  9.                 gen `X'_beta=.
 10.                 gen `X'_lower=.
 11.                 gen `X'_upper=.
 12.                 forval t=-`Tbefore'/`Tafter' {
 13.                         local tag "`t'"
 14.                         if (`t'<0) {
 15.                                 local tag = -`t'
 16.                                 local tag  _m_`tag'
 17.                         }
 18.                         else {
 19.                                 local tag  _p_`t'
 20.                         }
 21.                         replace `X'_beta = _b[`X'`tag'] if t==`t'
 22.                         replace `X'_lower = `X'_beta-1.69*_se[`X'`tag'] if t==`t'
 23.                         replace `X'_upper = `X'_beta+1.69*_se[`X'`tag'] if t==`t'
 24.                 }
 25.                 label var `X'_beta "`Y'"
 26.                 label var `X'_upper "90% CI"
 27.                 label var `X'_lower "90% CI"
 28. 
.         }
 29.         label var foreign_beta "Foreign owner"
 30.         label var expat_beta "New expat manager"
 31.         label var domestic_beta "New domestic manager"
 32.         * omit last event year from graph, which is winsorized
.         tw (line expat_beta domestic_beta t if t>=-Tbefore & t<Tduring, sort), scheme(538w) title(`Y') aspect(0.67)
 33.         graph export output/figure/`Y'_event_study.png, replace width(800)
 34.         
.         restore
 35. 
. }

Fixed-effects (within) regression               Number of obs      =    241615
Group variable: firm_person                     Number of groups   =     20311

R-sq:  within  = 0.2000                         Obs per group: min =         1
       between = 0.1031                                        avg =      11.9
       overall = 0.1109                                        max =        25

                                                F(106,4618)        =     31.53
corr(u_i, Xb)  = -0.0124                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,619 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0511155   .0271052    -1.89   0.059    -.1042546    .0020236
   expat_m_2 |  -.0181101   .0234658    -0.77   0.440    -.0641143    .0278942
   expat_m_3 |  -.0049614   .0206631    -0.24   0.810    -.0454709    .0355481
   expat_m_4 |   .0052088    .017221     0.30   0.762    -.0285525    .0389701
domestic_m_1 |  -.1804831   .0260455    -6.93   0.000    -.2315447   -.1294214
domestic_m_2 |    -.12902   .0234622    -5.50   0.000    -.1750171   -.0830228
domestic_m_3 |  -.0869765   .0195793    -4.44   0.000    -.1253612   -.0485918
domestic_m_4 |   -.041612   .0162482    -2.56   0.010    -.0734662   -.0097578
 foreign_m_1 |  -.2485517   .0572451    -4.34   0.000    -.3607794   -.1363239
 foreign_m_2 |    -.22657   .0532593    -4.25   0.000    -.3309837   -.1221563
 foreign_m_3 |  -.1975129   .0483336    -4.09   0.000    -.2922698    -.102756
 foreign_m_4 |  -.1831336   .0418804    -4.37   0.000    -.2652391    -.101028
   expat_p_0 |  -.1078464   .0310838    -3.47   0.001    -.1687856   -.0469073
   expat_p_1 |  -.1538731   .0349676    -4.40   0.000    -.2224264   -.0853198
   expat_p_2 |  -.1717117   .0392209    -4.38   0.000    -.2486034   -.0948199
   expat_p_3 |  -.1875281   .0440683    -4.26   0.000    -.2739231   -.1011331
   expat_p_4 |  -.1812641   .0486897    -3.72   0.000    -.2767191   -.0858091
   expat_p_5 |  -.2217748    .055574    -3.99   0.000    -.3307263   -.1128232
   expat_p_6 |  -.3468486   .0699828    -4.96   0.000    -.4840484   -.2096488
domestic_p_0 |  -.2463883   .0293789    -8.39   0.000    -.3039851   -.1887916
domestic_p_1 |   -.275927   .0341256    -8.09   0.000    -.3428296   -.2090245
domestic_p_2 |  -.2863799   .0387648    -7.39   0.000    -.3623774   -.2103823
domestic_p_3 |  -.3043513   .0435818    -6.98   0.000    -.3897925   -.2189101
domestic_p_4 |  -.3218937   .0483336    -6.66   0.000    -.4166506   -.2271367
domestic_p_5 |  -.3292134    .053971    -6.10   0.000    -.4350223   -.2234044
domestic_p_6 |  -.3238707    .064292    -5.04   0.000    -.4499137   -.1978276
 foreign_p_0 |  -.5087611   .0633817    -8.03   0.000    -.6330196   -.3845026
 foreign_p_1 |  -.2869303   .0674293    -4.26   0.000    -.4191239   -.1547367
 foreign_p_2 |  -.2802727   .0714178    -3.92   0.000    -.4202856   -.1402597
 foreign_p_3 |  -.2885878   .0760425    -3.80   0.000    -.4376674   -.1395082
 foreign_p_4 |  -.3015866   .0801351    -3.76   0.000    -.4586897   -.1444835
 foreign_p_5 |  -.3070218   .0839018    -3.66   0.000    -.4715093   -.1425342
 foreign_p_6 |  -.3184208   .0894248    -3.56   0.000    -.4937362   -.1431054
             |
    ind_year |
          2  |  -.1067607   .0340973    -3.13   0.002    -.1736078   -.0399136
          3  |  -.1503537   .0433926    -3.46   0.001    -.2354239   -.0652834
          4  |  -.1975479   .0512315    -3.86   0.000    -.2979861   -.0971097
          5  |  -.2477227   .0600605    -4.12   0.000    -.3654699   -.1299755
          6  |  -.2720363   .0670779    -4.06   0.000     -.403541   -.1405316
          7  |  -.2741062   .0739631    -3.71   0.000    -.4191092   -.1291031
          8  |  -.2522042   .0824717    -3.06   0.002    -.4138881   -.0905202
          9  |  -.2513394   .0896355    -2.80   0.005    -.4270678   -.0756109
         10  |  -.2841783   .0979749    -2.90   0.004    -.4762559   -.0921008
         11  |  -.3406083   .1060878    -3.21   0.001    -.5485911   -.1326255
         12  |  -.3608759   .1140863    -3.16   0.002    -.5845396   -.1372123
         13  |   -.357834   .1219232    -2.93   0.003    -.5968618   -.1188062
         14  |  -.3148304   .1302803    -2.42   0.016    -.5702419   -.0594188
         15  |  -.2639172   .1384323    -1.91   0.057    -.5353107    .0074763
         16  |  -.2181639   .1468851    -1.49   0.138    -.5061289    .0698011
         17  |  -.2036701   .1560059    -1.31   0.192    -.5095163     .102176
         18  |  -.2541484   .1643061    -1.55   0.122    -.5762669    .0679702
         19  |  -.2577872   .1728257    -1.49   0.136    -.5966082    .0810338
         20  |  -.2821895   .1811552    -1.56   0.119    -.6373402    .0729613
         21  |  -.3380004   .1889704    -1.79   0.074    -.7084728     .032472
         22  |  -.3483402   .1961456    -1.78   0.076    -.7328793    .0361989
         23  |  -.3297349   .2038125    -1.62   0.106    -.7293048    .0698349
         24  |   -.327316   .2122647    -1.54   0.123    -.7434562    .0888242
         25  |  -.2776334   .2205351    -1.26   0.208    -.7099876    .1547208
         26  |   1.033686   .0943415    10.96   0.000     .8487312     1.21864
         27  |   .7840816   .0932652     8.41   0.000     .6012373     .966926
         28  |   .6617551   .0930481     7.11   0.000     .4793365    .8441738
         29  |   .5781717   .0936734     6.17   0.000      .394527    .7618163
         30  |   .5420387   .0949002     5.71   0.000      .355989    .7280884
         31  |   .5222817   .0987822     5.29   0.000     .3286214     .715942
         32  |   .4847663   .1022349     4.74   0.000     .2843371    .6851955
         33  |   .4411116   .1067185     4.13   0.000     .2318922    .6503309
         34  |   .4317446   .1120799     3.85   0.000     .2120145    .6514747
         35  |   .3889383   .1177196     3.30   0.001     .1581517    .6197249
         36  |   .2998248   .1237343     2.42   0.015     .0572465    .5424031
         37  |   .2563233   .1297178     1.98   0.048     .0020144    .5106322
         38  |   .2172026   .1366959     1.59   0.112    -.0507867    .4851919
         39  |   .1933308   .1438206     1.34   0.179    -.0886263     .475288
         40  |   .1777087   .1506371     1.18   0.238    -.1176119    .4730294
         41  |   .2110818    .157959     1.34   0.182    -.0985934    .5207569
         42  |   .2225918   .1662141     1.34   0.181    -.1032671    .5484508
         43  |   .0671564   .1752241     0.38   0.702    -.2763664    .4106793
         44  |   .0435538   .1842978     0.24   0.813    -.3177579    .4048656
         45  |    .093754   .1914744     0.49   0.624    -.2816273    .4691354
         46  |    .125291   .1985965     0.63   0.528    -.2640531    .5146351
         47  |   .1520889   .2053963     0.74   0.459    -.2505861    .5547638
         48  |   .1907262   .2117178     0.90   0.368    -.2243419    .6057943
         49  |   .2714194   .2196929     1.24   0.217    -.1592837    .7021224
         50  |   .3088625   .2273059     1.36   0.174    -.1367656    .7544906
             |
     age_cat |
          1  |    .403315   .0291645    13.83   0.000     .3461387    .4604914
          2  |   .7263564   .0376701    19.28   0.000      .652505    .8002078
          3  |   .9491782   .0454776    20.87   0.000     .8600204    1.038336
          4  |   1.138725   .0538346    21.15   0.000     1.033184    1.244267
          5  |   1.285632   .0622232    20.66   0.000     1.163645    1.407619
          6  |    1.40747   .0707388    19.90   0.000     1.268788    1.546152
          7  |   1.510715   .0795148    19.00   0.000     1.354828    1.666602
          8  |   1.599551   .0876844    18.24   0.000     1.427648    1.771454
          9  |   1.675237   .0956261    17.52   0.000     1.487764     1.86271
         10  |   1.731725   .1032019    16.78   0.000       1.5294     1.93405
         11  |    1.78109   .1110301    16.04   0.000     1.563418    1.998762
         12  |   1.844846   .1187271    15.54   0.000     1.612084    2.077608
         13  |   1.885204    .126311    14.93   0.000     1.637574    2.132834
         14  |   1.893414   .1341695    14.11   0.000     1.630378     2.15645
         15  |   1.924283   .1427141    13.48   0.000     1.644495    2.204071
         16  |    1.94281   .1512562    12.84   0.000     1.646276    2.239345
         17  |   1.956051    .159869    12.24   0.000     1.642632    2.269471
         18  |   1.973148   .1680805    11.74   0.000      1.64363    2.302666
         19  |   1.982651   .1760772    11.26   0.000     1.637456    2.327847
         20  |   1.978665   .1917562    10.32   0.000     1.602731    2.354598
         25  |   1.983666   .2207373     8.99   0.000     1.550916    2.416417
         30  |   1.650179   .3300612     5.00   0.000     1.003102    2.297257
         40  |   1.524973   .3576732     4.26   0.000     .8237629    2.226183
         50  |   1.327922   .4342019     3.06   0.002     .4766788    2.179165
             |
       _cons |   3.105964   .0794711    39.08   0.000     2.950162    3.261765
-------------+----------------------------------------------------------------
     sigma_u |  1.3805623
     sigma_e |  .70973017
         rho |  .79096015   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnL_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    228388
Group variable: firm_person                     Number of groups   =     20089

R-sq:  within  = 0.2526                         Obs per group: min =         1
       between = 0.0782                                        avg =      11.4
       overall = 0.0992                                        max =        25

                                                F(106,4531)        =     32.33
corr(u_i, Xb)  = 0.0026                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,532 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.1933202   .0391487    -4.94   0.000    -.2700708   -.1165696
   expat_m_2 |  -.1471288   .0348862    -4.22   0.000    -.2155226   -.0787349
   expat_m_3 |   -.095699   .0308763    -3.10   0.002    -.1562316   -.0351665
   expat_m_4 |  -.0361307   .0256821    -1.41   0.160    -.0864802    .0142188
domestic_m_1 |  -.2198611   .0362795    -6.06   0.000    -.2909866   -.1487356
domestic_m_2 |  -.1758715    .032355    -5.44   0.000    -.2393032   -.1124399
domestic_m_3 |  -.1208245   .0278355    -4.34   0.000    -.1753957   -.0662532
domestic_m_4 |  -.0598656   .0236084    -2.54   0.011    -.1061497   -.0135815
 foreign_m_1 |   .0323966   .0750109     0.43   0.666    -.1146613    .1794546
 foreign_m_2 |   .0105552   .0687935     0.15   0.878    -.1243137     .145424
 foreign_m_3 |   .0024988   .0638418     0.04   0.969    -.1226622    .1276598
 foreign_m_4 |    .035549   .0546539     0.65   0.515    -.0715994    .1426973
   expat_p_0 |  -.2758309   .0437623    -6.30   0.000    -.3616262   -.1900355
   expat_p_1 |  -.3378387   .0500869    -6.75   0.000    -.4360335   -.2396438
   expat_p_2 |  -.3984132    .055805    -7.14   0.000    -.5078182   -.2890083
   expat_p_3 |    -.41977   .0612596    -6.85   0.000    -.5398686   -.2996713
   expat_p_4 |  -.4719923   .0697372    -6.77   0.000    -.6087112   -.3352733
   expat_p_5 |  -.4862605   .0774603    -6.28   0.000    -.6381204   -.3344005
   expat_p_6 |  -.5777485   .0928679    -6.22   0.000    -.7598149    -.395682
domestic_p_0 |  -.3002876   .0411077    -7.30   0.000    -.3808789   -.2196964
domestic_p_1 |  -.3697977   .0471811    -7.84   0.000    -.4622957   -.2772997
domestic_p_2 |  -.4169111   .0543239    -7.67   0.000    -.5234125   -.3104098
domestic_p_3 |  -.4745388      .0613    -7.74   0.000    -.5947167   -.3543608
domestic_p_4 |  -.4948145   .0693179    -7.14   0.000    -.6307115   -.3589176
domestic_p_5 |  -.4552228   .0775646    -5.87   0.000    -.6072873   -.3031583
domestic_p_6 |  -.4464335   .0909411    -4.91   0.000    -.6247223   -.2681447
 foreign_p_0 |  -.0616946   .0805921    -0.77   0.444    -.2196944    .0963053
 foreign_p_1 |   .1324544   .0844445     1.57   0.117    -.0330981    .2980069
 foreign_p_2 |   .1439981   .0890982     1.62   0.106    -.0306779    .3186741
 foreign_p_3 |   .1378058    .094838     1.45   0.146    -.0481229    .3237344
 foreign_p_4 |   .1175617   .1006747     1.17   0.243    -.0798099    .3149333
 foreign_p_5 |   .0821955   .1067009     0.77   0.441    -.1269903    .2913814
 foreign_p_6 |   .0485318     .11457     0.42   0.672    -.1760813    .2731449
             |
    ind_year |
          2  |   .1045134   .0556301     1.88   0.060    -.0045487    .2135755
          3  |   .6096241   .0711535     8.57   0.000     .4701286    .7491196
          4  |   .7230693    .085346     8.47   0.000     .5557495    .8903892
          5  |   .9313566    .097269     9.58   0.000     .7406618    1.122051
          6  |   1.092882   .1091241    10.02   0.000     .8789452    1.306818
          7  |   1.322008   .1219292    10.84   0.000     1.082967    1.561049
          8  |   1.516834   .1351602    11.22   0.000     1.251854    1.781814
          9  |   1.651438   .1478529    11.17   0.000     1.361575    1.941302
         10  |   1.726679   .1604132    10.76   0.000     1.412191    2.041167
         11  |   1.784402   .1727705    10.33   0.000     1.445688    2.123117
         12  |   1.799038   .1861929     9.66   0.000     1.434009    2.164067
         13  |   1.858668   .2000279     9.29   0.000     1.466516     2.25082
         14  |   1.933826   .2126841     9.09   0.000     1.516861    2.350791
         15  |    1.97197   .2265223     8.71   0.000     1.527876    2.416065
         16  |   2.014113   .2408158     8.36   0.000     1.541996    2.486229
         17  |   2.070855   .2542702     8.14   0.000     1.572362    2.569349
         18  |    2.02351   .2692949     7.51   0.000     1.495561    2.551459
         19  |    1.96641   .2840511     6.92   0.000     1.409531    2.523288
         20  |   1.972939   .2983807     6.61   0.000     1.387968    2.557911
         21  |    1.95789   .3116215     6.28   0.000      1.34696     2.56882
         22  |   1.977472   .3229157     6.12   0.000       1.3444    2.610544
         23  |   2.044165   .3363911     6.08   0.000     1.384674    2.703655
         24  |   1.435038    .354809     4.04   0.000     .7394395    2.130637
         25  |   1.523728   .3753605     4.06   0.000     .7878382    2.259617
         26  |   1.362934   .1357622    10.04   0.000     1.096774    1.629094
         27  |   1.287586   .1322466     9.74   0.000     1.028318    1.546854
         28  |   1.401971   .1308487    10.71   0.000     1.145444    1.658499
         29  |   1.474383   .1350525    10.92   0.000     1.209614    1.739152
         30  |   1.580473   .1402466    11.27   0.000     1.305521    1.855425
         31  |   1.687841   .1485648    11.36   0.000     1.396581      1.9791
         32  |   1.886475   .1562129    12.08   0.000     1.580222    2.192729
         33  |   2.042205    .165213    12.36   0.000     1.718307    2.366104
         34  |   2.165282    .175315    12.35   0.000     1.821579    2.508985
         35  |   2.254645   .1864542    12.09   0.000     1.889104    2.620186
         36  |   2.237655   .1985311    11.27   0.000     1.848437    2.626873
         37  |   2.287684   .2090028    10.95   0.000     1.877936    2.697431
         38  |   2.350551   .2213986    10.62   0.000     1.916502      2.7846
         39  |   2.405738    .234238    10.27   0.000     1.946517    2.864959
         40  |   2.463046   .2466736     9.99   0.000     1.979445    2.946647
         41  |    2.52075   .2607686     9.67   0.000     2.009517    3.031984
         42  |   2.595221   .2731461     9.50   0.000     2.059722    3.130721
         43  |   2.588243   .2862053     9.04   0.000     2.027141    3.149345
         44  |     2.5597   .3003021     8.52   0.000     1.970961    3.148439
         45  |   2.701842   .3150786     8.58   0.000     2.084134     3.31955
         46  |   2.747787   .3285731     8.36   0.000     2.103624    3.391951
         47  |    2.86111    .341001     8.39   0.000     2.192582    3.529638
         48  |   2.990153   .3524989     8.48   0.000     2.299084    3.681223
         49  |   2.940159   .3633964     8.09   0.000     2.227724    3.652593
         50  |   3.057444   .3770833     8.11   0.000     2.318176    3.796711
             |
     age_cat |
          1  |   .4073807   .0488032     8.35   0.000     .3117026    .5030588
          2  |   .6884261   .0604992    11.38   0.000     .5698181    .8070341
          3  |   .8486465   .0727302    11.67   0.000     .7060597    .9912332
          4  |   1.003415   .0858023    11.69   0.000     .8352001    1.171629
          5  |   1.092605   .0997515    10.95   0.000     .8970438    1.288167
          6  |   1.183878   .1138124    10.40   0.000     .9607505    1.407006
          7  |   1.243815   .1281021     9.71   0.000     .9926725    1.494958
          8  |    1.29219   .1415482     9.13   0.000     1.014686    1.569693
          9  |   1.324282   .1548758     8.55   0.000      1.02065    1.627914
         10  |   1.334242   .1678065     7.95   0.000      1.00526    1.663225
         11  |   1.371357   .1808289     7.58   0.000     1.016844     1.72587
         12  |   1.405835   .1938176     7.25   0.000     1.025858    1.785813
         13  |    1.38921   .2072587     6.70   0.000     .9828815    1.795538
         14  |   1.391181   .2205475     6.31   0.000        .9588    1.823562
         15  |   1.372335   .2340667     5.86   0.000     .9134501     1.83122
         16  |   1.387848   .2487866     5.58   0.000     .9001054    1.875591
         17  |   1.398038   .2621606     5.33   0.000     .8840756    1.912001
         18  |   1.381206   .2760015     5.00   0.000     .8401085    1.922303
         19  |   1.371299    .290852     4.71   0.000     .8010878    1.941511
         20  |   1.335827   .3181128     4.20   0.000     .7121709    1.959483
         25  |   1.276689   .3692225     3.46   0.001     .5528324    2.000545
         30  |   .8579242   .5253191     1.63   0.103    -.1719575    1.887806
         40  |   .5626714   .6096756     0.92   0.356      -.63259    1.757933
         50  |   .5471947   .7083112     0.77   0.440    -.8414406     1.93583
             |
       _cons |   8.145109   .1183114    68.84   0.000     7.913161    8.377057
-------------+----------------------------------------------------------------
     sigma_u |  2.1990992
     sigma_e |  1.0251441
         rho |  .82148328   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnK_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    241615
Group variable: firm_person                     Number of groups   =     20311

R-sq:  within  = 0.4583                         Obs per group: min =         1
       between = 0.0855                                        avg =      11.9
       overall = 0.1528                                        max =        25

                                                F(106,4618)        =     79.22
corr(u_i, Xb)  = -0.0565                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,619 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0101917   .0309373    -0.33   0.742    -.0708437    .0504602
   expat_m_2 |   .0026901    .027442     0.10   0.922    -.0511093    .0564894
   expat_m_3 |   .0203661   .0244307     0.83   0.405    -.0275299     .068262
   expat_m_4 |    .026129   .0214972     1.22   0.224    -.0160159    .0682738
domestic_m_1 |  -.2379133   .0290483    -8.19   0.000    -.2948619   -.1809647
domestic_m_2 |  -.1581016   .0258163    -6.12   0.000    -.2087138   -.1074894
domestic_m_3 |   -.103043     .02215    -4.65   0.000    -.1464676   -.0596184
domestic_m_4 |  -.0532034   .0188493    -2.82   0.005     -.090157   -.0162498
 foreign_m_1 |  -.1815671   .0614627    -2.95   0.003    -.3020634   -.0610708
 foreign_m_2 |  -.1886161   .0579814    -3.25   0.001    -.3022873   -.0749448
 foreign_m_3 |  -.1766431    .052065    -3.39   0.001    -.2787153   -.0745709
 foreign_m_4 |  -.1493403   .0436011    -3.43   0.001    -.2348192   -.0638613
   expat_p_0 |  -.0732906   .0343086    -2.14   0.033    -.1405519   -.0060293
   expat_p_1 |  -.1110332   .0393122    -2.82   0.005    -.1881039   -.0339625
   expat_p_2 |      -.162   .0435824    -3.72   0.000    -.2474424   -.0765576
   expat_p_3 |  -.1775377   .0499825    -3.55   0.000    -.2755272   -.0795482
   expat_p_4 |  -.1875121   .0534022    -3.51   0.000    -.2922059   -.0828183
   expat_p_5 |  -.1968651    .058661    -3.36   0.001    -.3118686   -.0818615
   expat_p_6 |  -.3304983    .080995    -4.08   0.000    -.4892871   -.1717095
domestic_p_0 |  -.3122483   .0324635    -9.62   0.000    -.3758922   -.2486043
domestic_p_1 |  -.3395509   .0375919    -9.03   0.000    -.4132491   -.2658527
domestic_p_2 |  -.3624019    .043916    -8.25   0.000    -.4484982   -.2763056
domestic_p_3 |  -.3785064    .048438    -7.81   0.000    -.4734681   -.2835447
domestic_p_4 |  -.4386583   .0566618    -7.74   0.000    -.5497425   -.3275741
domestic_p_5 |  -.4388722   .0604799    -7.26   0.000    -.5574418   -.3203027
domestic_p_6 |  -.4816065   .0734871    -6.55   0.000    -.6256762   -.3375367
 foreign_p_0 |  -.4858859   .0666998    -7.28   0.000    -.6166495   -.3551224
 foreign_p_1 |  -.0806733   .0700376    -1.15   0.249    -.2179805    .0566339
 foreign_p_2 |  -.0540209   .0746576    -0.72   0.469    -.2003854    .0923436
 foreign_p_3 |  -.0668999   .0798669    -0.84   0.402    -.2234771    .0896774
 foreign_p_4 |  -.0790506   .0848935    -0.93   0.352    -.2454824    .0873811
 foreign_p_5 |  -.0716215   .0896528    -0.80   0.424    -.2473839    .1041409
 foreign_p_6 |  -.0503575   .0961129    -0.52   0.600    -.2387847    .1380696
             |
    ind_year |
          2  |   -.025568   .0437249    -0.58   0.559    -.1112898    .0601538
          3  |   .1195993   .0526759     2.27   0.023     .0163295    .2228692
          4  |   .2816276   .0634245     4.44   0.000     .1572852    .4059699
          5  |   .4960124    .073017     6.79   0.000     .3528642    .6391605
          6  |   .6532449   .0836359     7.81   0.000     .4892786    .8172113
          7  |   .8139213   .0933899     8.72   0.000     .6308324    .9970102
          8  |   .9310162   .1057116     8.81   0.000     .7237709    1.138262
          9  |   1.076877   .1155691     9.32   0.000     .8503066    1.303448
         10  |     1.1648   .1274434     9.14   0.000     .9149502     1.41465
         11  |   1.205614   .1388653     8.68   0.000     .9333721    1.477857
         12  |     1.2754   .1501362     8.49   0.000     .9810616    1.569739
         13  |   1.359947   .1617001     8.41   0.000     1.042938    1.676957
         14  |   1.484292   .1731999     8.57   0.000     1.144738    1.823847
         15  |   1.599644   .1847863     8.66   0.000     1.237374    1.961913
         16  |   1.671066   .1968802     8.49   0.000     1.285086    2.057045
         17  |    1.73886   .2085321     8.34   0.000     1.330037    2.147683
         18  |   1.638534   .2209935     7.41   0.000     1.205281    2.071787
         19  |   1.708772   .2334337     7.32   0.000      1.25113    2.166414
         20  |   1.755724   .2450366     7.17   0.000     1.275336    2.236113
         21  |   1.724261   .2556714     6.74   0.000     1.223023      2.2255
         22  |   1.792135   .2664201     6.73   0.000     1.269824    2.314446
         23  |   1.905163   .2768087     6.88   0.000     1.362485     2.44784
         24  |   1.942115   .2870413     6.77   0.000     1.379377    2.504853
         25  |   2.005069   .2983957     6.72   0.000     1.420071    2.590067
         26  |   .5248651   .1029343     5.10   0.000     .3230646    .7266655
         27  |    .379204   .1002697     3.78   0.000     .1826275    .5757805
         28  |   .5173772   .1004855     5.15   0.000     .3203776    .7143769
         29  |   .7457622   .1008628     7.39   0.000     .5480229    .9435016
         30  |   .9120755    .104603     8.72   0.000     .7070037    1.117147
         31  |   1.104983   .1107698     9.98   0.000     .8878208    1.322144
         32  |   1.252254   .1173071    10.68   0.000     1.022276    1.482232
         33  |   1.343958   .1252686    10.73   0.000     1.098372    1.589545
         34  |   1.520306   .1331827    11.42   0.000     1.259205    1.781408
         35  |   1.588665   .1425721    11.14   0.000     1.309155    1.868174
         36  |   1.585877     .15232    10.41   0.000     1.287257    1.884497
         37  |   1.674062   .1613742    10.37   0.000     1.357691    1.990433
         38  |   1.713746    .172759     9.92   0.000     1.375056    2.052436
         39  |   1.816592   .1833721     9.91   0.000     1.457095    2.176089
         40  |   1.938771   .1939037    10.00   0.000     1.558627    2.318915
         41  |   2.043023   .2042514    10.00   0.000     1.642593    2.443454
         42  |   2.139995   .2150292     9.95   0.000     1.718435    2.561555
         43  |   1.987468   .2259051     8.80   0.000     1.544586     2.43035
         44  |   2.076014   .2390514     8.68   0.000     1.607359    2.544669
         45  |   2.231599   .2496631     8.94   0.000      1.74214    2.721058
         46  |   2.331095   .2596528     8.98   0.000     1.822052    2.840139
         47  |   2.433418    .269333     9.03   0.000     1.905397    2.961439
         48  |   2.538705   .2790258     9.10   0.000     1.991681    3.085729
         49  |   2.666402    .288721     9.24   0.000      2.10037    3.232433
         50  |    2.74828   .2990757     9.19   0.000     2.161949    3.334612
             |
     age_cat |
          1  |   1.043619   .0458933    22.74   0.000      .953646    1.133592
          2  |   1.425479   .0534812    26.65   0.000     1.320631    1.530328
          3  |   1.638049   .0622152    26.33   0.000     1.516077     1.76002
          4  |   1.802354   .0713581    25.26   0.000     1.662458     1.94225
          5  |   1.914759   .0819263    23.37   0.000     1.754144    2.075373
          6  |   1.999258   .0922306    21.68   0.000     1.818442    2.180074
          7  |   2.073306   .1033183    20.07   0.000     1.870753     2.27586
          8  |    2.10643   .1139656    18.48   0.000     1.883003    2.329857
          9  |   2.150938   .1244845    17.28   0.000     1.906889    2.394987
         10  |   2.180051   .1350981    16.14   0.000     1.915194    2.444908
         11  |   2.210329   .1460925    15.13   0.000     1.923918     2.49674
         12  |     2.2363   .1570021    14.24   0.000     1.928501    2.544099
         13  |   2.247085   .1676619    13.40   0.000     1.918387    2.575782
         14  |   2.229189   .1789213    12.46   0.000     1.878418     2.57996
         15  |   2.240914   .1906244    11.76   0.000     1.867199    2.614628
         16  |   2.207973   .2022015    10.92   0.000     1.811562    2.604385
         17  |   2.178287   .2138598    10.19   0.000      1.75902    2.597555
         18  |   2.187722    .225129     9.72   0.000     1.746361    2.629082
         19  |   2.139249   .2364223     9.05   0.000     1.675749     2.60275
         20  |   2.065063   .2603856     7.93   0.000     1.554583    2.575543
         25  |   1.918235    .300042     6.39   0.000     1.330009     2.50646
         30  |   1.555537   .4004428     3.88   0.000     .7704775    2.340596
         40  |   1.363954   .4808258     2.84   0.005     .4213054    2.306602
         50  |    1.11293   .5780749     1.93   0.054    -.0203726    2.246234
             |
       _cons |   10.61902   .0901153   117.84   0.000     10.44235    10.79569
-------------+----------------------------------------------------------------
     sigma_u |  1.8592823
     sigma_e |  .85685804
         rho |  .82481941   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnQ_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    228388
Group variable: firm_person                     Number of groups   =     20089

R-sq:  within  = 0.1600                         Obs per group: min =         1
       between = 0.0511                                        avg =      11.4
       overall = 0.0856                                        max =        25

                                                F(106,4531)        =     21.35
corr(u_i, Xb)  = -0.0735                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,532 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.1336295    .030509    -4.38   0.000     -.193442    -.073817
   expat_m_2 |  -.1154921    .027909    -4.14   0.000    -.1702073   -.0607768
   expat_m_3 |  -.0832675   .0250777    -3.32   0.001    -.1324319    -.034103
   expat_m_4 |  -.0390051   .0209805    -1.86   0.063     -.080137    .0021269
domestic_m_1 |  -.0335054   .0284718    -1.18   0.239    -.0893241    .0223133
domestic_m_2 |  -.0411188   .0257148    -1.60   0.110    -.0915323    .0092947
domestic_m_3 |  -.0315949   .0223518    -1.41   0.158    -.0754154    .0122256
domestic_m_4 |  -.0100815   .0194127    -0.52   0.604    -.0481399    .0279768
 foreign_m_1 |   .2695651   .0612245     4.40   0.000     .1495351     .389595
 foreign_m_2 |   .2266305   .0537153     4.22   0.000     .1213224    .3319386
 foreign_m_3 |   .2018429   .0497603     4.06   0.000     .1042885    .2993974
 foreign_m_4 |   .2027516   .0419631     4.83   0.000     .1204835    .2850198
   expat_p_0 |   -.167441   .0338445    -4.95   0.000    -.2337927   -.1010893
   expat_p_1 |   -.186661   .0381904    -4.89   0.000    -.2615328   -.1117892
   expat_p_2 |  -.2348565   .0432056    -5.44   0.000    -.3195606   -.1501524
   expat_p_3 |  -.2609866   .0473967    -5.51   0.000    -.3539073   -.1680659
   expat_p_4 |  -.2959658   .0539446    -5.49   0.000    -.4017235   -.1902081
   expat_p_5 |  -.2631485   .0617651    -4.26   0.000    -.3842382   -.1420588
   expat_p_6 |  -.2360597   .0780979    -3.02   0.003    -.3891698   -.0829497
domestic_p_0 |  -.0632533   .0320012    -1.98   0.048    -.1259912   -.0005154
domestic_p_1 |  -.0948024   .0361485    -2.62   0.009    -.1656711   -.0239337
domestic_p_2 |    -.12633   .0404332    -3.12   0.002    -.2055987   -.0470613
domestic_p_3 |  -.1673896   .0458168    -3.65   0.000    -.2572128   -.0775664
domestic_p_4 |  -.1794575   .0521405    -3.44   0.001    -.2816783   -.0772367
domestic_p_5 |  -.1556898   .0617975    -2.52   0.012     -.276843   -.0345365
domestic_p_6 |  -.1126259   .0696385    -1.62   0.106    -.2491513    .0238996
 foreign_p_0 |    .468748   .0645849     7.26   0.000       .34213    .5953659
 foreign_p_1 |   .4548548   .0675647     6.73   0.000     .3223951    .5873145
 foreign_p_2 |   .4454738   .0715197     6.23   0.000     .3052602    .5856873
 foreign_p_3 |   .4290249   .0764407     5.61   0.000     .2791638     .578886
 foreign_p_4 |   .4119583   .0809859     5.09   0.000     .2531864    .5707303
 foreign_p_5 |   .3844345   .0857831     4.48   0.000     .2162577    .5526113
 foreign_p_6 |   .3548949   .0917068     3.87   0.000     .1751048     .534685
             |
    ind_year |
          2  |   .1949518   .0489825     3.98   0.000     .0989223    .2909813
          3  |   .7545712   .0618766    12.19   0.000     .6332629    .8758796
          4  |   .9163473   .0733874    12.49   0.000     .7724723    1.060222
          5  |   1.164613   .0832181    13.99   0.000     1.001465    1.327761
          6  |   1.347247    .093588    14.40   0.000     1.163769    1.530725
          7  |   1.585417   .1047371    15.14   0.000     1.380082    1.790753
          8  |   1.760443   .1163743    15.13   0.000     1.532293    1.988593
          9  |   1.895313   .1271691    14.90   0.000        1.646    2.144627
         10  |   2.004542   .1387504    14.45   0.000     1.732524    2.276561
         11  |   2.109889   .1499748    14.07   0.000     1.815866    2.403913
         12  |   2.140335   .1624857    13.17   0.000     1.821784    2.458886
         13  |   2.206801   .1756176    12.57   0.000     1.862505    2.551097
         14  |   2.226837   .1872656    11.89   0.000     1.859705    2.593969
         15  |   2.212673   .1998563    11.07   0.000     1.820857    2.604489
         16  |   2.196418   .2126864    10.33   0.000     1.779449    2.613387
         17  |   2.230068   .2253198     9.90   0.000     1.788331    2.671804
         18  |   2.236542   .2389177     9.36   0.000     1.768147    2.704938
         19  |   2.217629   .2524422     8.78   0.000     1.722719    2.712538
         20  |   2.236385   .2652961     8.43   0.000     1.716275    2.756494
         21  |   2.251885   .2778169     8.11   0.000     1.707228    2.796541
         22  |   2.285967    .288178     7.93   0.000     1.720997    2.850936
         23  |   2.325182   .3002468     7.74   0.000     1.736552    2.913813
         24  |   1.590723   .3177703     5.01   0.000     .9677378    2.213707
         25  |   1.651226   .3371659     4.90   0.000     .9902159    2.312235
         26  |   .3498727   .1033961     3.38   0.001      .147166    .5525794
         27  |   .5302413   .0982903     5.39   0.000     .3375443    .7229382
         28  |   .7645307   .0979785     7.80   0.000     .5724451    .9566163
         29  |    .928555   .1030193     9.01   0.000     .7265869    1.130523
         30  |   1.071819   .1079098     9.93   0.000     .8602634    1.283375
         31  |   1.204946   .1153696    10.44   0.000     .9787656    1.431127
         32  |   1.445648   .1228968    11.76   0.000     1.204711    1.686586
         33  |   1.644685    .132347    12.43   0.000     1.385221     1.90415
         34  |   1.781844    .142032    12.55   0.000     1.503392    2.060296
         35  |   1.905649   .1522009    12.52   0.000     1.607261    2.204037
         36  |   1.977846   .1633606    12.11   0.000     1.657579    2.298112
         37  |   2.072979   .1741413    11.90   0.000     1.731577    2.414381
         38  |   2.161738   .1864048    11.60   0.000     1.796293    2.527182
         39  |   2.231963   .1982759    11.26   0.000     1.843245     2.62068
         40  |   2.313873   .2094203    11.05   0.000     1.903307    2.724438
         41  |   2.321561   .2227496    10.42   0.000     1.884864    2.758259
         42  |   2.387172   .2344832    10.18   0.000      1.92747    2.846873
         43  |   2.540089   .2486693    10.21   0.000     2.052576    3.027602
         44  |   2.527781   .2613323     9.67   0.000     2.015442     3.04012
         45  |   2.615391   .2738433     9.55   0.000     2.078525    3.152258
         46  |   2.637245   .2852563     9.25   0.000     2.078004    3.196486
         47  |   2.717936   .2968061     9.16   0.000     2.136051     3.29982
         48  |    2.79939   .3081626     9.08   0.000     2.195241    3.403539
         49  |    2.61524   .3177378     8.23   0.000     1.992319    3.238161
         50  |   2.684213   .3306128     8.12   0.000     2.036051    3.332375
             |
     age_cat |
          1  |   .0179563   .0451278     0.40   0.691    -.0705163    .1064289
          2  |  -.0263224   .0548808    -0.48   0.632    -.1339154    .0812707
          3  |  -.0721956   .0647299    -1.12   0.265    -.1990977    .0547065
          4  |  -.0902556   .0755017    -1.20   0.232    -.2382757    .0577645
          5  |  -.1471893   .0870144    -1.69   0.091      -.31778    .0234013
          6  |  -.1735083   .0987961    -1.76   0.079    -.3671968    .0201802
          7  |  -.2132173   .1108395    -1.92   0.054    -.4305167    .0040822
          8  |  -.2548492   .1228768    -2.07   0.038    -.4957477   -.0139507
          9  |   -.299269   .1350336    -2.22   0.027    -.5640008   -.0345372
         10  |  -.3501811   .1467428    -2.39   0.017    -.6378685   -.0624937
         11  |  -.3590259   .1588696    -2.26   0.024    -.6704877   -.0475641
         12  |  -.3741492   .1708012    -2.19   0.029    -.7090029   -.0392955
         13  |  -.4271934   .1831622    -2.33   0.020    -.7862806   -.0681061
         14  |  -.4361785   .1956781    -2.23   0.026     -.819803    -.052554
         15  |  -.4795248   .2078288    -2.31   0.021    -.8869707   -.0720789
         16  |  -.4898903    .221359    -2.21   0.027    -.9238618   -.0559188
         17  |  -.4794072   .2341505    -2.05   0.041    -.9384564    -.020358
         18  |  -.5338452   .2471125    -2.16   0.031    -1.018306   -.0493842
         19  |  -.5592958   .2606872    -2.15   0.032     -1.07037   -.0482217
         20  |  -.5896113   .2875593    -2.05   0.040    -1.153368   -.0258549
         25  |   -.696448   .3375602    -2.06   0.039    -1.358231   -.0346654
         30  |  -.7176919   .4545347    -1.58   0.114    -1.608801    .1734177
         40  |  -.8827411   .5460176    -1.62   0.106    -1.953202    .1877197
         50  |  -.7287189   .6375387    -1.14   0.253    -1.978606    .5211678
             |
       _cons |   4.967101   .0935133    53.12   0.000      4.78377    5.150433
-------------+----------------------------------------------------------------
     sigma_u |  1.5494431
     sigma_e |  .87693602
         rho |  .75739194   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnKL_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    241615
Group variable: firm_person                     Number of groups   =     20311

R-sq:  within  = 0.4044                         Obs per group: min =         1
       between = 0.1657                                        avg =      11.9
       overall = 0.2216                                        max =        25

                                                F(106,4618)        =     78.89
corr(u_i, Xb)  = -0.0481                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,619 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |   .0409238   .0197426     2.07   0.038     .0022188    .0796288
   expat_m_2 |   .0208001   .0180044     1.16   0.248     -.014497    .0560973
   expat_m_3 |   .0253275   .0161917     1.56   0.118    -.0064161     .057071
   expat_m_4 |   .0209201   .0145295     1.44   0.150    -.0075647     .049405
domestic_m_1 |  -.0574302   .0190317    -3.02   0.003    -.0947415   -.0201189
domestic_m_2 |  -.0290816   .0170434    -1.71   0.088    -.0624948    .0043316
domestic_m_3 |  -.0160666   .0150768    -1.07   0.287    -.0456243    .0134912
domestic_m_4 |  -.0115914   .0138046    -0.84   0.401    -.0386549    .0154721
 foreign_m_1 |   .0669845   .0397335     1.69   0.092    -.0109121    .1448811
 foreign_m_2 |   .0379539   .0371687     1.02   0.307    -.0349144    .1108223
 foreign_m_3 |   .0208698    .034263     0.61   0.542     -.046302    .0880416
 foreign_m_4 |   .0337933   .0305418     1.11   0.269    -.0260832    .0936698
   expat_p_0 |   .0345558   .0217139     1.59   0.112    -.0080137    .0771254
   expat_p_1 |   .0428399   .0244227     1.75   0.079    -.0050402      .09072
   expat_p_2 |   .0097117   .0275245     0.35   0.724    -.0442496    .0636729
   expat_p_3 |   .0099903   .0306762     0.33   0.745    -.0501497    .0701304
   expat_p_4 |   -.006248   .0350804    -0.18   0.859    -.0750222    .0625263
   expat_p_5 |   .0249097   .0370274     0.67   0.501    -.0476816     .097501
   expat_p_6 |   .0163503    .047783     0.34   0.732    -.0773272    .1100278
domestic_p_0 |  -.0658599   .0207745    -3.17   0.002    -.1065878   -.0251321
domestic_p_1 |  -.0636238   .0235975    -2.70   0.007    -.1098863   -.0173614
domestic_p_2 |  -.0760221   .0275551    -2.76   0.006    -.1300432   -.0220009
domestic_p_3 |  -.0741551   .0295644    -2.51   0.012    -.1321155   -.0161947
domestic_p_4 |  -.1167646   .0365849    -3.19   0.001    -.1884886   -.0450407
domestic_p_5 |  -.1096589   .0383431    -2.86   0.004    -.1848296   -.0344881
domestic_p_6 |  -.1577358   .0457769    -3.45   0.001    -.2474805   -.0679911
 foreign_p_0 |   .0228752   .0416984     0.55   0.583    -.0588735    .1046239
 foreign_p_1 |    .206257   .0434912     4.74   0.000     .1209934    .2915206
 foreign_p_2 |   .2262518   .0462467     4.89   0.000     .1355862    .3169174
 foreign_p_3 |   .2216879   .0494033     4.49   0.000     .1248338    .3185421
 foreign_p_4 |   .2225359   .0525296     4.24   0.000     .1195528     .325519
 foreign_p_5 |   .2354002   .0554374     4.25   0.000     .1267165    .3440839
 foreign_p_6 |   .2680632   .0597864     4.48   0.000     .1508533    .3852732
             |
    ind_year |
          2  |   .0811927    .035969     2.26   0.024     .0106762    .1517092
          3  |    .269953   .0405344     6.66   0.000     .1904862    .3494198
          4  |   .4791754    .046348    10.34   0.000     .3883112    .5700396
          5  |    .743735   .0501522    14.83   0.000     .6454128    .8420573
          6  |   .9252812   .0565141    16.37   0.000     .8144866    1.036076
          7  |   1.088027    .062248    17.48   0.000     .9659917    1.210063
          8  |    1.18322   .0685658    17.26   0.000     1.048799    1.317642
          9  |   1.328217   .0746723    17.79   0.000     1.181823     1.47461
         10  |   1.448979   .0810575    17.88   0.000     1.290067     1.60789
         11  |   1.546223   .0871388    17.74   0.000     1.375389    1.717056
         12  |   1.636276    .093727    17.46   0.000     1.452526    1.820026
         13  |   1.717781   .1006504    17.07   0.000     1.520458    1.915104
         14  |   1.799123   .1071689    16.79   0.000      1.58902    2.009225
         15  |   1.863561   .1138163    16.37   0.000     1.640427    2.086695
         16  |    1.88923   .1208225    15.64   0.000      1.65236    2.126099
         17  |    1.94253   .1277337    15.21   0.000     1.692111    2.192949
         18  |   1.892682   .1350076    14.02   0.000     1.628003    2.157361
         19  |   1.966559   .1426955    13.78   0.000     1.686808    2.246311
         20  |   2.037914   .1498645    13.60   0.000     1.744108     2.33172
         21  |   2.062262   .1559281    13.23   0.000     1.756568    2.367955
         22  |   2.140475   .1626377    13.16   0.000     1.821627    2.459323
         23  |   2.234898   .1688937    13.23   0.000     1.903785     2.56601
         24  |   2.269431   .1754126    12.94   0.000     1.925539    2.613324
         25  |   2.282702   .1826435    12.50   0.000     1.924634    2.640771
         26  |  -.5088206   .0652327    -7.80   0.000    -.6367078   -.3809333
         27  |  -.4048776   .0645651    -6.27   0.000    -.5314561   -.2782992
         28  |  -.1443779   .0645015    -2.24   0.025    -.2708316   -.0179242
         29  |   .1675906   .0660626     2.54   0.011     .0380763    .2971049
         30  |   .3700368   .0673975     5.49   0.000     .2379055    .5021682
         31  |   .5827009   .0709804     8.21   0.000     .4435455    .7218563
         32  |   .7674877   .0749939    10.23   0.000     .6204639    .9145115
         33  |   .9028467   .0787376    11.47   0.000     .7484834     1.05721
         34  |   1.088562   .0836556    13.01   0.000     .9245569    1.252567
         35  |   1.199727   .0884387    13.57   0.000     1.026345    1.373109
         36  |   1.286052   .0942885    13.64   0.000     1.101201    1.470902
         37  |   1.417739    .100378    14.12   0.000      1.22095    1.614528
         38  |   1.496543   .1067201    14.02   0.000     1.287321    1.705766
         39  |   1.623262   .1132211    14.34   0.000     1.401294    1.845229
         40  |   1.761062   .1198273    14.70   0.000     1.526144    1.995981
         41  |   1.831942   .1261218    14.53   0.000     1.584683    2.079201
         42  |   1.917403   .1320601    14.52   0.000     1.658502    2.176304
         43  |   1.920312   .1389973    13.82   0.000      1.64781    2.192813
         44  |    2.03246   .1462946    13.89   0.000     1.745653    2.319268
         45  |   2.137845   .1528689    13.98   0.000     1.838149    2.437541
         46  |   2.205804   .1582775    13.94   0.000     1.895505    2.516104
         47  |   2.281329   .1638079    13.93   0.000     1.960187    2.602471
         48  |   2.347979   .1696738    13.84   0.000     2.015337    2.680621
         49  |   2.394982   .1754597    13.65   0.000     2.050997    2.738967
         50  |   2.439418   .1816784    13.43   0.000     2.083242    2.795594
             |
     age_cat |
          1  |   .6403037   .0369572    17.33   0.000     .5678499    .7127575
          2  |   .6991228   .0408426    17.12   0.000     .6190517    .7791939
          3  |   .6888704   .0454361    15.16   0.000     .5997939    .7779469
          4  |   .6636292   .0501135    13.24   0.000     .5653829    .7618756
          5  |   .6291263   .0562225    11.19   0.000     .5189033    .7393494
          6  |    .591788   .0619759     9.55   0.000     .4702856    .7132904
          7  |   .5625911   .0680237     8.27   0.000     .4292321    .6959502
          8  |   .5068787   .0741998     6.83   0.000     .3614116    .6523458
          9  |   .4757011   .0802678     5.93   0.000     .3183378    .6330645
         10  |   .4483259   .0862398     5.20   0.000     .2792546    .6173972
         11  |   .4292388   .0927304     4.63   0.000     .2474429    .6110347
         12  |   .3914545   .0992637     3.94   0.000     .1968502    .5860588
         13  |   .3618811   .1056082     3.43   0.001     .1548385    .5689237
         14  |   .3357754   .1121869     2.99   0.003     .1158355    .5557152
         15  |   .3166309   .1191311     2.66   0.008     .0830771    .5501848
         16  |    .265163   .1263206     2.10   0.036     .0175142    .5128117
         17  |    .222236    .133411     1.67   0.096    -.0393134    .4837853
         18  |   .2145734   .1399741     1.53   0.125    -.0598427    .4889895
         19  |   .1565979    .146812     1.07   0.286    -.1312238    .4444196
         20  |   .0863983   .1602707     0.54   0.590    -.2278089    .4006055
         25  |  -.0654314   .1836731    -0.36   0.722    -.4255185    .2946557
         30  |  -.0946425   .2553236    -0.37   0.711    -.5951987    .4059136
         40  |  -.1610195   .2928916    -0.55   0.583    -.7352269    .4131879
         50  |  -.2149916   .3489855    -0.62   0.538    -.8991699    .4691867
             |
       _cons |   7.513055   .0626807   119.86   0.000     7.390171    7.635939
-------------+----------------------------------------------------------------
     sigma_u |   1.239248
     sigma_e |  .62310532
         rho |  .79820111   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnQL_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    241615
Group variable: firm_person                     Number of groups   =     20311

R-sq:  within  = 0.0412                         Obs per group: min =         1
       between = 0.1239                                        avg =      11.9
       overall = 0.0786                                        max =        25

                                                F(106,4618)        =      7.67
corr(u_i, Xb)  = 0.1343                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,619 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0283032   .0088618    -3.19   0.001    -.0456766   -.0109298
   expat_m_2 |  -.0211612   .0082638    -2.56   0.010    -.0373623   -.0049601
   expat_m_3 |  -.0111994   .0075577    -1.48   0.138    -.0260162    .0036173
   expat_m_4 |  -.0098694   .0068287    -1.45   0.148    -.0232568     .003518
domestic_m_1 |   -.046472   .0088014    -5.28   0.000    -.0637269   -.0292171
domestic_m_2 |  -.0309001   .0077625    -3.98   0.000    -.0461183   -.0156819
domestic_m_3 |  -.0203346    .006988    -2.91   0.004    -.0340345   -.0066347
domestic_m_4 |  -.0158656   .0062088    -2.56   0.011    -.0280377   -.0036935
 foreign_m_1 |   .0087735   .0177204     0.50   0.621     -.025967    .0435139
 foreign_m_2 |   .0036771   .0169216     0.22   0.828    -.0294972    .0368515
 foreign_m_3 |   .0096733   .0161208     0.60   0.549    -.0219311    .0412777
 foreign_m_4 |   .0003275   .0147763     0.02   0.982    -.0286411    .0292962
   expat_p_0 |  -.0351688    .009651    -3.64   0.000    -.0540893   -.0162483
   expat_p_1 |  -.0417514   .0106923    -3.90   0.000    -.0627135   -.0207893
   expat_p_2 |  -.0500887   .0120802    -4.15   0.000    -.0737716   -.0264058
   expat_p_3 |   -.048033    .013179    -3.64   0.000      -.07387   -.0221959
   expat_p_4 |  -.0485395   .0147979    -3.28   0.001    -.0775505   -.0195285
   expat_p_5 |  -.0692486   .0171225    -4.04   0.000    -.1028169   -.0356802
   expat_p_6 |  -.0810859   .0196328    -4.13   0.000    -.1195756   -.0425963
domestic_p_0 |   -.052813   .0095373    -5.54   0.000    -.0715107   -.0341153
domestic_p_1 |  -.0662244   .0107874    -6.14   0.000    -.0873728   -.0450759
domestic_p_2 |   -.073873   .0121764    -6.07   0.000    -.0977446   -.0500014
domestic_p_3 |  -.0853475   .0141344    -6.04   0.000    -.1130576   -.0576374
domestic_p_4 |  -.0888484   .0151874    -5.85   0.000    -.1186231   -.0590738
domestic_p_5 |  -.0860185   .0169395    -5.08   0.000    -.1192281   -.0528089
domestic_p_6 |  -.1024585   .0201155    -5.09   0.000    -.1418944   -.0630225
 foreign_p_0 |   .0376989   .0184076     2.05   0.041     .0016113    .0737865
 foreign_p_1 |   .0642979   .0199542     3.22   0.001     .0251781    .1034177
 foreign_p_2 |   .0579818   .0215794     2.69   0.007     .0156759    .1002878
 foreign_p_3 |   .0515764   .0229714     2.25   0.025     .0065414    .0966115
 foreign_p_4 |   .0549477   .0244899     2.24   0.025     .0069359    .1029595
 foreign_p_5 |   .0584647   .0259723     2.25   0.024     .0075466    .1093828
 foreign_p_6 |    .052439   .0283547     1.85   0.064    -.0031498    .1080278
             |
    ind_year |
          2  |  -.0062558   .0161412    -0.39   0.698    -.0379004    .0253887
          3  |  -.0410583   .0182992    -2.24   0.025    -.0769334   -.0051832
          4  |  -.0616848   .0203696    -3.03   0.002     -.101619   -.0217506
          5  |  -.0461626   .0216684    -2.13   0.033    -.0886431   -.0036822
          6  |   -.064815   .0233888    -2.77   0.006    -.1106682   -.0189618
          7  |  -.0466833   .0253112    -1.84   0.065    -.0963053    .0029387
          8  |  -.0630312   .0278207    -2.27   0.024    -.1175731   -.0084893
          9  |  -.0625012   .0299024    -2.09   0.037    -.1211241   -.0038783
         10  |  -.0564937   .0323262    -1.75   0.081    -.1198686    .0068812
         11  |  -.0696736   .0349594    -1.99   0.046    -.1382108   -.0011364
         12  |  -.0636335   .0370955    -1.72   0.086    -.1363584    .0090915
         13  |  -.0439035   .0397019    -1.11   0.269    -.1217382    .0339311
         14  |  -.0188551   .0421393    -0.45   0.655    -.1014684    .0637581
         15  |  -.0077416   .0444028    -0.17   0.862    -.0947923    .0793092
         16  |   .0077502   .0474147     0.16   0.870    -.0852053    .1007056
         17  |   .0168373   .0502846     0.33   0.738    -.0817445    .1154191
         18  |   .0304302   .0531212     0.57   0.567    -.0737128    .1345733
         19  |   .0426052   .0559104     0.76   0.446    -.0670059    .1522164
         20  |   .0720645   .0587284     1.23   0.220    -.0430712    .1872002
         21  |   .0871402   .0611174     1.43   0.154    -.0326791    .2069595
         22  |   .1020746   .0638164     1.60   0.110     -.023036    .2271852
         23  |   .0948702   .0659453     1.44   0.150    -.0344142    .2241546
         24  |   .0167971   .0688896     0.24   0.807    -.1182595    .1518536
         25  |  -.0040425   .0719869    -0.06   0.955    -.1451712    .1370862
         26  |    .106621   .0270375     3.94   0.000     .0536146    .1596275
         27  |   .0662144    .026445     2.50   0.012     .0143696    .1180592
         28  |   .0770713   .0261996     2.94   0.003     .0257075    .1284351
         29  |   .0742418   .0265457     2.80   0.005     .0221995    .1262841
         30  |   .0735085   .0271368     2.71   0.007     .0203075    .1267096
         31  |   .0650769   .0283565     2.29   0.022     .0094846    .1206692
         32  |   .0540465   .0300927     1.80   0.073    -.0049495    .1130426
         33  |     .05705   .0313644     1.82   0.069    -.0044392    .1185392
         34  |   .0466646   .0333573     1.40   0.162    -.0187316    .1120608
         35  |   .0423789   .0352961     1.20   0.230    -.0268182    .1115761
         36  |   .0347062   .0373773     0.93   0.353    -.0385712    .1079836
         37  |   .0447319   .0393654     1.14   0.256    -.0324431    .1219069
         38  |   .0585128   .0415896     1.41   0.160    -.0230228    .1400483
         39  |   .0638522    .043958     1.45   0.146    -.0223266     .150031
         40  |    .048901    .046348     1.06   0.291    -.0419632    .1397652
         41  |   .0634823   .0489089     1.30   0.194    -.0324026    .1593671
         42  |   .0707119   .0515431     1.37   0.170    -.0303373     .171761
         43  |   .0748304   .0543211     1.38   0.168    -.0316649    .1813257
         44  |   .0724773   .0572605     1.27   0.206    -.0397807    .1847353
         45  |   .0865792     .05969     1.45   0.147    -.0304419    .2036002
         46  |   .1062036   .0623127     1.70   0.088    -.0159591    .2283662
         47  |   .1031111   .0648582     1.59   0.112     -.024042    .2302642
         48  |   .1008895   .0673488     1.50   0.134    -.0311463    .2329254
         49  |  -.0377253   .0701162    -0.54   0.591    -.1751866     .099736
         50  |  -.0770839   .0725938    -1.06   0.288    -.2194025    .0652347
             |
     age_cat |
          1  |    .073013   .0111329     6.56   0.000     .0511872    .0948387
          2  |   .1027305   .0134771     7.62   0.000     .0763089    .1291522
          3  |   .1366992   .0157578     8.68   0.000     .1058064     .167592
          4  |   .1656223   .0181012     9.15   0.000     .1301353    .2011093
          5  |   .1739316   .0204336     8.51   0.000     .1338719    .2139912
          6  |   .1803689   .0229046     7.87   0.000     .1354648    .2252729
          7  |   .1930598   .0254897     7.57   0.000     .1430877    .2430318
          8  |   .1954419   .0279128     7.00   0.000     .1407195    .2501642
          9  |   .2043949    .030344     6.74   0.000     .1449062    .2638836
         10  |   .2111182   .0330134     6.39   0.000      .146396    .2758403
         11  |   .2118844   .0353688     5.99   0.000     .1425447    .2812241
         12  |   .2155141   .0378344     5.70   0.000     .1413406    .2896876
         13  |   .2134971   .0402125     5.31   0.000     .1346614    .2923328
         14  |   .2235216   .0430106     5.20   0.000     .1392003     .307843
         15  |   .2309438   .0455108     5.07   0.000     .1417208    .3201667
         16  |   .2387052   .0483105     4.94   0.000     .1439935    .3334169
         17  |   .2359322    .051152     4.61   0.000     .1356498    .3362145
         18  |   .2285386   .0538278     4.25   0.000     .1230103    .3340668
         19  |   .2314194   .0569374     4.06   0.000     .1197948     .343044
         20  |   .2117628   .0618085     3.43   0.001     .0905886     .332937
         25  |   .2462228   .0729549     3.37   0.001     .1031963    .3892494
         30  |   .2196527   .1066767     2.06   0.040     .0105154    .4287901
         40  |   .2919244   .1215201     2.40   0.016     .0536869    .5301618
         50  |   .2704462   .1442997     1.87   0.061    -.0124501    .5533426
             |
       _cons |   .4692619   .0243127    19.30   0.000     .4215974    .5169264
-------------+----------------------------------------------------------------
     sigma_u |  .35783211
     sigma_e |  .28664605
         rho |    .609124   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/exporter_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    201690
Group variable: firm_person                     Number of groups   =     19488

R-sq:  within  = 0.0379                         Obs per group: min =         1
       between = 0.0078                                        avg =      10.3
       overall = 0.0240                                        max =        24

                                                F(103,4410)        =     18.96
corr(u_i, Xb)  = -0.1703                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,411 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0812095   .0211282    -3.84   0.000    -.1226314   -.0397877
   expat_m_2 |  -.0472804   .0204978    -2.31   0.021    -.0874664   -.0070944
   expat_m_3 |  -.0690775   .0196378    -3.52   0.000    -.1075774   -.0305776
   expat_m_4 |  -.0537159   .0198451    -2.71   0.007    -.0926222   -.0148095
domestic_m_1 |  -.0597423   .0206159    -2.90   0.004    -.1001597   -.0193248
domestic_m_2 |  -.0425105   .0196443    -2.16   0.031    -.0810232   -.0039978
domestic_m_3 |  -.0306686   .0188881    -1.62   0.105    -.0676988    .0063616
domestic_m_4 |   .0074076   .0190227     0.39   0.697    -.0298864    .0447016
 foreign_m_1 |  -.0406953   .0403259    -1.01   0.313    -.1197542    .0383636
 foreign_m_2 |  -.0486789   .0399943    -1.22   0.224    -.1270878      .02973
 foreign_m_3 |  -.0967602   .0417478    -2.32   0.021    -.1786069   -.0149136
 foreign_m_4 |  -.0320254   .0427449    -0.75   0.454    -.1158268     .051776
   expat_p_0 |  -.0932701   .0224803    -4.15   0.000    -.1373427   -.0491975
   expat_p_1 |  -.0777738    .025167    -3.09   0.002    -.1271138   -.0284338
   expat_p_2 |  -.1108397   .0280748    -3.95   0.000    -.1658804   -.0557991
   expat_p_3 |  -.0874667   .0321955    -2.72   0.007    -.1505861   -.0243472
   expat_p_4 |  -.1079184   .0357952    -3.01   0.003     -.178095   -.0377418
   expat_p_5 |  -.0728913   .0445757    -1.64   0.102     -.160282    .0144995
   expat_p_6 |  -.0858586   .0477523    -1.80   0.072     -.179477    .0077598
domestic_p_0 |  -.0669843   .0218336    -3.07   0.002     -.109789   -.0241795
domestic_p_1 |  -.0784178   .0241914    -3.24   0.001    -.1258451   -.0309904
domestic_p_2 |  -.0594071   .0277481    -2.14   0.032    -.1138073   -.0050069
domestic_p_3 |  -.0821208   .0311675    -2.63   0.008    -.1432249   -.0210168
domestic_p_4 |  -.0636098    .035015    -1.82   0.069    -.1322568    .0050373
domestic_p_5 |  -.0923317   .0407129    -2.27   0.023    -.1721495    -.012514
domestic_p_6 |  -.1431924   .0391549    -3.66   0.000    -.2199556   -.0664291
 foreign_p_0 |   .0102554   .0402626     0.25   0.799    -.0686795    .0891902
 foreign_p_1 |   .0670132   .0359596     1.86   0.062    -.0034857    .1375122
 foreign_p_2 |  -.0119721   .0374004    -0.32   0.749    -.0852957    .0613515
 foreign_p_3 |  -.0350948   .0400186    -0.88   0.381    -.1135513    .0433617
 foreign_p_4 |  -.0491206   .0417163    -1.18   0.239    -.1309054    .0326643
 foreign_p_5 |  -.0864705   .0445345    -1.94   0.052    -.1737804    .0008395
 foreign_p_6 |  -.0863778   .0482962    -1.79   0.074    -.1810626    .0083071
             |
    ind_year |
          3  |  -.0865431   .0505561    -1.71   0.087    -.1856584    .0125722
          4  |   .0233464    .049678     0.47   0.638    -.0740473    .1207401
          5  |  -.0151546   .0511203    -0.30   0.767    -.1153761    .0850669
          6  |  -.0935325   .0547969    -1.71   0.088    -.2009619    .0138968
          7  |   .0318827   .0561473     0.57   0.570    -.0781942    .1419597
          8  |  -.0964126   .0598559    -1.61   0.107    -.2137602    .0209351
          9  |  -.0950856   .0648011    -1.47   0.142    -.2221283    .0319572
         10  |  -.1142064   .0670455    -1.70   0.089    -.2456493    .0172365
         11  |  -.1548042   .0718814    -2.15   0.031    -.2957278   -.0138806
         12  |   -.145671   .0760619    -1.92   0.056    -.2947905    .0034484
         13  |  -.2004673   .0810022    -2.47   0.013    -.3592724   -.0416623
         14  |  -.2741575    .085474    -3.21   0.001    -.4417295   -.1065854
         15  |  -.1470505   .0905064    -1.62   0.104    -.3244884    .0303875
         16  |  -.1785215   .0956021    -1.87   0.062    -.3659497    .0089066
         17  |  -.2212698   .1012214    -2.19   0.029    -.4197145    -.022825
         18  |   -.223106   .1060955    -2.10   0.036    -.4311064   -.0151056
         19  |  -.2305793   .1114313    -2.07   0.039    -.4490407    -.012118
         20  |  -.1237911   .1168299    -1.06   0.289    -.3528365    .1052542
         21  |   -.255864   .1217486    -2.10   0.036    -.4945525   -.0171756
         22  |   .0169732   .1260101     0.13   0.893    -.2300697    .2640162
         23  |   -.342456   .1318853    -2.60   0.009    -.6010173   -.0838947
         24  |  -.5106222   .1409846    -3.62   0.000    -.7870228   -.2342215
         25  |  -.3124541   .1510855    -2.07   0.039    -.6086576   -.0162506
         27  |  -.1169833   .0648929    -1.80   0.072     -.244206    .0102394
         28  |  -.4094336   .0617144    -6.63   0.000    -.5304247   -.2884424
         29  |  -.1510688    .061428    -2.46   0.014    -.2714986   -.0306391
         30  |  -.2627559   .0620194    -4.24   0.000    -.3843449   -.1411668
         31  |   -.172154   .0636451    -2.70   0.007    -.2969304   -.0473776
         32  |  -.2882658   .0657749    -4.38   0.000    -.4172175    -.159314
         33  |  -.1411501   .0673638    -2.10   0.036    -.2732168   -.0090833
         34  |  -.2564627   .0707301    -3.63   0.000    -.3951292   -.1177962
         35  |  -.2417932   .0743078    -3.25   0.001    -.3874737   -.0961126
         36  |  -.3152409   .0781842    -4.03   0.000    -.4685213   -.1619606
         37  |  -.3123863   .0825893    -3.78   0.000    -.4743028   -.1504697
         38  |  -.2744501    .085788    -3.20   0.001    -.4426376   -.1062626
         39  |   -.362421   .0901331    -4.02   0.000    -.5391272   -.1857149
         40  |  -.2554742   .0956078    -2.67   0.008    -.4429136   -.0680349
         41  |  -.3010748   .1007407    -2.99   0.003    -.4985772   -.1035724
         42  |  -.3391448   .1052172    -3.22   0.001    -.5454233   -.1328664
         43  |  -.1915229   .1101022    -1.74   0.082    -.4073786    .0243327
         44  |  -.2377395   .1153507    -2.06   0.039    -.4638847   -.0115943
         45  |  -.4134991   .1207751    -3.42   0.001     -.650279   -.1767192
         46  |  -.2557018    .125627    -2.04   0.042    -.5019938   -.0094099
         47  |  -.0494986   .1306028    -0.38   0.705    -.3055456    .2065485
         48  |  -.4332686   .1352074    -3.20   0.001     -.698343   -.1681942
         49  |  -.9016516   .1383604    -6.52   0.000    -1.172907   -.6303958
         50  |  -.4000471   .1523197    -2.63   0.009    -.6986703    -.101424
             |
     age_cat |
          2  |  -.1263606   .0332099    -3.80   0.000    -.1914687   -.0612525
          3  |  -.2472919   .0360769    -6.85   0.000    -.3180206   -.1765631
          4  |  -.2813095   .0391289    -7.19   0.000    -.3580217   -.2045973
          5  |  -.3028565   .0435035    -6.96   0.000    -.3881453   -.2175678
          6  |  -.2929826   .0472231    -6.20   0.000    -.3855636   -.2004017
          7  |  -.3123421   .0514239    -6.07   0.000    -.4131588   -.2115254
          8  |  -.2928058   .0556827    -5.26   0.000    -.4019719   -.1836397
          9  |  -.3040254   .0607954    -5.00   0.000    -.4232148   -.1848359
         10  |  -.3223531   .0653014    -4.94   0.000    -.4503765   -.1943296
         11  |  -.2926599   .0701466    -4.17   0.000    -.4301824   -.1551374
         12  |  -.2601131    .075741    -3.43   0.001    -.4086036   -.1116227
         13  |  -.2910145   .0805643    -3.61   0.000    -.4489609   -.1330682
         14  |  -.2684387    .085494    -3.14   0.002    -.4360498   -.1008276
         15  |  -.3198296    .091176    -3.51   0.000    -.4985804   -.1410787
         16  |  -.2852283   .0959892    -2.97   0.003    -.4734152   -.0970414
         17  |  -.2516531   .1015869    -2.48   0.013    -.4508143   -.0524918
         18  |  -.2905913   .1077644    -2.70   0.007    -.5018636    -.079319
         19  |   -.252819   .1143643    -2.21   0.027    -.4770305   -.0286076
         20  |  -.2293725   .1247532    -1.84   0.066    -.4739514    .0152064
         25  |  -.2173068    .151097    -1.44   0.150    -.5135328    .0789192
         30  |  -.0192074   .2162985    -0.09   0.929     -.443261    .4048462
         40  |   .0198045   .2704958     0.07   0.942    -.5105032    .5501121
         50  |   .1513782    .335707     0.45   0.652     -.506776    .8095323
             |
       _cons |   .4617953    .057231     8.07   0.000     .3495938    .5739969
-------------+----------------------------------------------------------------
     sigma_u |  .41592341
     sigma_e |  .86006289
         rho |  .18953894   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/inv_event_study.png written in PNG format)

. 
. 
. 
. log close
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/estimate.log
  log type:  text
 closed on:  28 Nov 2018, 17:39:44
--------------------------------------------------------------------------------------------------------------------------------
